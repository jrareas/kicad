* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within 
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
*
** Standard Linear Ics Macromodels, 1993. 
** CONNECTIONS :
* 1 INVERTING INPUT
* 2 NON-INVERTING INPUT
* 3 OUTPUT
* 4 POSITIVE POWER SUPPLY
* 5 NEGATIVE POWER SUPPLY
.SUBCKT LM2902 1 2 3 4 5
***************************
.MODEL MDTH D IS=1E-8 KF=3.104131E-15 CJO=10F
* INPUT STAGE
CIP 2 5 1.000000E-12
CIN 1 5 1.000000E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 2.600000E+01
RIN 15 16 2.600000E+01
RIS 11 15 2.003862E+02
DIP 11 12 MDTH 400E-12
DIN 15 14 MDTH 400E-12
VOFP 12 13 DC 0 
VOFN 13 14 DC 0
IPOL 13 5 1.000000E-05
CPS 11 15 3.783376E-09
DINN 17 13 MDTH 400E-12
VIN 17 5 0.000000e+00
DINR 15 18 MDTH 400E-12
VIP 4 18 2.000000E+00
FCP 4 5 VOFP 3.400000E+01
FCN 5 4 VOFN 3.400000E+01
FIBP 2 5 VOFN 2.000000E-03
FIBN 5 1 VOFP 2.000000E-03
* AMPLIFYING STAGE
FIP 5 19 VOFP 3.600000E+02
FIN 5 19 VOFN 3.600000E+02
RG1 19 5 3.652997E+06
RG2 19 4 3.652997E+06
CC 19 5 6.000000E-09
DOPM 19 22 MDTH 400E-12
DONM 21 19 MDTH 400E-12
HOPM 22 28 VOUT 7.500000E+03
VIPM 28 4 1.500000E+02
HONM 21 27 VOUT 7.500000E+03
VINM 5 27 1.500000E+02
EOUT 26 23 19 5 1
VOUT 23 5 0
ROUT 26 3 20
COUT 3 5 1.000000E-12
DOP 19 25 MDTH 400E-12
VOP 4 25 2.242230E+00
DON 24 19 MDTH 400E-12
VON 24 5 7.922301E-01
.ENDS* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within 
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
*
** Standard Linear Ics Macromodels, 1993. 
** CONNECTIONS :
* 1 INVERTING INPUT
* 2 NON-INVERTING INPUT
* 3 OUTPUT
* 4 POSITIVE POWER SUPPLY
* 5 NEGATIVE POWER SUPPLY
.SUBCKT LM2904 1 2 3 4 5
***************************
.MODEL MDTH D IS=1E-8 KF=3.104131E-15 CJO=10F
* INPUT STAGE
CIP 2 5 1.000000E-12
CIN 1 5 1.000000E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 2.600000E+01
RIN 15 16 2.600000E+01
RIS 11 15 2.003862E+02
DIP 11 12 MDTH 400E-12
DIN 15 14 MDTH 400E-12
VOFP 12 13 DC 0 
VOFN 13 14 DC 0
IPOL 13 5 1.000000E-05
CPS 11 15 3.783376E-09
DINN 17 13 MDTH 400E-12
VIN 17 5 0.000000e+00
DINR 15 18 MDTH 400E-12
VIP 4 18 2.000000E+00
FCP 4 5 VOFP 3.400000E+01
FCN 5 4 VOFN 3.400000E+01
FIBP 2 5 VOFN 2.000000E-03
FIBN 5 1 VOFP 2.000000E-03
* AMPLIFYING STAGE
FIP 5 19 VOFP 3.600000E+02
FIN 5 19 VOFN 3.600000E+02
RG1 19 5 3.652997E+06
RG2 19 4 3.652997E+06
CC 19 5 6.000000E-09
DOPM 19 22 MDTH 400E-12
DONM 21 19 MDTH 400E-12
HOPM 22 28 VOUT 7.500000E+03
VIPM 28 4 1.500000E+02
HONM 21 27 VOUT 7.500000E+03
VINM 5 27 1.500000E+02
EOUT 26 23 19 5 1
VOUT 23 5 0
ROUT 26 3 20
COUT 3 5 1.000000E-12
DOP 19 25 MDTH 400E-12
VOP 4 25 2.242230E+00
DON 24 19 MDTH 400E-12
VON 24 5 7.922301E-01
.ENDS* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within 
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
*
** Standard Linear Ics Macromodels, 1993. 
** CONNECTIONS :
* 1 INVERTING INPUT
* 2 NON-INVERTING INPUT
* 3 OUTPUT
* 4 POSITIVE POWER SUPPLY
* 5 NEGATIVE POWER SUPPLY
.SUBCKT LM324 1 2 3 4 5
***************************
.MODEL MDTH D IS=1E-8 KF=3.104131E-15 CJO=10F
* INPUT STAGE
CIP 2 5 1.000000E-12
CIN 1 5 1.000000E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 2.600000E+01
RIN 15 16 2.600000E+01
RIS 11 15 2.003862E+02
DIP 11 12 MDTH 400E-12
DIN 15 14 MDTH 400E-12
VOFP 12 13 DC 0 
VOFN 13 14 DC 0
IPOL 13 5 1.000000E-05
CPS 11 15 3.783376E-09
DINN 17 13 MDTH 400E-12
VIN 17 5 0.000000e+00
DINR 15 18 MDTH 400E-12
VIP 4 18 2.000000E+00
FCP 4 5 VOFP 3.400000E+01
FCN 5 4 VOFN 3.400000E+01
FIBP 2 5 VOFN 2.000000E-03
FIBN 5 1 VOFP 2.000000E-03
* AMPLIFYING STAGE
FIP 5 19 VOFP 3.600000E+02
FIN 5 19 VOFN 3.600000E+02
RG1 19 5 3.652997E+06
RG2 19 4 3.652997E+06
CC 19 5 6.000000E-09
DOPM 19 22 MDTH 400E-12
DONM 21 19 MDTH 400E-12
HOPM 22 28 VOUT 7.500000E+03
VIPM 28 4 1.500000E+02
HONM 21 27 VOUT 7.500000E+03
VINM 5 27 1.500000E+02
EOUT 26 23 19 5 1
VOUT 23 5 0
ROUT 26 3 20
COUT 3 5 1.000000E-12
DOP 19 25 MDTH 400E-12
VOP 4 25 2.242230E+00
DON 24 19 MDTH 400E-12
VON 24 5 7.922301E-01
.ENDS* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within 
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
*
** Standard Linear Ics Macromodels, 1993. 
** CONNECTIONS :
* 1 INVERTING INPUT
* 2 NON-INVERTING INPUT
* 3 OUTPUT
* 4 POSITIVE POWER SUPPLY
* 5 NEGATIVE POWER SUPPLY
.SUBCKT LM358 1 2 3 4 5
***************************
.MODEL MDTH D IS=1E-8 KF=3.104131E-15 CJO=10F
* INPUT STAGE
CIP 2 5 1.000000E-12
CIN 1 5 1.000000E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 2.600000E+01
RIN 15 16 2.600000E+01
RIS 11 15 2.003862E+02
DIP 11 12 MDTH 400E-12
DIN 15 14 MDTH 400E-12
VOFP 12 13 DC 0 
VOFN 13 14 DC 0
IPOL 13 5 1.000000E-05
CPS 11 15 3.783376E-09
DINN 17 13 MDTH 400E-12
VIN 17 5 0.000000e+00
DINR 15 18 MDTH 400E-12
VIP 4 18 2.000000E+00
FCP 4 5 VOFP 3.400000E+01
FCN 5 4 VOFN 3.400000E+01
FIBP 2 5 VOFN 2.000000E-03
FIBN 5 1 VOFP 2.000000E-03
* AMPLIFYING STAGE
FIP 5 19 VOFP 3.600000E+02
FIN 5 19 VOFN 3.600000E+02
RG1 19 5 3.652997E+06
RG2 19 4 3.652997E+06
CC 19 5 6.000000E-09
DOPM 19 22 MDTH 400E-12
DONM 21 19 MDTH 400E-12
HOPM 22 28 VOUT 7.500000E+03
VIPM 28 4 1.500000E+02
HONM 21 27 VOUT 7.500000E+03
VINM 5 27 1.500000E+02
EOUT 26 23 19 5 1
VOUT 23 5 0
ROUT 26 3 20
COUT 3 5 1.000000E-12
DOP 19 25 MDTH 400E-12
VOP 4 25 2.242230E+00
DON 24 19 MDTH 400E-12
VON 24 5 7.922301E-01
.ENDS****************************************************************************
*
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation
*    time).
*
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
****************************************************************************
****
***  LMV3x  Spice macromodel subckt 
***  December 2008 (last update: 05-10-2010)
****                      
************ CONNECTIONS: 
****             INVERTING INPUT
****              |  NON-INVERTING INPUT
****              |   |  OUTPUT 
****              |   |   |  POSITIVE POWER SUPPLY
****              |   |   |   |  NEGATIVE POWER SUPPLY 
****              |   |   |   |   |     
****              |   |   |   |   |    
.SUBCKT    LMV3X VM  VP  VS  VCCP VCCN
    M_NMOS2 VO_DIFF_MINUS VM VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    M_NMOS1 VO_DIFF_PLUS NET216 VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    V_OUTVLIM_LOW NET208 NET209 DC {Vd_compensazione}
    V_OUTVLIM_HIGH NET233 NET211 DC {Vd_compensazione}
    VREADIO NET273 VS DC 0
    VVLIM_LOW_VB NET214 NET215 DC -770m
    VOS NET216 VP DC 0
    VPROT_IN_P_VCCP NET218 NET247 DC {V_DPROT}
    V_ENHANCE_VCCN VCCN_ENHANCED VCCN DC {VCCN_enhance}
    VVLIM_HIGH_VB NET237 NET223 DC -770m
    V_ENHANCE_VCCP VCCP_ENHANCED VCCP DC {VCCP_enhance}
    VPROT_IN_M_VCCN NET226 NET398 DC {V_DPROT}
    VPROT_IN_P_VCCN NET228 NET229 DC {V_DPROT}
    VPROT_IN_M_VCCP NET386 NET239 DC {V_DPROT}
    D_OUTVLIM_HIGH NET276 NET233 DIODE_NOVd
    D_OUTVLIM_LOW NET209 NET235 DIODE_NOVd
    DVLIM_HIGH_VB VB NET237 DIODE_VLIM
    DPROT_IN_M_VCCP VM NET239 DIODE_VLIM
    DVLIM_LOW_VB NET215 VB DIODE_VLIM
    DPROT_IN_M_VCCN NET226 VM DIODE_VLIM
    DILIM_SINK VB_3_SINK VB_3 DIODE_ILIM
    DPROT_IN_P_VCCP NET216 NET247 DIODE_VLIM
    DILIM_SOURCE VB_3 VB_3_SOURCE DIODE_ILIM
    DPROT_IN_P_VCCN NET228 NET216 DIODE_VLIM
    C_RO2_1 VB_2 VREF 500p
    CIN_DIFF VM VP {CIN_DIFF}
    CIN_CM_VP VP VREF {CIN_CM_VP}
    CIN_CM_VM VM VREF {CIN_CM_VM}
    CDIFF_PARASITIC VO_DIFF_PLUS VO_DIFF_MINUS 30p
    CCOMP VB VB_2 {Ccomp}
    E_RO1 VB_3 NET273 VALUE={IF(I(VreadIo)>0,
+V(Ro1_Voh)*I(VreadIo),V(Ro1_Vol)*I(VreadIo))}

* Eldo:
*    E_VOHNORL NET276 VB_3 PWL(1) VCCP VCCN ( 1.8 , 16m ) ( 3.0 , 21m ) (
*    +5.0 , 28.5m )
*    E_RO1_VOH RO1_VOH 0 PWL(1) VCCP VCCN ( 1.8 , 60 ) ( 3.0 , 57 ) ( 5.0 ,
*    +41 )
*    E_RO1_VOL RO1_VOL 0 PWL(1) VCCP VCCN ( 1.8 , 38 ) ( 3.0 , 60 ) (
*    +5.0 , 42 )
*    E_VOLNORL VB_3 NET235 PWL(1) VCCP VCCN ( 1.8 , 24m ) ( 3.0 , 26m ) ( 5.0 ,
*    +32m )
* PSpice:
*    E_VOHNORL NET276 VB_3 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 16m , 3.0 , 21m ,
*+5.0 , 28.5m )}
    E_VOHNORL NET276 VB_3 POLY(1) VCCP VCCN 0.00779687499999999
+0.0047916666666666715 -1.3020833333333404E-4
    *E_RO1_VOH RO1_VOH 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 60 , 3.0 , 57 , 5.0 ,
*+41 )}
    E_RO1_VOH RO1_VOH 0 POLY(1) VCCP VCCN 55.21875 5.75 -1.71875
    *E_VOLNORL VB_3 NET235 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 24m , 3.0 , 26m ,
*+5.0 , 32m )}
    E_VOLNORL VB_3 NET235 POLY(1) VCCP VCCN 0.02325
+-3.3333333333334427E-4 4.166666666666681E-4
    *E_RO1_VOL RO1_VOL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 38 , 3.0 , 60 , 5.0 ,
*+42 )}
    E_RO1_VOL RO1_VOL 0 POLY(1) VCCP VCCN -41.125 59.33333333333332
+-8.541666666666664

    E50 NET211 0 VCCP 0 1.0
    E_ICCSAT_HIGH ICC_OUT_HIGH 0 POLY(1) VCCP VCCN 3.9739130434782604E-5
+5.652173913043478E-6
    E51 NET208 0 VCCN 0 1.0
    E_ICCSAT_LOW ICC_OUT_LOW 0 POLY(1) VCCP VCCN 0    
    EILIM_SINK VB_3_SINK VDEP_SINK VB_3 0 1.0
    E64 IO_VAL 0 VALUE={I(VreadIo)}
    EMEAS_VB_VREF VB_VREF 0 VB VREF 1.0
    EMEAS_VOUT_DIFF VOUT_DIFF 0 VO_DIFF_PLUS VO_DIFF_MINUS 1.0
    E_VDEP_SOURCE_2 VAL_VDEP_SOURCE_FILTERED 0
+VALUE={IF(V(val_vdep_source)>=0, 0, V(val_vdep_source))}
    E_VDEP_SOURCE_1 VAL_VDEP_SOURCE 0 VALUE={ (217.76086956521732      +
+4.347826086956525*V(Vccp,Vccn))  -5000*I(VreadIo) }
    E_VDEP_SOURCE_3 VDEP_SOURCE 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_source_filtered))}
    EVLIM_HIGH_VB NET223 0 VCCP 0 1.0
    E_VDEP_SINK_1 VAL_VDEP_SINK 0 VALUE={ ( -217.76086956521732
+-4.347826086956525*V(Vccp,Vccn) ) -5000*I(VreadIo)}
    E_VDEP_SINK_2 VAL_VDEP_SINK_FILTERED 0
+VALUE={IF(V(val_vdep_sink)<=0 , 0 , V(val_vdep_sink))}
    EVLIM_LOW_VB NET214 0 VCCN 0 1.0
    E2_REF NET400 0 VCCN 0 1.0
    E_VREF VREF 0 NET394 0 1.0
    G_ICC VCCP VCCN POLY(1) VCCP VCCN 1.2204347826086958E-4
+7.3913043478260745E-6
    E_VDEP_SINK_3 VDEP_SINK 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_sink_filtered))}
    E1_REF NET368 0 VCCP 0 1.0
    EILIM_SOURCE VB_3_SOURCE VDEP_SOURCE VB_3 0 1.0
    E_SR_VCC_MODULATION VOUT_DIFF__SR_VCC 0 VALUE={V(Vout_diff)*(
+0.5869565217391304 + 0.0826086956521739*V(Vccp,Vccn) )}
    R1 VB VREF {R1}
    RIN_CM_VM VREF VM {RIN_CM_VM}
    RO2_1 VB_2 VREF {Ro2_1}
    RIN_DIFF VP VM {RIN_DIFF}
    R_ICCSAT_LOW ICC_OUT_LOW 0 1K
    RPROT_IN_P_VCCP NET218 VCCP {RPROT_VCCP}
    RPROT_IN_M_VCCP VCCP NET386 {RPROT_VCCP}
    RO2_2 VB_3 VB_2 {Ro2_2}
    RIN_CM_VP VREF VP {RIN_CM_VP}
    RD1 VCCP_ENHANCED VO_DIFF_PLUS {RD}
    RD2 VCCP_ENHANCED VO_DIFF_MINUS {RD}
    R1_REF NET368 NET394 1Meg
    R_ICCSAT_HIGH ICC_OUT_HIGH 0 1K
    RPROT_IN_M_VCCN VCCN NET398 {RPROT_VCCN}
    R2_REF NET394 NET400 1Meg
    RPROT_IN_P_VCCN NET229 VCCN {RPROT_VCCN}

*Eldo:
*    G_IIB_VM VREF VM TABLE {V(Vccp,Vccn)} = (+2.7 10n) (+5.0 16n)
*    G_IIB_VP VREF VP TABLE {V(Vccp,Vccn)} = (+2.7 10n) (+5.0 16n)
*PSpice:
*    G_IIB_VM VREF VM VALUE={TABLE( V(VCCP,VCCN) , +2.7 , 10n , +5.0 , 16n)}
*    G_IIB_VP VREF VP VALUE={TABLE( V(VCCP,VCCN) , +2.7 , 10n , +5.0 , 16n)}
    G_IIB_VM VREF VM POLY(1) VCCP VCCN 2.956521739130429E-9
+2.6086956521739144E-9
    G_IIB_VP VREF VP POLY(1) VCCP VCCN 2.956521739130429E-9
+2.6086956521739144E-9

    G_ICCSAT_OUTLOW VCCP VCCN VALUE={IF(I(V_OUTVLIM_LOW)>1u ,
+V(Icc_out_low) , 0)}
    G_I_IO VB_2 VREF VALUE={IF(abs(V(Io_val))<50m  , V(VB_Vref)*GB*(
+abs(V(Io_val))/3m ) , V(VB_Vref)*GB*( 50m/3m ) )}
    G_IOUT_SOURCED VCCP 0 VALUE={IF(I(VreadIo)>0, I(VreadIo),0)}
    GM1 VREF VB VOUT_DIFF__SR_VCC 0 {1/RD}    
    IEE VEE_N VCCN_ENHANCED {IEE}
    G_ICCSAT_OUTHIGH VCCP VCCN VALUE={IF(I(V_OUTVLIM_HIGH)>1u ,
+V(Icc_out_high) , 0)}
    G_IOUT_SINKED VCCN 0 VALUE={IF(I(VreadIo)>0, 0, I(VreadIo))}
    
*Eldo:    
*    G_I_VB VB_2 VREF TABLE {V(VB_Vref)} = (-2.7 {-2.7*GB*3}) (-2.0
*+{-2.0*GB*2.5}) (-1.5 {-1.5*GB*2.2}) (-0.69 {-0.69*GB*2}) (-0.65
*+{-0.65*GB*1.0}) (-0.15 {-0.15*GB*1}) (-0.050 {-0.050*GB*1}) (-0.015
*+{-0.015*GB*1}) (-0.0001 {-0.0001*GB*1}) (0 0) (+0.0001 {0.0001*GB*1})
*+(+0.015 {+0.015*GB*1}) (+0.050 {+0.050*GB*1}) (+0.15 {+0.15*GB*1}) (+0.65
*+{0.65*GB*1.0}) (+0.69 {0.69*GB*2})  (+1.5 {1.5*GB*2.2}) (+2.0
*+{2.0*GB*2.5}) (+2.7 {2.7*GB*3})  
*PSpice:
*    G_I_VB VB_2 VREF VALUE={TABLE( V(VB,Vref) , -2.7 , -2.7*GB*3 , -2.0 ,
*+ -2.0*GB*2.5 , -1.5 , -1.5*GB*2.2 , -0.69 , -0.69*GB*2 , -0.65 ,
*+ -0.65*GB*1.0 , -0.15 , -0.15*GB*1 , -0.050 , -0.050*GB*1 , -0.015 ,
*+ -0.015*GB*1 , -0.0001 , -0.0001*GB*1 , 0 , 0 , +0.0001 , 0.0001*GB*1 ,
*+ +0.015 , +0.015*GB*1 , +0.050 , +0.050*GB*1 , +0.15 , +0.15*GB*1 , +0.65,
*+ 0.65*GB*1.0 , +0.69 , 0.69*GB*2 , +1.5 , 1.5*GB*2.2 , +2.0 ,
*+ 2.0*GB*2.5 , +2.7 , 2.7*GB*3 ) }
    G_I_VB VB_2 VREF POLY(1) VB_VREF 0 2.0955964330729256E-18
+0.0064704243141362125 -2.1354856438578985E-18 0.003032922143165251
+1.7832794554106567E-19 -1.99845853108853E-4


*** End of subcircuit definition.

*******************************************************************************
*
* MODELS/SUBCKTS and PARAMS used by LMV3x subckt:
*

.PARAM RINCM=6.4777e+7
.PARAM CINCM=1.4646e-11
.PARAM RIN_CM_VM={2*RINCM}
.PARAM RIN_CM_VP={2*RINCM}
.PARAM CIN_CM_VM={CINCM/2}
.PARAM CIN_CM_VP={CINCM/2}
.PARAM RINDIFF=2.3412e+5
.PARAM CINDIFF=9.2768e-12
.PARAM RIN_DIFF={(2*RINCM*RINDIFF)/(2*RINCM - RINDIFF)}
.PARAM CIN_DIFF={CINDIFF - CINCM/2}
.PARAM RD=1k
.PARAM VCCP_enhance=150m
.PARAM VCCN_enhance=-1100m 
.PARAM A0 = 1.0597e+006
.PARAM Ro = 6.5024e+004
.PARAM Ccomp=5.4p 
.PARAM IEE=3u
.PARAM W=1.37u
.PARAM L=1u
.PARAM gm_mos=4.536705600382889e-05
.PARAM GB=6m 
.PARAM Ro1=50
.PARAM Ro2_2=1e-3 
.PARAM Ro2_1={Ro - Ro2_2 - Ro1} 
.PARAM R1={A0/(gm_mos*GB*Ro2_1)}
.PARAM V_DPROT=150m
.PARAM RPROT_VCCP=100
.PARAM RPROT_VCCN=15k
.PARAM Vd_compensazione=-788.4u

*Eldo:
*.MODEL MOS_N  NMOS LEVEL=1 MODTYPE=ELDO VTO=+0.65  KP=500E-6 
*.MODEL DIODE_NOVd D LEVEL=1 MODTYPE=ELDO IS=10E-15 N=0.001
*.MODEL DIODE_VLIM D LEVEL=1 MODTYPE=ELDO IS=0.8E-15   
*.MODEL DIODE_ILIM D LEVEL=1 MODTYPE=ELDO IS=0.8E-15  
*.MODEL DX D LEVEL=1 MODTYPE=ELDO IS=1E-14 
*PSpice:
.MODEL MOS_N  NMOS LEVEL=1 VTO=+0.65  KP=500E-6 
.MODEL DIODE_NOVd D LEVEL=1 IS=10E-15 N=0.001
.MODEL DIODE_VLIM D LEVEL=1 IS=0.8E-15   
.MODEL DIODE_ILIM D LEVEL=1 IS=0.8E-15  
.MODEL DX D LEVEL=1 IS=1E-14 
*******************************************************************************
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie.
simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component
values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within 
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its
goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
.ENDS

** Standard Linear Ics Macromodels. 
** CONNECTIONS :
* 1 INVERTING INPUT
* 2 NON-INVERTING INPUT
* 3 OUTPUT
* 4 POSITIVE POWER SUPPLY
* 5 NEGATIVE POWER SUPPLY
.SUBCKT MC4558 1 2 3 4 5
**********************************************************
.MODEL MDTH D IS=1E-8 KF=3.103536E-16 CJO=10F
* INPUT STAGE
CIP 2 5 1.400000E-12
CIN 1 5 1.400000E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 1.238095E+01
RIN 15 16 1.238095E+01
RIS 11 15 1.142635E+02
DIP 11 12 MDTH 400E-12
DIN 15 14 MDTH 400E-12
VOFP 12 13 DC 0
VOFN 13 14 DC 0
IPOL 13 5 2.100000E-05
CPS 11 15 5.9E-10
DINN 17 13 MDTH 400E-12
VIN 17 5 3.000000e+00
DINR 15 18 MDTH 400E-12
VIP 4 18 3.000000E+00
FCP 4 5 VOFP 5.376190E+01
FCN 5 4 VOFN 5.376190E+01
FIBP 2 5 VOFN 1.904762E-03
FIBN 5 1 VOFP 1.904762E-03
* AMPLIFYING STAGE
FIP 5 19 VOFP 1.361905E+03
FIN 5 19 VOFN 1.361905E+03
RG1 19 5 8.864107E+05
RG2 19 4 8.864107E+05
CC 19 29 1.300000E-08
HZTP 30 29 VOFP 8.862530E+02
HZTN  5 30 VOFN 8.862530E+02
DOPM 19 22 MDTH 400E-12
DONM 21 19 MDTH 400E-12
HOPM 22 28 VOUT 7.500000E+03
VIPM 28 4 1.500000E+02
HONM 21 27 VOUT 7.500000E+03
VINM 5 27 1.500000E+02
GCOMP 5 4 4 5 6.485084E-04
RPM1 5 80 1E+09
RPM2 4 80 1E+09
GAVPH 5 82 19 80 2.59E-03
RAVPHGH 82 4 771
RAVPHGB 82 5 771
RAVPHDH 82 83 1000
RAVPHDB 82 84 1000
CAVPHH 4 83 0.331E-09
CAVPHB 5 84 0.331E-09
EOUT 26 23 82 5 1
VOUT 23 5 0
ROUT 26 3 120
COUT 3 5 1.000000E-12
DOP 19 25 MDTH 400E-12
VOP 4 25 1.981520E+00
DON 24 19 MDTH 400E-12
VON 24 5 1.981520E+00
.ENDS
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within 
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.


** Standard Linear Ics Macromodels, 1993. 
** CONNECTIONS :
* 1 INVERTING INPUT
* 2 NON-INVERTING INPUT
* 3 OUTPUT
* 4 POSITIVE POWER SUPPLY
* 5 NEGATIVE POWER SUPPLY
.SUBCKT TL07x 1 2 3 4 5
**********************************************************
.MODEL MDTH D IS=1E-8 KF=5.306587E-14 CJO=10F
* INPUT STAGE
CIP 2 5 1.000000E-12
CIN 1 5 1.000000E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 1.130435E+00
RIN 15 16 1.130435E+00
RIS 11 15 2.476554E-01
DIP 11 12 MDTH 400E-12
DIN 15 14 MDTH 400E-12
VOFP 12 13 DC 0
VOFN 13 14 DC 0
IPOL 13 5 2.300000E-04
CPS 11 15 4.091333E-08
DINN 17 13 MDTH 400E-12
VIN 17 5 3.000000e+00
DINR 15 18 MDTH 400E-12
VIP 4 18 0.000000E+00
FCP 4 5 VOFP 6.096957E+00
FCN 5 4 VOFN 6.096957E+00
* AMPLIFYING STAGE
FIP 5 19 VOFP 8.217391E+02
FIN 5 19 VOFN 8.217391E+02
RG1 19 5 1.112645E+06
RG2 19 4 1.112645E+06
CC 19 29 1.300000E-08
HZTP 30 29 VOFP 7.743183E+02
HZTN  5 30 VOFN 7.743183E+02
DOPM 19 22 MDTH 400E-12
DONM 21 19 MDTH 400E-12
HOPM 22 28 VOUT 3.750000E+03
VIPM 28 4 1.500000E+02
HONM 21 27 VOUT 3.750000E+03
VINM 5 27 1.500000E+02
EOUT 26 23 19 5 1
VOUT 23 5 0
ROUT 26 3 9.384786E+01
COUT 3 5 1.000000E-12
DOP 19 25 MDTH 400E-12
VOP 4 25 3.259753E+00
DON 24 19 MDTH 400E-12
VON 24 5 3.259753E+00
.ENDS; TL07x****************************************************************************
*
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation
*    time).
*
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
****************************************************************************
****
***  TS185x  Spice macromodel subckt 
***  December 2008 (last update: 05-10-2010)
****                      
************ CONNECTIONS: 
****             INVERTING INPUT
****              |  NON-INVERTING INPUT
****              |   |  OUTPUT 
****              |   |   |  POSITIVE POWER SUPPLY
****              |   |   |   |  NEGATIVE POWER SUPPLY 
****              |   |   |   |   |     
****              |   |   |   |   |    
.SUBCKT TS185X   VM  VP  VS  VCCP VCCN
    M_NMOS2 VO_DIFF_MINUS VM VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    M_NMOS1 VO_DIFF_PLUS NET194 VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    V_OUTVLIM_LOW NET0204 NET0196 DC {Vd_compensazione}
    V_OUTVLIM_HIGH NET0234 NET0211 DC {Vd_compensazione}
    VREADIO NET0193 VS DC 0
    VVLIM_LOW_VB NET192 NET193 DC -770m
    VOS NET194 VP DC 0
    VPROT_IN_P_VCCP NET196 NET229 DC {V_DPROT}
    V_ENHANCE_VCCN VCCN_ENHANCED VCCN DC {VCCN_enhance}
    VVLIM_HIGH_VB NET217 NET203 DC -770m
    V_ENHANCE_VCCP VCCP_ENHANCED VCCP DC {VCCP_enhance}
    VPROT_IN_M_VCCN NET208 NET360 DC {V_DPROT}
    VPROT_IN_P_VCCN NET212 NET213 DC {V_DPROT}
    VPROT_IN_M_VCCP NET348 NET219 DC {V_DPROT}
    D_OUTVLIM_HIGH NET0194 NET0234 DIODE_NOVd
    D_OUTVLIM_LOW NET0196 NET0233 DIODE_NOVd
    DVLIM_HIGH_VB VB NET217 DIODE_VLIM
    DPROT_IN_M_VCCP VM NET219 DIODE_VLIM
    DVLIM_LOW_VB NET193 VB DIODE_VLIM
    DPROT_IN_M_VCCN NET208 VM DIODE_VLIM
    DILIM_SINK VB_3_SINK VB_3 DIODE_ILIM
    DPROT_IN_P_VCCP NET194 NET229 DIODE_VLIM
    DILIM_SOURCE VB_3 VB_3_SOURCE DIODE_ILIM
    DPROT_IN_P_VCCN NET212 NET194 DIODE_VLIM
    C_RO2_1 VB_2 VREF 650p
    CIN_DIFF VM VP {CIN_DIFF}
    CIN_CM_VM VM VREF {CIN_CM_VM}
    CIN_CM_VP VP VREF {CIN_CM_VP}
    CDIFF_PARASITIC VO_DIFF_PLUS VO_DIFF_MINUS 12p
    CCOMP VB VB_2 {Ccomp}
    E64 IO_VAL 0 VALUE={I(VreadIo)}
    EMEAS_VB_VREF VB_VREF 0 VB VREF 1.0
    EVLIM_LOW_VB NET192 0 VCCN 0 1.0
    E_RO1 VB_3 NET0193 VALUE={IF(I(VreadIo)>0,
+V(Ro1_Voh)*I(VreadIo),V(Ro1_Vol)*I(VreadIo))}

*Eldo:
*    E_VOHNORL NET0194 VB_3 PWL(1) VCCP VCCN ( 1.8 , 16m ) ( 3.0 , 21m ) (
*+5.0 , 28.5m )
*    E_RO1_VOH RO1_VOH 0 PWL(1) VCCP VCCN ( 1.8 , 60 ) ( 3.0 , 57 ) ( 5.0 ,
*+41 )
*    E_VOLNORL VB_3 NET0233 PWL(1) VCCP VCCN ( 1.8 , 24m ) ( 3.0 , 26m ) (
*+5.0 , 32m )
*    E_RO1_VOL RO1_VOL 0 PWL(1) VCCP VCCN ( 1.8 , 38 ) ( 3.0 , 60 ) ( 5.0 ,
*+42 )
*PSpice:
*    E_VOHNORL NET0194 VB_3 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 16m , 3.0 , 21m ,
*+5.0 , 28.5m )}
    E_VOHNORL NET0194 VB_3 POLY(1) VCCP VCCN 0.00779687499999999
+0.0047916666666666715 -1.3020833333333404E-4
    *E_RO1_VOH RO1_VOH 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 60 , 3.0 , 57 , 5.0 ,
*+41 )}
    E_RO1_VOH RO1_VOH 0 POLY(1) VCCP VCCN 55.21875 5.75 -1.71875
    *E_VOLNORL VB_3 NET0233 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 24m , 3.0 , 26m ,
*+5.0 , 32m )}
    E_VOLNORL VB_3 NET0233 POLY(1) VCCP VCCN 0.02325
+-3.3333333333334427E-4 4.166666666666681E-4
    *E_RO1_VOL RO1_VOL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 38 , 3.0 , 60 , 5.0 ,
*+42 )}
    E_RO1_VOL RO1_VOL 0 POLY(1) VCCP VCCN -41.125 59.33333333333332
+-8.541666666666664

    E50 NET0211 0 VCCP 0 1.0
    E_ICCSAT_HIGH ICC_OUT_HIGH 0 POLY(1) VCCP VCCN 7.921875E-5 -3.75E-6
+7.8125E-7
    E51 NET0204 0 VCCN 0 1.0
    E_ICCSAT_LOW ICC_OUT_LOW 0 POLY(1) VCCP VCCN 0    
    EILIM_SINK VB_3_SINK VDEP_SINK VB_3 0 1.0
    EMEAS_VOUT_DIFF VOUT_DIFF 0 VO_DIFF_PLUS VO_DIFF_MINUS 1.0
    E_VDEP_SOURCE_2 VAL_VDEP_SOURCE_FILTERED 0
+VALUE={IF(V(val_vdep_source)>=0, 0, V(val_vdep_source))}
    E_VDEP_SOURCE_1 VAL_VDEP_SOURCE 0 VALUE={IF( V(Vccp,Vccn)<=3.0 ,  (
++9.5 +75*V(Vccp,Vccn) )  -5000*I(VreadIo)  , ( +227 +2.5*V(Vccp,Vccn) ) 
+-5000*I(VreadIo) )}
    E_VDEP_SOURCE_3 VDEP_SOURCE 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_source_filtered))}
    EVLIM_HIGH_VB NET203 0 VCCP 0 1.0
    E_VDEP_SINK_1 VAL_VDEP_SINK 0 VALUE={ ( -219.1875
+-6.666666666666708*V(Vccp,Vccn) + 0.5208333333333386*PWR(V(Vccp,Vccn),2) )
+-5000*I(VreadIo)}
    E_VDEP_SINK_2 VAL_VDEP_SINK_FILTERED 0
+VALUE={IF(V(val_vdep_sink)<=0 , 0 , V(val_vdep_sink))}
    E2_REF NET362 0 VCCN 0 1.0
    E_VREF VREF 0 NET356 0 1.0
    G_ICC VCCP VCCN POLY(1) VCCP VCCN 1.3553571428571613E-5
+8.222916666666653E-5 -1.551388888888886E-5 9.771825396825383E-7
    E_VDEP_SINK_3 VDEP_SINK 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_sink_filtered))}
    E1_REF NET326 0 VCCP 0 1.0
    EILIM_SOURCE VB_3_SOURCE VDEP_SOURCE VB_3 0 1.0
    E_SR_VCC_MODULATION VOUT_DIFF__SR_VCC 0 VALUE={V(Vout_diff)*(
+0.4390625 + 0.22416666666666657*V(Vccp,Vccn)
+-0.022395833333333323*PWR(V(Vccp,Vccn),2) )}
    RO2_1 VB_2 VREF {Ro2_1}
    RIN_CM_VM VREF VM {RIN_CM_VM}
    R1 VB VREF {R1}
    R_ICCSAT_LOW ICC_OUT_LOW 0 1K
    RO2_2 VB_3 VB_2 {Ro2_2}
    RPROT_IN_P_VCCP NET196 VCCP {RPROT_VCCP}
    RPROT_IN_M_VCCP VCCP NET348 {RPROT_VCCP}
    RIN_CM_VP VREF VP {RIN_CM_VP}
    RD1 VCCP_ENHANCED VO_DIFF_PLUS {RD}
    RD2 VCCP_ENHANCED VO_DIFF_MINUS {RD}
    RIN_DIFF VP VM {RIN_DIFF}
    R1_REF NET326 NET356 1Meg
    R_ICCSAT_HIGH ICC_OUT_HIGH 0 1K
    RPROT_IN_M_VCCN VCCN NET360 {RPROT_VCCN}
    R2_REF NET356 NET362 1Meg
    RPROT_IN_P_VCCN NET213 VCCN {RPROT_VCCN}
    
*Eldo:    
*    G_I_VB VB_2 VREF TABLE {V(VB_Vref)} = (-2.7 {-2.7*GB*3}) (-2.0
*+{-2.0*GB*2.5}) (-1.5 {-1.5*GB*2.2}) (-0.69 {-0.69*GB*2}) (-0.65
*+{-0.65*GB*1.0}) (-0.15 {-0.15*GB*1}) (-0.050 {-0.050*GB*1}) (-0.015
*+{-0.015*GB*1}) (-0.0001 {-0.0001*GB*1}) (0 0) (+0.0001 {0.0001*GB*1})
*+(+0.015 {+0.015*GB*1}) (+0.050 {+0.050*GB*1}) (+0.15 {+0.15*GB*1}) (+0.65
*+{0.65*GB*1.0}) (+0.69 {0.69*GB*2})  (+1.5 {1.5*GB*2.2}) (+2.0
*+{2.0*GB*2.5}) (+2.7 {2.7*GB*3})  
*PSpice:
*    G_I_VB VB_2 VREF VALUE={TABLE( V(VB,Vref) , -2.7 , -2.7*GB*3 , -2.0 ,
*+ -2.0*GB*2.5 , -1.5 , -1.5*GB*2.2 , -0.69 , -0.69*GB*2 , -0.65 ,
*+ -0.65*GB*1.0 , -0.15 , -0.15*GB*1 , -0.050 , -0.050*GB*1 , -0.015 ,
*+ -0.015*GB*1 , -0.0001 , -0.0001*GB*1 , 0 , 0 , +0.0001 , 0.0001*GB*1 ,
*+ +0.015 , +0.015*GB*1 , +0.050 , +0.050*GB*1 , +0.15 , +0.15*GB*1 , +0.65,
*+ 0.65*GB*1.0 , +0.69 , 0.69*GB*2 , +1.5 , 1.5*GB*2.2 , +2.0 ,
*+ 2.0*GB*2.5 , +2.7 , 2.7*GB*3 ) }
    G_I_VB VB_2 VREF POLY(1) VB_VREF 0 2.0955964330729256E-18
+0.0064704243141362125 -2.1354856438578985E-18 0.003032922143165251
+1.7832794554106567E-19 -1.99845853108853E-4

    G_I_IO VB_2 VREF VALUE={IF(abs(V(Io_val))<50m  , V(VB_Vref)*GB*(
+abs(V(Io_val))/2m ) , V(VB_Vref)*GB*( 50m/2m ) )}

*    G_IIB_VP VREF VP TABLE {V(Vccp,Vccn)} = (+1.8 10n) (+3.0 10n) (+5.0
*+16n)    
*    G_IIB_VM VREF VM TABLE {V(Vccp,Vccn)} = (+1.8 10n) (+3.0 10n) (+5.0
*+16n)
    G_IIB_VM VREF VM POLY(1) VCCP VCCN 7.5625E-9 1.1666666666666626E-9
+1.0416666666666735E-10
    G_IIB_VP VREF VP POLY(1) VCCP VCCN 7.5625E-9 1.1666666666666626E-9
+1.0416666666666735E-10

    G_ICCSAT_OUTLOW VCCP VCCN VALUE={IF(I(V_OUTVLIM_LOW)>1u ,
+V(Icc_out_low) , 0)}
    G_IOUT_SOURCED VCCP 0 VALUE={IF(I(VreadIo)>0, I(VreadIo),0)}
    GM1 VREF VB VOUT_DIFF__SR_VCC 0 {1/RD}
    IEE VEE_N VCCN_ENHANCED {IEE}
    G_ICCSAT_OUTHIGH VCCP VCCN VALUE={IF(I(V_OUTVLIM_HIGH)>1u ,
+V(Icc_out_high) , 0)}
    G_IOUT_SINKED VCCN 0 VALUE={IF(I(VreadIo)>0, 0, I(VreadIo))}

*** End of subcircuit definition.

*******************************************************************************
*
* MODELS/SUBCKTS and PARAMS used by TS185x subckt:
*
.PARAM RINCM=6.4777e+7
.PARAM CINCM=1.4646e-11
.PARAM RIN_CM_VM={2*RINCM}
.PARAM RIN_CM_VP={2*RINCM}
.PARAM CIN_CM_VM={CINCM/2}
.PARAM CIN_CM_VP={CINCM/2}
.PARAM RINDIFF=2.3412e+5
.PARAM CINDIFF=9.2768e-12
.PARAM RIN_DIFF={(2*RINCM*RINDIFF)/(2*RINCM - RINDIFF)}
.PARAM CIN_DIFF={CINDIFF - CINCM/2}
.PARAM RD=1k
.PARAM VCCP_enhance=150m
.PARAM VCCN_enhance=-1100m 
.PARAM A0 = 1.0597e+6
.PARAM Ro = 6.5024e+4
.PARAM Ccomp=11.5p 
.PARAM IEE=3u
.PARAM W=1.45u
.PARAM L=1u
.PARAM gm_mos=4.667416947578759e-05
.PARAM GB=6m 
.PARAM Ro1=50
.PARAM Ro2_2=1e-3 
.PARAM Ro2_1={Ro - Ro2_2 - Ro1} 
.PARAM R1={A0/(gm_mos*GB*Ro2_1)}
.PARAM V_DPROT=150m
.PARAM RPROT_VCCP=100
.PARAM RPROT_VCCN=15k
.PARAM Vd_compensazione=-788.4u

*Eldo:
*.MODEL MOS_N  NMOS LEVEL=1 MODTYPE=ELDO VTO=+0.65  KP=500E-6 
*.MODEL DIODE_NOVd D LEVEL=1 MODTYPE=ELDO IS=10E-15 N=0.001
*.MODEL DIODE_VLIM D LEVEL=1 MODTYPE=ELDO IS=0.8E-15   
*.MODEL DIODE_ILIM D LEVEL=1 MODTYPE=ELDO IS=0.8E-15  
*.MODEL DX D LEVEL=1 MODTYPE=ELDO IS=1E-14 
*PSpice:
.MODEL MOS_N  NMOS LEVEL=1 VTO=+0.65  KP=500E-6 
.MODEL DIODE_NOVd D LEVEL=1 IS=10E-15 N=0.001
.MODEL DIODE_VLIM D LEVEL=1 IS=0.8E-15   
.MODEL DIODE_ILIM D LEVEL=1 IS=0.8E-15  
.MODEL DX D LEVEL=1 IS=1E-14 
.ENDS 
*******************************************************************************
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within 
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
*
********************************
.SUBCKT TS27X 1 2 3 4 5 
*** INP- = 1, INP+ =2, OUT = 3 VDD=4 VSS = 5
*** TYPE = TS271/TS272/TS274
.MODEL MDTH D IS=1E-8 KF=2.664E-16 CJO=10F
***INPUT STAGE
CIP 2 5 1E-12
CIN 1 5 1E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 8
RIN 15 16 8
RIS 11 15 223.84
CPS 11 15 1E-9
DIP 11 120 MDTH 400E-12
DIN 15 140 MDTH 400E-12
RDEG1 12 120 4400
RDEG2 14 140 4400
VOFP 12 13 DC 0
VOFN 13 14 DC 0
IPOL 13 5 38E-6
***ICC
DICC1 4 31 MDTH 400E-12
DICC2 31 32 MDTH 400E-12
DICC3 32 33 MDTH 400E-12
DICC4 33 34 MDTH 400E-12
RICC 34 5 20E3
ICC 4 5 600E-6
***COMMON MODE INPUT LIMITATION
DINN 17 13 MDTH 400E-12
VIN 17 5 DC -0.1
DINR 15 18 MDTH 400E-12
VIP 4 18 DC 2.2
***GM1 STAGE
FGM1P 119 5 VOFP 1
FGM1N 119 5 VOFN 1
RAP 119 4 1E6
RAN 119 5 1E6
***GM2 STAGE
G2P 19 5 119 5 4E-4
G2N 19 5 119 4 4E-4
R2P 19 4 450E3
R2N 19 5 450E3
***COMPENSATION
CC 19 119 7p
***BUFFER
EBUF 20 5 19 5 1
***SHORT-CIRCUIT LIMITATIONS( ISINK, ISOURCE)
DOPM 19 22 MDTH 400E-12
DONM 21 19 MDTH 400E-12
HOPM 22 28 VOUT 910
VIPM 28 4 DC 50
HONM 21 27 VOUT 1222
VINM 5 27 DC 50
VOUT 3 23 DC 0
***VOH, VOL DEFINITIONS
DOP 19 25 MDTH 400E-12
VOP 4 25 2.5
DON 24 19 MDTH 400E-12
VON 24 5 0.92
***OUTPUT RESISTOR
ROUT 23 20 10
.ENDS
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within 
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
*
** Standard Linear Ics Macromodels, 1993. 
** CONNECTIONS :
* 1 INVERTING INPUT
* 2 NON-INVERTING INPUT
* 3 OUTPUT
* 4 POSITIVE POWER SUPPLY
* 5 NEGATIVE POWER SUPPLY
.SUBCKT TS321 1 2 3 4 5
***************************
.MODEL MDTH D IS=1E-8 KF=3.104131E-15 CJO=10F
* INPUT STAGE
CIP 2 5 1.000000E-12
CIN 1 5 1.000000E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 2.600000E+01
RIN 15 16 2.600000E+01
RIS 11 15 2.003862E+02
DIP 11 12 MDTH 400E-12
DIN 15 14 MDTH 400E-12
VOFP 12 13 DC 0 
VOFN 13 14 DC 0
IPOL 13 5 1.000000E-05
CPS 11 15 3.783376E-09
DINN 17 13 MDTH 400E-12
VIN 17 5 0.000000e+00
DINR 15 18 MDTH 400E-12
VIP 4 18 2.000000E+00
FCP 4 5 VOFP 3.400000E+01
FCN 5 4 VOFN 3.400000E+01
FIBP 2 5 VOFN 2.000000E-03
FIBN 5 1 VOFP 2.000000E-03
* AMPLIFYING STAGE
FIP 5 19 VOFP 3.600000E+02
FIN 5 19 VOFN 3.600000E+02
RG1 19 5 3.652997E+06
RG2 19 4 3.652997E+06
CC 19 5 6.000000E-09
DOPM 19 22 MDTH 400E-12
DONM 21 19 MDTH 400E-12
HOPM 22 28 VOUT 7.500000E+03
VIPM 28 4 1.500000E+02
HONM 21 27 VOUT 7.500000E+03
VINM 5 27 1.500000E+02
EOUT 26 23 19 5 1
VOUT 23 5 0
ROUT 26 3 20
COUT 3 5 1.000000E-12
DOP 19 25 MDTH 400E-12
VOP 4 25 2.242230E+00
DON 24 19 MDTH 400E-12
VON 24 5 7.922301E-01
.ENDS* WARNING : please consider following remarks before usage *
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal 
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions 
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*-----------------------------------------------------------------------------------------
** Standard Linear Ics Macromodels, 1999. 
** CONNECTIONS :
* N1 INVERTING INPUT
* N2 NON-INVERTING INPUT
* N3 OUTPUT
* N4 POSITIVE POWER SUPPLY
* N5 NEGATIVE POWER SUPPLY
*
.SUBCKT TS46x N1 N2 N3 N4 N5
*****************************
CCC N119 N19 16p
CC30 N5 N3 130p
CCIP N2 N5 1p
CCIN N1 N5 1p
CCPS N11 N15 100p
EEIP N10 N5 N2 N5 1
EEIN N16 N5 N1 N5 1
RRAN N119 N5 260K
RR28 N19 N23 6
RRAP N119 N4 260K
RR2N N5 N19 10Meg
RR2P N19 N4 10Meg
RRIP N11 N10 8.12
RRIS N11 N15 220
RRIN N15 N16 8.12
DDOPM N19 N22 MDTH 400p
DDONM N21 N19 MDTH 400p
DDCOPY N504 N505 MDTH 400E-9
DDINR N15 N18 MDTH 400E-12
DDOP N19 N25 MDTH 400p
DD39 N506 N504 MDTH 400E-9
DDON N24 N19 MDTH 400p
DDIN N15 N14 MDTH 400p
DDIP N11 N12 MDTH 400p
DDINN N17 N13 MDTH 400E-12
VVOFN N13 N14 0
VVINM N5 N27 60
VVIPM N28 N4 76
VVOFP N12 N13 -1m
VVCOPYP N505 0 0
VVIN N17 N5 900m
VVOUT N3 N23 0
VVIP N4 N18 1.4
VVINT2 N503 0 5
VVINT1 N500 0 5
VVN N502 0 0
VVP N501 0 0
RVVN N501 0 10
RVVP N502 0 10
VVCOPYN 0 N506 0
VVOP N4 N25 1
VVON N24 N5 1.025
IIPOL N13 N5 63.6u
FFGM1P N119 N5 VVOFP 1
FFGM1N N119 N5 VVOFN 1
FFCOPY N503 N504 VVOUT 1
FFCP N4 N5 VVOFP 33.8
FFIBP N2 N5 VVOFP 7.85e-3
FFIBN N5 N1 VVOFN 7.85e-3
FFCN N5 N4 VVOFN 33.8
GG2P N19 N5 N119 N5 1.92e-2
GGCONVP N500 0 N119 N4 19.38
GGCONVN N500 0 N119 N5 19.38
GG2N N19 N5 N119 N4 1.92e-2
HHONM N21 N27 VVOUT 625
HHOPN N22 N28 VVOUT 62500
.MODEL MDTH D IS=1E-8 KF=2.664234E-16 CJO=10F
F2PP N19 N5 POLY(2) VVCOPYP VVP 0 0 0 0 0.5 
F2PN N19 N5 POLY(2) VVCOPYP VVN 0 0 0 0 0.5
.ENDS ;TS46x* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation
* time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
* validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
* SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
* Thus the macromodel is often not as exhaustive as the datasheet, its goal
* is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
* (Vcc, Temperature, etc) or even worse: outside of the device operating
* conditions (Vcc, Vicm, etc) are not reliable in any way.
*
****************************************************************************
****
****  TS507  Spice macromodel subckt
****
****  Version 2.0 (January 2010) (last update: 05-10-2010)
****
*********** CONNECTIONS: 
****           INVERTING INPUT
****            |  NON-INVERTING INPUT
****            |   |  OUTPUT 
****            |   |   |  POSITIVE POWER SUPPLY
****            |   |   |   |  NEGATIVE POWER SUPPLY
****            |   |   |   |   | 
****            |   |   |   |   | 
.SUBCKT TS507  VM  VP  VS  VCCP VCCN
    FIOUT 0 VZOUT VREADIO 1.0
    LOUT_REF VZOUT 0 {Lout}
    M_NMOS2 VO_DIFF_MINUS VM VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    M_NMOS1 VO_DIFF_PLUS NET235 VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    IEE_N VEE_N VCCN_ENHANCED DC {IEE}
    VREADIO NET0370 VS DC 0
    VVLIM_LOW_VB NET233 NET234 DC -770m
    VOS NET235 VP DC 0
    VPROT_IN_P_VCCP NET237 NET270 DC {V_DPROT}
    V_ENHANCE_VCCN VCCN_ENHANCED VCCN DC -360m
    VVLIM_HIGH_VB NET258 NET242 DC -770m
    V_ENHANCE_VCCP VCCP_ENHANCED VCCP DC -500m
    V_OUTVLIM_LOW NET245 NET246 DC {Vd_compensazione}
    VPROT_IN_M_VCCN NET247 NET429 DC {V_DPROT}
    V_OUTVLIM_HIGH NET276 NET250 DC {Vd_compensazione}
    VPROT_IN_P_VCCN NET251 NET252 DC {V_DPROT}
    VPROT_IN_M_VCCP NET417 NET260 DC {V_DPROT}
    DVLIM_HIGH_VB VB NET258 DIODE_VLIM
    DPROT_IN_M_VCCP VM NET260 DIODE_VLIM
    DVLIM_LOW_VB NET234 VB DIODE_VLIM
    DPROT_IN_M_VCCN NET247 VM DIODE_VLIM
    DILIM_SINK VB_3_SINK VB_3 DIODE_ILIM
    D_OUTVLIM_LOW NET246 NET268 DIODE_NOVd
    DPROT_IN_P_VCCP NET235 NET270 DIODE_VLIM
    DILIM_SOURCE VB_3 VB_3_SOURCE DIODE_ILIM
    DPROT_IN_P_VCCN NET251 NET235 DIODE_VLIM
    D_OUTVLIM_HIGH NET373 NET276 DIODE_NOVd
    CIN_CM_VM VM VREF {CIN_CM_VM}
    COUT2 VZOUT 0 {Cout2}
    COUT NET0309 0 {Cout}
    CIN_DIFF VM VP {CIN_DIFF}
    CZOUT_IOUT_COEFF VZOUT_IOUT_COEFF 0 1n
    CDIFF VO_DIFF_PLUS VO_DIFF_MINUS 32p
    CIN_CM_VP VP VREF {CIN_CM_VP}
    C_RO2_1 VB_2 VREF 10.3n
    CCOMP VB VB_2 {Ccomp}
    EZOUT_VCC_COEFF VZOUT_VCC_COEFF 0 POLY(1) VCCP VCCN 1.830882352941178
+-0.2887254901960797 0.024509803921568797
    E50 IO_VAL 0 VALUE={I(VreadIo)}
    EMEAS_VB_VREF VB_VREF 0 VB VREF 1.0
    EILIM_SINK VB_3_SINK VDEP_SINK VB_3 0 1.0
    EMEAS_VOUT_DIFF VOUT_DIFF 0 VO_DIFF_PLUS VO_DIFF_MINUS 1.0
    EZOUT_IOUT_COEFF NET0307 0 VALUE={( Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau)) )}
    E_ICCSAT_LOW ICC_OUT_LOW 0 POLY(1) VCCP VCCN 0
    E_VDEP_SOURCE_3 VDEP_SOURCE 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_source_filtered))}
    EILIM_SOURCE VB_3_SOURCE VDEP_SOURCE VB_3 0 1.0
    E_VDEP_SOURCE_1 VAL_VDEP_SOURCE 0 VALUE={ (-155.57672634242113 +
+79.09207161106947*V(Vccp,Vccn) + 15.984654731486176*PWR(V(Vccp,Vccn),2) )
+ -5000*I(VreadIo)}
    EVLIM_HIGH_VB NET242 0 VCCP 0 1.0
    EVLIM_HIGH_VOUT NET250 0 VCCP 0 1.0
    EVLIM_LOW_VB NET233 0 VCCN 0 1.0
    E_VDEP_SINK_3 VDEP_SINK 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_sink_filtered))}
    E_VOL NET268 VB_3 VALUE={ V(Ro1_Vol)*I(VreadIo)}
    E2_REF NET431 0 VCCN 0 1.0
    EZOUT VB_3 NET0370
+VALUE={V(VZout)*V(VZout_Iout_coeff)*V(VZout_Vcc_coeff)}
    E_VREF VREF 0 NET425 0 1.0
    E_VDEP_SINK_2 VAL_VDEP_SINK_FILTERED 0
+VALUE={IF(V(val_vdep_sink)<=0 , 0 , V(val_vdep_sink))}

    *E_RO1_VOL RO1_VOL 0 VALUE={TABLE(V(VCCP,VCCN), 2.7 , 27 , 3.3 , 22 , 5.0 , 16)}
    E_RO1_VOL RO1_VOL 0 POLY(1) VCCP VCCN 68.10997442455245
+-20.865302642796284 2.088661551577158
    
    E_VOH NET373 VB_3 VALUE={ V(Ro1_Voh)*I(VreadIo)}
    
    *E_RO1_VOH RO1_VOH 0 VALUE={TABLE(V(VCCP,VCCN), 2.7 , 27 , 3.3 , 23 , 5.0 , 16.5)}
    E_RO1_VOH RO1_VOH 0 POLY(1) VCCP VCCN 56.01406649616369
+-14.08354646206311 1.2361466325660737
    
    E1_REF NET381 0 VCCP 0 1.0
    E_VDEP_SINK_1 VAL_VDEP_SINK 0 VALUE={ (198.5306905368759
+-111.63682864437875*V(Vccp,Vccn) -6.393861892600456*PWR(V(Vccp,Vccn),2) )
+-5000*I(VreadIo)}
    E_ICCSAT_HIGH ICC_OUT_HIGH 0 POLY(1) VCCP VCCN 0
    E_VDEP_SOURCE_2 VAL_VDEP_SOURCE_FILTERED 0
+VALUE={IF(V(val_vdep_source)>=0, 0, V(val_vdep_source))}
    EVLIM_LOW_VOUT NET245 0 VCCN 0 1.0
    RZOUT_IOUT_COEFF VZOUT_IOUT_COEFF NET0307 50
    RIN_CM_VP VREF VP {RIN_CM_VP}
    ROUT NET0309 VZOUT {Rout}
    RIN_DIFF VP VM {RIN_DIFF}
    RIN_CM_VM VREF VM {RIN_CM_VM}
    R_ICCSAT_HIGH ICC_OUT_HIGH 0 1K
    R_ICCSAT_LOW ICC_OUT_LOW 0 1K
    RO2_2 VB_3 VB_2 {Ro2_2}
    RPROT_IN_P_VCCP NET237 VCCP 100
    RPROT_IN_M_VCCP VCCP NET417 100
    RD1 VCCP_ENHANCED VO_DIFF_PLUS {RD}
    RD2 VCCP_ENHANCED VO_DIFF_MINUS {RD}
    RO2_1 VREF VB_2 {Ro2_1}
    R1_REF NET381 NET425 1Meg
    R1 VB VREF {R1}
    RPROT_IN_M_VCCN VCCN NET429 15K
    R2_REF NET425 NET431 1Meg
    RPROT_IN_P_VCCN NET252 VCCN 15K
    G_I_IO VB_2 VREF VALUE={V(VB_Vref)*GB*( 5*( 1 -
+exp(-abs(V(Io_val))/10m )) ) }  

    *G_IIB_VM VREF VM TABLE {V(Vccp,Vccn)} = (+2.7 8n) (+3.3 6n) (+5.0 8n)
    *G_IIB_VP VREF VP TABLE {V(Vccp,Vccn)} = (+2.7 8n) (+3.3 6n) (+5.0 8n)
    G_IIB_VM VREF VM POLY(1) VCCP VCCN 3.447058823529414E-8
+-1.5098039215686306E-8 1.9607843137254952E-9
    G_IIB_VP VREF VP POLY(1) VCCP VCCN 3.447058823529414E-8    
+-1.5098039215686306E-8 1.9607843137254952E-9

    G_ICCSAT_OUTLOW VCCP VCCN VALUE={IF(I(V_OUTVLIM_LOW)>1u ,
+V(Icc_out_low) , 0)}
    G_ICCSAT_OUTHIGH VCCP VCCN VALUE={IF(I(V_OUTVLIM_HIGH)>1u ,
+V(Icc_out_high), 0)}
    G_I_VB VB_2 VREF VB_VREF 0 {GB}
    G_IOUT_SOUCED VCCP 0 VALUE={IF(I(VreadIo)>0, I(VreadIo),0)}
    GM1 VREF VB VOUT_DIFF 0 {1/RD}
    G_ICC VCCP VCCN POLY(1) VCCP VCCN 6.477204603580559E-4
+5.890878090366602E-5 -4.262574595055444E-6
    G_IOUT_SINKED VCCN 0 VALUE={IF(I(VreadIo)>0, 0, I(VreadIo))}

.PARAM RINCM=6.4777e+7
.PARAM CINCM=1.4646e-11
.PARAM RIN_CM_VM={2*RINCM}
.PARAM RIN_CM_VP={2*RINCM}
.PARAM CIN_CM_VM={CINCM/2}
.PARAM CIN_CM_VP={CINCM/2}
.PARAM RINDIFF=2.3412e+5
.PARAM CINDIFF=9.2768e-12
.PARAM RIN_DIFF={(2*RINCM*RINDIFF)/(2*RINCM - RINDIFF)}
.PARAM CIN_DIFF={CINDIFF - CINCM/2}
.PARAM RD=1k
.PARAM Ccomp=23.5p 
.PARAM IEE=14.3u
.PARAM GB=0.813 
.PARAM A0=1.5e+7 
.PARAM Ro=3.6122e+4
.PARAM W=11u
.PARAM L=1u
.PARAM gm_mos=0.0002807210724691585
.PARAM Lout  = 6u
.PARAM Rout  = 141.25
.PARAM Cout  = 1.2n
.PARAM Cout2 = 5p
.PARAM Zout_Iout_coeff_MIN=0.1  
.PARAM Iout_dc_tau = 3m 
.PARAM Ro2_2=1e-3
.PARAM Ro2_1={ Ro - Ro2_2 }  
.PARAM R1={A0/(gm_mos*GB*Ro2_1)}
.PARAM V_DPROT=0.6
.PARAM Vd_compensazione=-788.4u

.MODEL MOS_N  NMOS LEVEL=1 VTO=+0.65  KP=500E-6
.MODEL DIODE_NOVd D LEVEL=1 IS=10E-15 N=0.001
.MODEL DIODE_VLIM D LEVEL=1 IS=0.8E-15  
.MODEL DIODE_ILIM D LEVEL=1 IS=0.8E-15

.ENDS
*
*********************************************************************************** 
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component valu
es.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within 
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
** Standard Linear Ics Macromodels, 1993. 
** CONNECTIONS :
* 1 INVERTING INPUT
* 2 NON-INVERTING INPUT
* 3 OUTPUT
* 4 POSITIVE POWER SUPPLY
* 5 NEGATIVE POWER SUPPLY
.SUBCKT TS912 1 2 3 4 5 
**********************************************************
.MODEL MDTH D IS=1E-8 KF=6.563355E-14 CJO=10F
* INPUT STAGE
CIP 2 5 1.500000E-12
CIN 1 5 1.500000E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 6.500000E+00
RIN 15 16 6.500000E+00
RIS 11 15 7.655100E+00
DIP 11 12 MDTH 400E-12
DIN 15 14 MDTH 400E-12
VOFP 12 13 DC 0.000000E+00
VOFN 13 14 DC 0
IPOL 13 5 4.000000E-05 
CPS 11 15 3.82E-08
DINN 17 13 MDTH 400E-12
VIN 17 5 -0.5000000e+00
DINR 15 18 MDTH 400E-12
VIP 4 18 -0.5000000E+00
FCP 4 5 VOFP 7.750000E+00
FCN 5 4 VOFN 7.750000E+00
* AMPLIFYING STAGE
FIP 5 19 VOFP 5.500000E+02
FIN 5 19 VOFN 5.500000E+02
RG1 19 5 5.087344E+05
RG2 19 4 5.087344E+05
CC 19 29 2.200000E-08
HZTP 30 29 VOFP 12.33E+02
HZTN  5 30 VOFN 12.33E+02
DOPM 19 22 MDTH 400E-12
DONM 21 19 MDTH 400E-12
HOPM 22 28 VOUT 3135
VIPM 28 4 150
HONM 21 27 VOUT 3135
VINM 5 27 150
EOUT 26 23 19 5 1
VOUT 23 5 0
ROUT 26 3 65
COUT 3 5 1.000000E-12
DOP 19 68 MDTH 400E-12
VOP 4 25 1.924
HSCP 68 25 VSCP1 1E8
DON 69 19 MDTH 400E-12
VON 24 5 2.4419107
HSCN 24 69 VSCN1 1.5E8
VSCTHP 60 61 0.1375
DSCP1 61 63 MDTH 400E-12
VSCP1 63 64 0
ISCP 64 0 1.000000E-8
DSCP2 0 64 MDTH 400E-12
DSCN2 0 74 MDTH 400E-12
ISCN 74 0 1.000000E-8
VSCN1 73 74 0
DSCN1 71 73 MDTH 400E-12
VSCTHN 71 70 -0.75
ESCP 60 0 2 1 500
ESCN 70 0 2 1 -2000
.ENDS
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component valu
es.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within 
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
** Standard Linear Ics Macromodels, 1993.
** CONNECTIONS :
* 1 INVERTING INPUT
* 2 NON-INVERTING INPUT
* 3 OUTPUT
* 4 POSITIVE POWER SUPPLY
* 5 NEGATIVE POWER SUPPLY
*
.SUBCKT TS914 1 2 3 4 5  
*************************************************
.MODEL MDTH D IS=1E-8 KF=6.564344E-14 CJO=10F 
CIP 2 5 1.000000E-12
CIN 1 5 1.000000E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 6.500000E+00
RIN 15 16 6.500000E+00
RIS 11 15 7.322092E+00
DIP 11 12 MDTH 400E-12
DIN 15 14 MDTH 400E-12
VOFP 12 13 DC 0.000000E+00
VOFN 13 14 DC 0
IPOL 13 5 4.000000E-05
CPS 11 15 2.498970E-08
DINN 17 13 MDTH 400E-12
VIN 17 5 0.000000e+00
DINR 15 18 MDTH 400E-12
VIP 4 18 0.000000E+00
FCP 4 5 VOFP 5.750000E+00
FCN 5 4 VOFN 5.750000E+00
* AMPLIFYING STAGE
FIP 5 19 VOFP 4.400000E+02
FIN 5 19 VOFN 4.400000E+02
RG1 19 5 4.904961E+05
RG2 19 4 4.904961E+05
CC 19 29 2.200000E-08
HZTP 30 29 VOFP 1.8E+03
HZTN 5 30 VOFN 1.8E+03
DOPM 19 22 MDTH 400E-12
DONM 21 19 MDTH 400E-12
HOPM 22 28 VOUT 3800
VIPM 28 4 230
HONM 21 27 VOUT 3800
VINM 5 27 230
EOUT 26 23 19 5 1
VOUT 23 5 0
ROUT 26 3 82
COUT 3 5 1.000000E-12
DOP 19 68 MDTH 400E-12
VOP 4 25 1.724
HSCP 68 25 VSCP1 0.8E+8
DON 69 19 MDTH 400E-12
VON 24 5 1.7419107
HSCN 24 69 VSCN1 0.8E+8
VSCTHP 60 61 0.0875 
DSCP1 61 63 MDTH 400E-12
VSCP1 63 64 0
ISCP 64 0 1.000000E-8
DSCP2 0 64 MDTH 400E-12
DSCN2 0 74 MDTH 400E-12
ISCN 74 0 1.000000E-8
VSCN1 73 74 0
DSCN1 71 73 MDTH 400E-12
VSCTHN 71 70 -0.55
ESCP 60 0 2 1 500
ESCN 70 0 2 1 -2000
.ENDS 
* WARNING : please consider following remarks before usage *
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal 
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions 
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*-----------------------------------------------------------------------------------------
** Standard Linear Ics Macromodels, 1996.
** CONNECTIONS :
* 1 INVERTING INPUT
* 2 NON-INVERTING INPUT
* 3 OUTPUT
* 4 POSITIVE POWER SUPPLY
* 5 NEGATIVE POWER SUPPLY
*
.SUBCKT TS92X 1 2 3 4 5 
*
.MODEL MDTH D IS=1E-8 KF=2.664234E-16 CJO=10F
*
* INPUT STAGE
CIP 2 5 1.000000E-12
CIN 1 5 1.000000E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 8.125000E+00
RIN 15 16 8.125000E+00
RIS 11 15 2.238465E+02
DIP 11 12 MDTH 400E-12
DIN 15 14 MDTH 400E-12
VOFP 12 13 DC 153.5u
VOFN 13 14 DC 0
IPOL 13 5 3.200000E-05
CPS 11 15 1e-9
DINN 17 13 MDTH 400E-12
VIN 17 5 -0.100000e+00
DINR 15 18 MDTH 400E-12
VIP 4 18 0.400000E+00
FCP 4 5 VOFP 1.865000E+02
FCN 5 4 VOFN 1.865000E+02
FIBP 2 5 VOFP 6.250000E-03
FIBN 5 1 VOFN 6.250000E-03
* GM1 STAGE ***************
FGM1P 119 5 VOFP 1.1
FGM1N 119 5 VOFN 1.1
RAP 119 4 2.6E+06
RAN 119 5 2.6E+06
* GM2 STAGE *************** 
G2P 19 5 119 5 1.92E-02
G2N 19 5 119 4 1.92E-02
R2P 19 4 1E+07
R2N 19 5 1E+07
**************************
VINT1 500 0 5
GCONVP 500 501 119 4 19.38 
VP 501 0 0
GCONVN 500 502 119 5 19.38 
VN 502 0 0
********* orientation isink isource *******
VINT2 503 0 5
FCOPY 503 504 VOUT 1
DCOPYP 504 505 MDTH 400E-9
VCOPYP 505 0 0
DCOPYN 506 504 MDTH 400E-9
VCOPYN 0 506 0
***************************
F2PP 19 5 poly(2) VCOPYP VP 0 0 0 0 0.5 
F2PN 19 5 poly(2) VCOPYP VN 0 0 0 0 0.5 
F2NP 19 5 poly(2) VCOPYN VP 0 0 0 0 1.75 
F2NN 19 5 poly(2) VCOPYN VN 0 0 0 0 1.75 
* COMPENSATION ************
CC 19 119 25p
* OUTPUT ***********
DOPM 19 22 MDTH 400E-12
DONM 21 19 MDTH 400E-12
HOPM 22 28 VOUT 6.250000E+02
VIPM 28 4 5.000000E+01
HONM 21 27 VOUT 6.250000E+02
VINM 5 27 5.000000E+01
VOUT 3 23 0
ROUT 23 19 6
COUT 3 5 1.300000E-10
DOP 19 25 MDTH 400E-12
VOP 4 25 1.052
DON 24 19 MDTH 400E-12
VON 24 5 1.052
.ENDS ;TS92X* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within 
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
* -------------------------------------------------------------------------
*
** Standard Linear Ics Macromodels
** CONNECTIONS :
* 1 INVERTING INPUT
* 2 NON-INVERTING INPUT
* 3 OUTPUT
* 4 POSITIVE POWER SUPPLY
* 5 NEGATIVE POWER SUPPLY
*
.SUBCKT TS93X 1 2 3 4 5
********************************************************** 
.MODEL MDTH D IS=1E-8 KF=2.626433E-33 CJO=10F
.MODEL NDTH D IS=1E-12
* INPUT STAGE
CIP 2 5 1.000000E-12
CIN 1 5 1.000000E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 2.600000E+01
RIN 15 16 2.600000E+01
RIS 11 15 1.433696E+02
DIP 11 12 MDTH 400E-12
DIN 15 14 MDTH 400E-12
VOFP 12 13 DC 0.000000E+00
VOFN 13 14 DC 0
IPOL 13 5 1.000000E-05
CPS 11 15 7.404465E-09
DINN 17 13 MDTH 400E-12
VIN 17 5 -0.5000000e+00
DINR 15 18 MDTH 400E-12
VIP 4 18 2.1
FCP 4 5 VOFP 2
FCN 5 4 VOFN 2
* AMPLIFYING STAGE
FIP 5 19 VOFP 7.000000E+00
FIN 5 19 VOFN 7.000000E+00
DOPM 51 22 MDTH 400E-12
DONM 21 52 MDTH 400E-12
HOPM 22 28 VOUT 72500
VIPM 28 4 1.500000E+02
HONM 21 27 VOUT 33333
VINM 5 27 1.500000E+02
CC 19 29 1.10000E-09
HZTP 30 29 VOFP 8.414314E+02
HZTN  5 30 VOFN 8.414314E+02
DPOS 19 53 NDTH 400E-12
VPOS 51 53 0.75
DNEG 54 19 NDTH 400E-12
VNEG 54 52 0.75
RG11 51 5 8.29E+08
RG12 51 4 8.29E+08
RG21 52 5 1.43E+07
RG22 52 4 1.43E+07
E1 50 40 51 0 1
E2 40 39 52 0 1
EDEC1 38 39 4 0 0.5
EDEC2 0 38 5 0 0.5
RFOL 50 5 1E12
EOUT 26 23 50 5 1
VOUT 23 5 0
ROUT 26 3 100
COUT 3 5 1.000000E-12
DOP 19 25 MDTH 400E-12
VOP 4 25 7.822301E-01
DON 24 19 MDTH 400E-12
VON 24 5 6.722301E-01
.ENDS


* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within 
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
* -------------------------------------------------------------------------
*
** Standard Linear Ics Macromodels
** CONNECTIONS :
* 1 INVERTING INPUT
* 2 NON-INVERTING INPUT
* 3 OUTPUT
* 4 POSITIVE POWER SUPPLY
* 5 NEGATIVE POWER SUPPLY
*
.SUBCKT TS94X 1 2 3 4 5
********************************************************** 
.MODEL MDTH D IS=1E-8 KF=2.626433E-33 CJO=10F
.MODEL NDTH D IS=1E-12
* INPUT STAGE
CIP 2 5 1.000000E-12
CIN 1 5 1.000000E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 2.600000E+01
RIN 15 16 2.600000E+01
RIS 11 15 1.433696E+02
DIP 11 12 MDTH 400E-12
DIN 15 14 MDTH 400E-12
VOFP 12 13 DC 0.000000E+00
VOFN 13 14 DC 0
IPOL 13 5 1.000000E-05
CPS 11 15 7.404465E-09
DINN 17 13 MDTH 400E-12
VIN 17 5 -0.5000000e+00
DINR 15 18 MDTH 400E-12
VIP 4 18 2.1
FCP 4 5 VOFP 0.1
FCN 5 4 VOFN 0.1
* AMPLIFYING STAGE
FIP 5 19 VOFP 7.000000E+00
FIN 5 19 VOFN 7.000000E+00
DOPM 51 22 MDTH 400E-12
DONM 21 52 MDTH 400E-12
HOPM 22 28 VOUT 72500
VIPM 28 4 1.500000E+02
HONM 21 27 VOUT 33333
VINM 5 27 1.500000E+02
CC 19 29 11.900000E-09
HZTP 30 29 VOFP 8.414314E+02
HZTN  5 30 VOFN 8.414314E+02
DPOS 19 53 NDTH 400E-12
VPOS 51 53 0.75
DNEG 54 19 NDTH 400E-12
VNEG 54 52 0.75
RG11 51 5 8.29E+08
RG12 51 4 8.29E+08
RG21 52 5 1.43E+07
RG22 52 4 1.43E+07
E1 50 40 51 0 1
E2 40 39 52 0 1
EDEC1 38 39 4 0 0.5
EDEC2 0 38 5 0 0.5
RFOL 50 5 1E12
EOUT 26 23 50 5 1
VOUT 23 5 0
ROUT 26 3 100
COUT 3 5 1.000000E-12
DOP 19 25 MDTH 400E-12
VOP 4 25 7.822301E-01
DON 24 19 MDTH 400E-12
VON 24 5 6.722301E-01
.ENDS* WARNING : please consider following remarks before usage *
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal 
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions 
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*-----------------------------------------------------------------------------------------
** Standard Linear Ics Macromodels, 1996.
** CONNECTIONS :
* 1 INVERTING INPUT
* 2 NON-INVERTING INPUT
* 3 OUTPUT
* 4 POSITIVE POWER SUPPLY
* 5 NEGATIVE POWER SUPPLY
*
.SUBCKT TS95X 1 2 3 4 5 
*
.MODEL MDTH D IS=1E-8 KF=2.664234E-16 CJO=10F
*
* INPUT STAGE
CIP 2 5 1.000000E-12
CIN 1 5 1.000000E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 8.125000E+00
RIN 15 16 8.125000E+00
RIS 11 15 2.238465E+02
DIP 11 12 MDTH 400E-12
DIN 15 14 MDTH 400E-12
VOFP 12 13 DC 153.5u
VOFN 13 14 DC 0
IPOL 13 5 3.200000E-05
CPS 11 15 1e-9
DINN 17 13 MDTH 400E-12
VIN 17 5 -0.100000e+00
DINR 15 18 MDTH 400E-12
VIP 4 18 0.400000E+00
FCP 4 5 VOFP 1.865000E+02
FCN 5 4 VOFN 1.865000E+02
FIBP 2 5 VOFP 6.250000E-03
FIBN 5 1 VOFN 6.250000E-03
* GM1 STAGE ***************
FGM1P 119 5 VOFP 1.1
FGM1N 119 5 VOFN 1.1
RAP 119 4 2.6E+06
RAN 119 5 2.6E+06
* GM2 STAGE *************** 
G2P 19 5 119 5 1.92E-02
G2N 19 5 119 4 1.92E-02
R2P 19 4 1E+07
R2N 19 5 1E+07
**************************
VINT1 500 0 5
GCONVP 500 501 119 4 19.38 
VP 501 0 0
GCONVN 500 502 119 5 19.38 
VN 502 0 0
********* orientation isink isource *******
VINT2 503 0 5
FCOPY 503 504 VOUT 1
DCOPYP 504 505 MDTH 400E-9
VCOPYP 505 0 0
DCOPYN 506 504 MDTH 400E-9
VCOPYN 0 506 0
***************************
F2PP 19 5 poly(2) VCOPYP VP 0 0 0 0 0.5 
F2PN 19 5 poly(2) VCOPYP VN 0 0 0 0 0.5 
F2NP 19 5 poly(2) VCOPYN VP 0 0 0 0 1.75 
F2NN 19 5 poly(2) VCOPYN VN 0 0 0 0 1.75 
* COMPENSATION ************
CC 19 119 25p
* OUTPUT ***********
DOPM 19 22 MDTH 400E-12
DONM 21 19 MDTH 400E-12
HOPM 22 28 VOUT 6.250000E+02
VIPM 28 4 5.000000E+01
HONM 21 27 VOUT 6.250000E+02
VINM 5 27 5.000000E+01
VOUT 3 23 0
ROUT 23 19 6
COUT 3 5 1.300000E-10
DOP 19 25 MDTH 400E-12
VOP 4 25 1.052
DON 24 19 MDTH 400E-12
VON 24 5 1.052
.ENDS * WARNING : please consider following remarks before usage *
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal 
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions 
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*-----------------------------------------------------------------------------------------
** Standard Linear Ics Macromodels, 1999. 
** CONNECTIONS :
* N1 INVERTING INPUT
* N2 NON-INVERTING INPUT
* N3 OUTPUT
* N4 POSITIVE POWER SUPPLY
* N5 NEGATIVE POWER SUPPLY
*
.SUBCKT TS97x N1 N2 N3 N4 N5
*****************************
CCC N119 N19 16p
CC30 N5 N3 130p
CCIP N2 N5 1p
CCIN N1 N5 1p
CCPS N11 N15 100p
EEIP N10 N5 N2 N5 1
EEIN N16 N5 N1 N5 1
RRAN N119 N5 260K
RR28 N19 N23 6
RRAP N119 N4 260K
RR2N N5 N19 10Meg
RR2P N19 N4 10Meg
RRIP N11 N10 8.12
RRIS N11 N15 220
RRIN N15 N16 8.12
DDOPM N19 N22 MDTH 400p
DDONM N21 N19 MDTH 400p
DDCOPY N504 N505 MDTH 400E-9
DDINR N15 N18 MDTH 400E-12
DDOP N19 N25 MDTH 400p
DD39 N506 N504 MDTH 400E-9
DDON N24 N19 MDTH 400p
DDIN N15 N14 MDTH 400p
DDIP N11 N12 MDTH 400p
DDINN N17 N13 MDTH 400E-12
VVOFN N13 N14 0
VVINM N5 N27 60
VVIPM N28 N4 76
VVOFP N12 N13 -1m
VVCOPYP N505 0 0
VVIN N17 N5 900m
VVOUT N3 N23 0
VVIP N4 N18 1.4
VVINT2 N503 0 5
VVINT1 N500 0 5
VVN N502 0 0
VVP N501 0 0
RVVN N501 0 10
RVVP N502 0 10
VVCOPYN 0 N506 0
VVOP N4 N25 1
VVON N24 N5 1.025
IIPOL N13 N5 63.6u
FFGM1P N119 N5 VVOFP 1
FFGM1N N119 N5 VVOFN 1
FFCOPY N503 N504 VVOUT 1
FFCP N4 N5 VVOFP 33.8
FFIBP N2 N5 VVOFP 7.85e-3
FFIBN N5 N1 VVOFN 7.85e-3
FFCN N5 N4 VVOFN 33.8
GG2P N19 N5 N119 N5 1.92e-2
GGCONVP N500 0 N119 N4 19.38
GGCONVN N500 0 N119 N5 19.38
GG2N N19 N5 N119 N4 1.92e-2
HHONM N21 N27 VVOUT 625
HHOPN N22 N28 VVOUT 62500
.MODEL MDTH D IS=1E-8 KF=2.664234E-16 CJO=10F
F2PP N19 N5 POLY(2) VVCOPYP VVP 0 0 0 0 0.5 
F2PN N19 N5 POLY(2) VVCOPYP VVN 0 0 0 0 0.5
.ENDS ;TS97x* WARNING : please consider following remarks before usage *
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal 
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions 
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*-----------------------------------------------------------------------------------------
** Standard Linear Ics Macromodels
** CONNECTIONS :
* 1 INVERTING INPUT
* 2 NON-INVERTING INPUT
* 3 OUTPUT
* 4 POSITIVE POWER SUPPLY
* 5 NEGATIVE POWER SUPPLY
*
.SUBCKT TS982 1 2 3 4 5 
*
.MODEL MDTH D IS=1E-8 KF=2.664234E-16 CJO=10F
*
* INPUT STAGE
CIP 2 5 1.000000E-12
CIN 1 5 1.000000E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 8.125000E+00
RIN 15 16 8.125000E+00
RIS 11 15 2.238465E+02
DIP 11 12 MDTH 400E-12
DIN 15 14 MDTH 400E-12
VOFP 12 13 DC 153.5u
VOFN 13 14 DC 0
IPOL 13 5 3.200000E-05
CPS 11 15 1e-9
DINN 17 13 MDTH 400E-12
VIN 17 5 -0.100000e+00
DINR 15 18 MDTH 400E-12
VIP 4 18 0.400000E+00
FCP 4 5 VOFP 1.865000E+02
FCN 5 4 VOFN 1.865000E+02
FIBP 2 5 VOFP 6.20000E-03
FIBN 5 1 VOFN 6.20000E-03
ICC 5 4 3.5m
* GM1 STAGE ***************
FGM1P 119 5 VOFP 1.1
FGM1N 119 5 VOFN 1.1
RAP 119 4 2.6E+06
RAN 119 5 2.6E+06
* GM2 STAGE *************** 
G2P 19 5 119 5 1.92E-02
G2N 19 5 119 4 1.92E-02
R2P 19 4 1E+07
R2N 19 5 1E+07
**************************
VINT1 500 0 5
GCONVP 500 501 119 4 19.38 
VP 501 0 0
GCONVN 500 502 119 5 19.38 
VN 502 0 0
********* orientation isink isource *******
VINT2 503 0 5
FCOPY 503 504 VOUT 1
DCOPYP 504 505 MDTH 400E-9
VCOPYP 505 0 0
DCOPYN 506 504 MDTH 400E-9
VCOPYN 0 506 0
***************************
F2PP 19 5 poly(2) VCOPYP VP 0 0 0 0 0.5 
F2PN 19 5 poly(2) VCOPYP VN 0 0 0 0 0.5 
F2NP 19 5 poly(2) VCOPYN VP 0 0 0 0 1.75 
F2NN 19 5 poly(2) VCOPYN VN 0 0 0 0 1.75 
* COMPENSATION ************
CC 19 119 30p
* OUTPUT ***********
DOPM 19 22 MDTH 400E-12
DONM 21 19 MDTH 400E-12
HOPM 22 28 VOUT 4.0000E+02
VIPM 28 4 5.000000E+01
HONM 21 27 VOUT 4.00000E+02
VINM 5 27 5.000000E+01
VOUT 3 23 0
ROUT 23 19 6
COUT 3 5 1.300000E-10
DOP 19 25 MDTH 400E-12
VOP 4 25 0.5
DON 24 19 MDTH 400E-12
VON 24 5 0.5
.ENDS ;TS982****************************************************************************
*
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation
*    time).
*
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
****************************************************************************
****
***  TSV3x  Spice macromodel subckt 
***  December 2008
****                      
************ CONNECTIONS: 
****             INVERTING INPUT
****              |  NON-INVERTING INPUT
****              |   |  OUTPUT 
****              |   |   |  POSITIVE POWER SUPPLY
****              |   |   |   |  NEGATIVE POWER SUPPLY 
****              |   |   |   |   |     
****              |   |   |   |   |    
.SUBCKT TSV3x    VM  VP  VS  VCCP VCCN
    M_NMOS2 VO_DIFF_MINUS VM VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    M_NMOS1 VO_DIFF_PLUS NET0262 VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    V_OUTVLIM_LOW NET0204 NET0196 DC {Vd_compensazione}
    V_OUTVLIM_HIGH NET0234 NET0211 DC {Vd_compensazione}
    VREADIO NET0191 VS DC 0
    VVLIM_LOW_VB NET192 NET193 DC {Vd_compensazione}
    VOS NET0262 VP DC 0
    VPROT_IN_P_VCCP NET196 NET229 DC {V_DPROT}
    V_ENHANCE_VCCN VCCN_ENHANCED VCCN DC {VCCN_enhance}
    VVLIM_HIGH_VB NET217 NET203 DC {Vd_compensazione}
    V_ENHANCE_VCCP VCCP_ENHANCED VCCP DC {VCCP_enhance}
    VPROT_IN_M_VCCN NET208 NET360 DC {V_DPROT}
    VPROT_IN_P_VCCN NET212 NET213 DC {V_DPROT}
    VPROT_IN_M_VCCP NET348 NET219 DC {V_DPROT}
    D_OUTVLIM_HIGH NET0279 NET0234 DIODE_NOVd
    D_OUTVLIM_LOW NET0196 NET0238 DIODE_NOVd
    DVLIM_HIGH_VB VB NET217 DIODE_NOVd
    DPROT_IN_M_VCCP VM NET219 DIODE_VLIM
    DVLIM_LOW_VB NET193 VB DIODE_NOVd
    DPROT_IN_M_VCCN NET208 VM DIODE_VLIM
    DILIM_SINK VB_3_SINK VB_3 DIODE_ILIM
    DPROT_IN_P_VCCP NET0262 NET229 DIODE_VLIM
    DILIM_SOURCE VB_3 VB_3_SOURCE DIODE_ILIM
    DPROT_IN_P_VCCN NET212 NET0262 DIODE_VLIM
    C_RO2_1 VB_2 VREF 140p
    CIN_DIFF VM VP {CIN_DIFF}
    CIN_CM_VM VM VREF {CIN_CM_VM}
    CIN_CM_VP VP VREF {CIN_CM_VP}
    CDIFF_PARASITIC VO_DIFF_PLUS VO_DIFF_MINUS 12p
    CCOMP VB VB_2 {Ccomp}
    E_VDEP_SINK_1 VAL_VDEP_SINK 0 VALUE={IF( V(Vccp,Vccn)<=3.0 ,  (
+-212 -62.5*V(Vccp,Vccn) )  -5000*I(VreadIo)  , ( -399.5  ) 
+-5000*I(VreadIo) )}
    E_RO1 VB_3 NET0191 VALUE={IF(I(VreadIo)>0,
+V(Ro1_Voh)*I(VreadIo),V(Ro1_Vol)*I(VreadIo))}

*Eldo:
*    E_VOHNORL NET0279 VB_3 PWL(1) VCCP VCCN ( 1.8 , 24m ) ( 3.0 , 26m ) (
*+5.0 , 37m )
*    E_RO1_VOH RO1_VOH 0 PWL(1) VCCP VCCN ( 1.8 , 20 ) ( 3.0 , 18 ) ( 5.0 ,
*+12 )
*    E_VOLNORL VB_3 NET0238 PWL(1) VCCP VCCN ( 1.8 , 24m ) ( 3.0 , 32m ) (
*+5.0 , 42m )
*    E_RO1_VOL RO1_VOL 0 PWL(1) VCCP VCCN ( 1.8 , 15 ) ( 3.0 , 11 ) ( 5.0 ,
*+7 )
*PSpice:
    E_VOHNORL NET0279 VB_3 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 24m , 3.0 , 26m ,
+5.0 , 37m )}
    E_RO1_VOH RO1_VOH 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 20 , 3.0 , 18 , 5.0 ,
+12 )}
    E_VOLNORL VB_3 NET0238 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 24m , 3.0 , 32m ,
+5.0 , 42m )}
    E_RO1_VOL RO1_VOL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 15 , 3.0 , 11 , 5.0 ,
+7 )}

    E50 NET0211 0 VCCP 0 1.0
    E64 IO_VAL 0 VALUE={I(VreadIo)}
    E_ICCSAT_HIGH ICC_OUT_HIGH 0 POLY(1) VCCP VCCN -8.65625E-5
+2.533333333333334E-4 -2.7604166666666666E-5
    E51 NET0204 0 VCCN 0 1.0
    E_ICCSAT_LOW ICC_OUT_LOW 0 POLY(1) VCCP VCCN 0
    EILIM_SINK VB_3_SINK VDEP_SINK VB_3 0 1.0
    EMEAS_VB_VREF VB_VREF 0 VB VREF 1.0
    EMEAS_VOUT_DIFF VOUT_DIFF 0 VO_DIFF_PLUS VO_DIFF_MINUS 1.0
    E_VDEP_SOURCE_2 VAL_VDEP_SOURCE_FILTERED 0 VALUE={
+IF(V(val_vdep_source)>=0, 0, V(val_vdep_source)) }
    E_VDEP_SOURCE_1 VAL_VDEP_SOURCE 0 VALUE={IF( V(Vccp,Vccn)<=3.0 ,  (
++212 +62.5*V(Vccp,Vccn) )  -5000*I(VreadIo)  , ( +399.5  ) 
+-5000*I(VreadIo) )}
    E_VDEP_SOURCE_3 VDEP_SOURCE 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_source_filtered))}
    EVLIM_HIGH_VB NET203 0 VCCP 0 1.0
    E_VDEP_SINK_2 VAL_VDEP_SINK_FILTERED 0 VALUE={
+IF(V(val_vdep_sink)<=0 , 0 , V(val_vdep_sink)) }
    EVLIM_LOW_VB NET192 0 VCCN 0 1.0
    E2_REF NET362 0 VCCN 0 1.0
    E_VREF VREF 0 NET356 0 1.0
    G_ICC VCCP VCCN POLY(1) VCCP VCCN 2.93875E-4 6.666666666666659E-5
+-5.208333333333321E-6
    E_VDEP_SINK_3 VDEP_SINK 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_sink_filtered))}
    E1_REF NET326 0 VCCP 0 1.0
    EILIM_SOURCE VB_3_SOURCE VDEP_SOURCE VB_3 0 1.0
    E_SR_VCC_MODULATION VOUT_DIFF__SR_VCC 0 VALUE={V(Vout_diff)*( 0.796875
++ 0.06666666666666655*V(Vccp,Vccn) -0.005208333333333318*V(Vccp,Vccn)^2
+)}
    RIN_CM_VM VREF VM {RIN_CM_VM}
    R1 VB VREF {R1}
    RIN_CM_VP VREF VP {RIN_CM_VP}
    R_ICCSAT_LOW ICC_OUT_LOW 0 1K
    RIN_DIFF VP VM {RIN_DIFF}
    RO2_2 VB_3 VB_2 {Ro2_2}
    RPROT_IN_P_VCCP NET196 VCCP {RPROT_VCCP}
    RPROT_IN_M_VCCP VCCP NET348 {RPROT_VCCP}
    RO2_1 VB_2 VREF {Ro2_1}
    RD1 VCCP_ENHANCED VO_DIFF_PLUS {RD}
    RD2 VCCP_ENHANCED VO_DIFF_MINUS {RD}
    R1_REF NET326 NET356 1Meg
    R_ICCSAT_HIGH ICC_OUT_HIGH 0 1K
    RPROT_IN_M_VCCN VCCN NET360 {RPROT_VCCN}
    R2_REF NET356 NET362 1Meg
    RPROT_IN_P_VCCN NET213 VCCN {RPROT_VCCN}
    
*Eldo:    
*    G_IIB_VP VREF VP TABLE {V(Vccp,Vccn)} = (+1.8 40n) (+3.0 40n) (+5.0
*+70n)
*    G_IIB_VM VREF VM TABLE {V(Vccp,Vccn)} = (+1.8 40n) (+3.0 40n) (+5.0
*+70n)
*PSpice:
    G_IIB_VP VREF VP VALUE={TABLE(V(Vccp,Vccn), +1.8 , 40n , +3.0 , 40n , +5.0 ,
+70n)}
    G_IIB_VM VREF VM VALUE={TABLE(V(Vccp,Vccn), +1.8 , 40n , +3.0 , 40n , +5.0 ,
+70n)}
    
    G_ICCSAT_OUTLOW VCCP VCCN VALUE={IF(I(V_OUTVLIM_LOW)>1u ,
+V(Icc_out_low) , 0)}

*Eldo:
*    G_I_VB VB_2 VREF TABLE {V(VB,Vref)} = (-2.7 {-2.7*GB*5}) (-2.0
*+{-2.0*GB*4}) (-1.5 {-1.5*GB*3}) (-0.85 {-0.85*GB*2}) (-0.8 {-0.8*GB*1.0})
*+(-0.15 {-0.15*GB*1}) (-0.050 {-0.050*GB*1}) (-0.015 {-0.015*GB*1})
*+(-0.0001 {-0.0001*GB*1}) (0 0) (+0.0001 {0.0001*GB*1}) (+0.015
*+{+0.015*GB*1}) (+0.050 {+0.050*GB*1}) (+0.15 {+0.15*GB*1}) (+0.8
*+{0.8*GB*1.0}) (+0.85 {0.85*GB*2})  (+1.5 {1.5*GB*3}) (+2.0 {2.0*GB*4})
*+(+2.7 {2.7*GB*5})  
*PSpice:
    G_I_VB VB_2 VREF VALUE={ TABLE( V(VB_Vref) , -2.7 , -2.7*GB*5 , -2.0 ,
+ -2.0*GB*4 , -1.5 , -1.5*GB*3 , -0.85 , -0.85*GB*2 , -0.8 , -0.8*GB*1.0 ,
+ -0.15 , -0.15*GB*1 , -0.050 , -0.050*GB*1 , -0.015 , -0.015*GB*1 ,
+ -0.0001 , -0.0001*GB*1 , 0 , 0 , +0.0001 , +0.0001*GB*1 , +0.015 ,
+ +0.015*GB*1 , +0.050 , +0.050*GB*1 , +0.15 , +0.15*GB*1 , +0.8 ,
+ +0.8*GB*1.0 , +0.85 , +0.85*GB*2 , +1.5 , +1.5*GB*3 , +2.0 , +2.0*GB*4 ,
+ +2.7 ,+2.7*GB*5) } 

    G_IOUT_SOURCED VCCP 0 VALUE={IF(I(VreadIo)>0, I(VreadIo),0)}
    GM1 VREF VB VOUT_DIFF__SR_VCC 0 {1/RD}
    IEE VEE_N VCCN_ENHANCED {IEE}
    G_ICCSAT_OUTHIGH VCCP VCCN VALUE={IF(I(V_OUTVLIM_HIGH)>1u ,
+V(Icc_out_high) , 0)}
    G_IOUT_SINKED VCCN 0 VALUE={IF(I(VreadIo)>0, 0, I(VreadIo))}
    G_I_IO VB_2 VREF VALUE={IF(abs(V(Io_val))<50m  , V(VB_Vref)*GB*(
+abs(V(Io_val))/3m ) , V(VB_Vref)*GB*( 50m/3m ) )}

*** End of subcircuit definition.

*******************************************************************************
*
* MODELS/SUBCKTS and PARAMS used by TSV3x subckt:
*
.PARAM RINCM=6.4777e+7
.PARAM CINCM=1.4646e-11
.PARAM RIN_CM_VM={2*RINCM}
.PARAM RIN_CM_VP={2*RINCM}
.PARAM CIN_CM_VM={CINCM/2}
.PARAM CIN_CM_VP={CINCM/2}
.PARAM RINDIFF=2.3412e+5
.PARAM CINDIFF=9.2768e-12
.PARAM RIN_DIFF={(2*RINCM*RINDIFF)/(2*RINCM - RINDIFF)}
.PARAM CIN_DIFF={CINDIFF - CINCM/2}
.PARAM RD=1k
.PARAM VCCP_enhance=150m
.PARAM VCCN_enhance=-1100m 
.PARAM A0 = 6.8366e+5
.PARAM Ro = 2.5282e+4
.PARAM Ccomp=4.85p 
.PARAM IEE=3u
.PARAM W=2.1u
.PARAM L=1u
.PARAM gm_mos=5.617737386835048e-05
.PARAM GB=6m 
.PARAM Ro1=15
.PARAM Ro2_2=1e-3 
.PARAM Ro2_1={Ro - Ro2_2 - Ro1}
.PARAM R1={A0/(gm_mos*GB*Ro2_1)}
.PARAM V_DPROT=150m
.PARAM RPROT_VCCP=100
.PARAM RPROT_VCCN=15k
.PARAM Vd_compensazione=-788.4u

*Eldo:
*.MODEL MOS_N  NMOS LEVEL=1 MODTYPE=ELDO VTO=+0.65  KP=500E-6 
*.MODEL DIODE_NOVd D LEVEL=1 MODTYPE=ELDO IS=10E-15 N=0.001
*.MODEL DIODE_VLIM D LEVEL=1 MODTYPE=ELDO IS=0.8E-15   
*.MODEL DIODE_ILIM D LEVEL=1 MODTYPE=ELDO IS=0.8E-15  
*.MODEL DX D LEVEL=1 MODTYPE=ELDO IS=1E-14 
*PSpice:
.MODEL MOS_N  NMOS LEVEL=1  VTO=+0.65  KP=500E-6 
.MODEL DIODE_NOVd D LEVEL=1  IS=10E-15 N=0.001
.MODEL DIODE_VLIM D LEVEL=1  IS=0.8E-15   
.MODEL DIODE_ILIM D LEVEL=1  IS=0.8E-15  
.MODEL DX D LEVEL=1  IS=1E-14 
.ENDS
*******************************************************************************
****************************************************************************
*
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation
*    time).
*
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
****************************************************************************
****
***  TSV61x  Spice macromodel subckt 
***  Version 2.0  (March 2010) (last update: 05-10-2010)
****                      
************ CONNECTIONS: 
****             INVERTING INPUT
****              |  NON-INVERTING INPUT
****              |   |  OUTPUT 
****              |   |   |  POSITIVE POWER SUPPLY
****              |   |   |   |  NEGATIVE POWER SUPPLY 
****              |   |   |   |   |      
****              |   |   |   |   |   
.SUBCKT TSV61X   VM  VP  VS VCCP VCCN
    FIOUT 0 VZOUT VREADIO 1.0
    LOUT VZOUT 0 {Lout}
    G_IIB_VM VREF VM VALUE={1p}
    G_I_IO VB_2 VREF VALUE={V(VB_Vref)*GB*( 10*( 1 -
+exp(-abs(V(v_Io_val))/3m )) )  }
    GM1 VREF VB VOUT_DIFF__SR_VCC 0 {1/RD}
    G_ICC VCCP VCCN POLY(1) VCCP VCCN 8.423161764705879E-6
+-7.29166666666657E-8 7.965686274509793E-8
    G_ICCSAT_OUTHIGH VCCP VCCN VALUE={IF(I(V_OUTVLIM_HIGH)>1u ,
+V(Icc_out_high), 0)}
    G_IIB_VP VREF VP VALUE={1p}
    G_IOUT_SINKED VCCN 0 VALUE={IF(I(VreadIo)>0, 0, I(VreadIo))}
    G_I_VB VB_2 VREF VB_VREF 0 {GB}
    G_IOUT_SOURCED VCCP 0 VALUE={IF(I(VreadIo)>0, I(VreadIo),0)}
    G_ICCSAT_OUTLOW VCCP VCCN VALUE={IF(I(V_OUTVLIM_LOW)>1u ,
+V(Icc_out_low) , 0)}
    ROUT NET0249 VZOUT {Rout}
    RZOUT_IOUT_COEFF VZOUT_IOUT_COEFF NET0286 50
    RIN_DIFF VP VM 1T
    RIN_CM_VM VREF VM {RIN_CM_VM}
    RO2_1 VB_2 VREF {Ro2_1}
    RPROT_IN_P_VCCP NET403 VCCP 100
    RPROT_IN_M_VCCP VCCP NET241 100
    RD1 VCCP_ENHANCED VO_DIFF_PLUS {RD}
    RD2 VCCP_ENHANCED VO_DIFF_MINUS {RD}
    R1_REF NET271 NET235 1Meg
    R_ICCSAT_HIGH ICC_OUT_HIGH 0 1K
    R2_REF NET235 NET229 1Meg
    RPROT_IN_M_VCCN VCCN NET231 15K
    RPROT_IN_P_VCCN NET388 VCCN 15K
    RIN_CM_VP VREF VP {RIN_CM_VP}
    R_ICCSAT_LOW ICC_OUT_LOW 0 1K
    RO2_2 VB_3 VB_2 {Ro2_2}
    EVLIM_HIGH_VOUT NET390 0 VALUE={V(VCCP) - V(Ro1_Voh)*I(VreadIo)}
    E_READIO V_IO_VAL 0 VALUE={I(VreadIo)}
    EILIM_SINK VB_3_SINK VDEP_SINK VB_3 0 1.0
    E_ICCSAT_HIGH ICC_OUT_HIGH 0 POLY(1) VCCP VCCN 0
    E_VDEP_SINK_3 VDEP_SINK 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_sink_filtered))}
    EVLIM_LOW_VOUT NET393 0 VALUE={V(VCCN) - V(Ro1_Vol)*I(VreadIo) +
+V(VOLnoRL)}
    EMEAS_VB_VREF VB_VREF 0 VB VREF 1.0
    E2_REF NET229 0 VCCN 0 1.0
    EVLIM_LOW_VB NET407 0 VCCN 0 1.0
    
    *E_RO1_VOL RO1_VOL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 45 , 3.3 , 25 , 5.0 ,
*+24 )}
    E_RO1_VOL RO1_VOL 0 POLY(1) VCCP VCCN 92.65808823529412
+-33.64583333333336 3.9828431372549056

    E_VDEP_SOURCE_2 VAL_VDEP_SOURCE_FILTERED 0
+VALUE={IF(V(val_vdep_source)>=0, 0, V(val_vdep_source))}
    E_VDEP_SOURCE_1 VAL_VDEP_SOURCE 0 VALUE={ ( -155.26102941176467 +
+124.8958333333334*V(Vccp,Vccn) -6.188725490196091*PWR(V(Vccp,Vccn),2) ) 
+-5000*I(VreadIo)}
    E_VDEP_SOURCE_3 VDEP_SOURCE 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_source_filtered))}
    EZOUT VB_3 NET0213
+VALUE={V(VZout)*V(VZout_Iout_coeff)*V(VZout_Vcc_coeff)}
    E_VDEP_SINK_1 VAL_VDEP_SINK 0 VALUE={ ( 302.61248012718784
+-270.8887965505632*V(Vccp,Vccn) + 40.840439369851765*PWR(V(Vccp,Vccn),2)
+-2.0294358529653245*PWR(V(Vccp,Vccn),3) ) -5000*I(VreadIo)}
    EVLIM_HIGH_VB NET398 0 VCCP 0 1.0
    E1_REF NET271 0 VCCP 0 1.0
    E_R1 NET295 VREF VALUE={I(VreadI_R1)*( R1_sink
++(R1_source-R1_sink)*1/(1+exp(-alpha_switch*(V(v_Io_val)-Io_val_switch) )
+)) }

    *E_VOLNORL VOLNORL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 3m , 3.3 , 6m , 5.0 ,
*+10m )}
    E_VOLNORL VOLNORL 0 POLY(1) VCCP VCCN 5.5147058823525646E-5 0.0014375
+1.102941176470584E-4

    E_VDEP_SINK_2 VAL_VDEP_SINK_FILTERED 0
+VALUE={IF(V(val_vdep_sink)<=0 , 0 , V(val_vdep_sink))}
    E_VREF VREF 0 NET235 0 1.0
    EMEAS_VOUT_DIFF VOUT_DIFF 0 VO_DIFF_PLUS VO_DIFF_MINUS 1.0
    
    *E_RO1_VOH RO1_VOH 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 53 , 3.3 , 33 , 5.0 ,
*+27 )}
    E_RO1_VOH RO1_VOH 0 POLY(1) VCCP VCCN 95.19852941176471
+-28.958333333333357 3.0637254901960818

    EILIM_SOURCE VB_3_SOURCE VDEP_SOURCE VB_3 0 1.0
    
    *EZOUT_VCC_COEFF VZOUT_VCC_COEFF 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 1.3 , 3.3
*+, 1.2 , 5.0 , 1.0 )}
    EZOUT_VCC_COEFF VZOUT_VCC_COEFF 0 POLY(1) VCCP VCCN 1.3253676470588234
+0.014583333333333308 -0.015931372549019603

    EZOUT_IOUT_COEFF NET0286 0 VALUE={( Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau)) )}
    E_ICCSAT_LOW ICC_OUT_LOW 0 POLY(1) VCCP VCCN -3.8158972691807494E-5
+3.732444733420025E-5
    E_SR_VCC_MODULATION VOUT_DIFF__SR_VCC 0 VALUE={V(Vout_diff)*( +
+0.7536764705882353 + 0.012499999999999935*V(Vccp,Vccn) +
+0.007352941176470591*PWR(V(Vccp,Vccn),2) )}
    COUT2 VZOUT 0 {Cout2}
    CIN_DIFF VM VP {CIN_DIFF}
    CIN_CM_VP VP VREF {CIN_CM_VP}
    CZOUT_IOUT_COEFF VZOUT_IOUT_COEFF 0 1n
    CCOMP VB VB_2 {Ccomp}
    CDIFF_PARASITIC VO_DIFF_PLUS VO_DIFF_MINUS 130p
    CIN_CM_VM VM VREF {CIN_CM_VM}
    C_RO2_1 VB_2 VREF 35n
    COUT NET0249 0 {Cout}
    DVLIM_HIGH_VB VB NET382 DIODE_VLIM
    DILIM_SINK VB_3_SINK VB_3 DIODE_ILIM
    D_OUTVLIM_HIGH VB_3 NET364 DIODE_NOVd
    DPROT_IN_P_VCCN NET387 NET405 DIODE_VLIM
    DPROT_IN_M_VCCP VM NET380 DIODE_VLIM
    DILIM_SOURCE VB_3 VB_3_SOURCE DIODE_ILIM
    DPROT_IN_P_VCCP NET405 NET370 DIODE_VLIM
    DPROT_IN_M_VCCN NET391 VM DIODE_VLIM
    DVLIM_LOW_VB NET408 VB DIODE_VLIM
    D_OUTVLIM_LOW NET394 VB_3 DIODE_NOVd
    VVLIM_HIGH_VB NET382 NET398 DC -770m
    VPROT_IN_P_VCCN NET387 NET388 DC {V_DPROT}
    VREADI_R1 VB NET295 DC 0
    VPROT_IN_P_VCCP NET403 NET370 DC {V_DPROT}
    VOS NET405 VP DC 0
    V_OUTVLIM_HIGH NET364 NET390 DC {Vd_compensazione}
    VPROT_IN_M_VCCP NET241 NET380 DC {V_DPROT}
    V_ENHANCE_VCCN VCCN_ENHANCED VCCN DC {VCCN_enhance}
    V_ENHANCE_VCCP VCCP_ENHANCED VCCP DC {VCCP_enhance}
    VREADIO NET0213 VS DC 0
    VPROT_IN_M_VCCN NET391 NET231 DC {V_DPROT}
    VVLIM_LOW_VB NET407 NET408 DC -770m
    V_OUTVLIM_LOW NET393 NET394 DC {Vd_compensazione}
    IEE_N VEE_N VCCN_ENHANCED DC {IEE}
    M_NMOS2 VO_DIFF_MINUS VM VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    M_NMOS1 VO_DIFF_PLUS NET405 VEE_N VCCN_ENHANCED MOS_N L={L} W={W}

*** End of subcircuit definition.


*******************************************************************************
*
* MODELS/SUBCKTS and PARAMS used by TSV61x subckt:
*
.PARAM RINCM=2.0828E+11
.PARAM CINCM=6.3492E-12
.PARAM RIN_CM_VM={2*RINCM}
.PARAM RIN_CM_VP={2*RINCM}
.PARAM CIN_CM_VM={CINCM/2}
.PARAM CIN_CM_VP={CINCM/2}
.PARAM CINDIFF=3.2785E-12
.PARAM CIN_DIFF={CINDIFF - CINCM/2}
.PARAM RD=1k
.PARAM VCCP_enhance=150m
.PARAM VCCN_enhance=-1100m 
.PARAM GB=62.16m 
.PARAM Ro = 794328
.PARAM A0_source =  158489319
.PARAM A0_sink = 1.3e+6
.PARAM Lout  = 1.8m
.PARAM Rout  = 5600
.PARAM Cout  = 333p
.PARAM Cout2 = 3.5p
.PARAM Zout_Iout_coeff_MIN= 0.01
.PARAM Iout_dc_tau = 0.05m 
.PARAM alpha_switch = 1e6
.PARAM Io_val_switch = -7u
.PARAM Ccomp=11p 
.PARAM IEE=0.45u
.PARAM W=0.31u
.PARAM L=1u
.PARAM gm_mos=8.359416242253981e-06
.PARAM Ro2_2=1e-3 
.PARAM Ro2_1={ Ro - Ro2_2 } 
.PARAM R1_sink={A0_sink/(gm_mos*GB*Ro2_1)}
.PARAM R1_source={A0_source/(gm_mos*GB*Ro2_1)}
.PARAM V_DPROT=150m
.PARAM Vd_compensazione=-788.4u

.MODEL MOS_N  NMOS LEVEL=1  VTO=+0.65  KP=500E-6 
.MODEL DIODE_NOVd D LEVEL=1  IS=10E-15 N=0.001
.MODEL DIODE_VLIM D LEVEL=1  IS=0.8E-15   
.MODEL DIODE_ILIM D LEVEL=1  IS=0.8E-15  
*
.ENDS
*******************************************************************************
****************************************************************************
*
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation
*    time).
*
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
****************************************************************************
****
***  TSV620  (WITH STAND-BY)  Spice macromodel subckt 
***  Version 2.0  (March 2010) (last update: 05-10-2010)
****                      
************ CONNECTIONS: 
****             INVERTING INPUT
****              |  NON-INVERTING INPUT
****              |   |  OUTPUT 
****              |   |   |  POSITIVE POWER SUPPLY
****              |   |   |   |  NEGATIVE POWER SUPPLY 
****              |   |   |   |   |     STAND-BY 
****              |   |   |   |   |     |
.SUBCKT TSV620   VM  VP  VS VCCP VCCN  STB
    FIOUT 0 VZOUT VREADIO 1.0
    LOUT VZOUT 0 {Lout}
    S_SW_OUT     VS_STB VS VSTB_CTRL 0     SW_OUT
    S_SW_LEAK    VS 0 VSTB_CTRL 0          SW_LEAK
    S_SW_VB2_VS  VB_2 NET0220 VSTB_CTRL 0  SW_VB2_VS
    S_SW_VB_VREF VB NET0224 VSTB_CTRL 0    SW_VB_VREF
    G_IEE_STB VEE_N VCCN_ENHANCED POLY(2) VSTB_CTRL 0 IEE_val 0 0 0 0 0 1
    G_ICC_STB VCCP VCCN POLY(2) VSTB_CTRL 0 Icc_val 0 0 0 0 0 1
    G_IOUT_SINKED VCCN 0 VALUE={IF(I(VreadIo)>0, 0, I(VreadIo))}
    G2_ICC_STB VCCP VCCN VALUE={ICC_STB*( 1-V(VSTB_ctrl) )}
    G_ICCSAT_OUTHIGH VCCP VCCN VALUE={IF(I(V_OUTVLIM_HIGH)>1u ,
+V(Icc_out_high)*V(VSTB_ctrl), 0)}
    
    *G_IIB_VP VREF VP TABLE {V(Vccp,Vccn)} = (+1.8 1p) (+3.3 1p) (+5.0 1p)
    G_IIB_VP VREF VP VALUE={1p}
    
    G_ICCSAT_OUTLOW VCCP VCCN VALUE={IF(I(V_OUTVLIM_LOW)>1u ,
+V(Icc_out_low)*V(VSTB_ctrl) , 0)}
    G_IOUT_SOURCED VCCP 0 VALUE={IF(I(VreadIo)>0, I(VreadIo),0)}
    GM1 VREF VB VOUT_DIFF__SR_VCC 0 {1/RD}
    
    *G_IIB_VM VREF VM TABLE {V(Vccp,Vccn)} = (+1.8 1p) (+3.3 1p) (+5.0 1p)
    G_IIB_VM VREF VM VALUE={1p}
    
    G_I_IO VB_2 VREF VALUE={V(VB_Vref)*GB*( 10*( 1 -
+exp(-abs(V(v_Io_val))/3m )) )  }
    G_ISTB 0 STB VALUE={ Iil_STB*(1-V(VSTB_one)) -Iih_STB*V(VSTB_one)}
    G_I_VB VB_2 VREF VB_VREF 0 {GB}
    RSTB_CTRL VSTB_CTRL VSTB_ONE {RSTB_ctrl}
    RD1 VCCP_ENHANCED VO_DIFF_PLUS {RD}
    RD2 VCCP_ENHANCED VO_DIFF_MINUS {RD}
    R1_REF NET287 NET247 1Meg
    R_ICCSAT_HIGH ICC_OUT_HIGH 0 1K
    RPROT_IN_M_VCCN VCCN NET243 15K
    R2_REF NET247 NET241 1Meg
    RPROT_IN_P_VCCN NET406 VCCN 15K
    RZOUT_IOUT_COEFF VZOUT_IOUT_COEFF NET0360 50
    RO2_2 VB_3 VB_2 {Ro2_2}
    R_ICCSAT_LOW ICC_OUT_LOW 0 1K
    RPROT_IN_M_VCCP VCCP NET253 100
    RPROT_IN_P_VCCP NET421 VCCP 100
    ROUT NET0325 VZOUT {Rout}
    RIN_CM_VP VREF VP {RIN_CM_VP}
    RIN_DIFF VP VM 1T
    RIN_CM_VM VREF VM {RIN_CM_VM}
    RO2_1 VB_2 VREF {Ro2_1}
    
    *E4 RO1_VOL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 45 , 3.3 , 25 , 5.0 , 24 )}
    E4 RO1_VOL 0 POLY(1) VCCP VCCN 92.65808823529412 -33.64583333333336
+3.9828431372549056

    *E_RO1_VOH RO1_VOH 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 54 , 3.3 , 30 , 5.0 ,
*+27 )}
    E_RO1_VOH RO1_VOH 0 POLY(1) VCCP VCCN 109.22426470588235
+-38.68750000000002 4.448529411764708

    *E3 VIL_STB_VAL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , {0.5/1.8} , 5.0 ,
*+{0.5/5.0} )}
    E3 VIL_STB_VAL 0 POLY(1) VCCP VCCN 0.37777777777777777
+-0.05555555555555556

    *E2 VIH_STB_VAL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , {1.3/1.8} , 5.0 ,
*+{4.5/5.0} )}
    E2 VIH_STB_VAL 0 POLY(1) VCCP VCCN 0.6222222222222219
+0.05555555555555557

    E_ICCSAT_HIGH ICC_OUT_HIGH 0 POLY(1) VCCP VCCN 0
    ESTB VSTB_ONE 0 VALUE={IF( (V(STB,Vccn)/V(Vccp,Vccn)) >=
+V(VIH_STB_val) , 1 , V(VSTB_zero) )}
    E0 VSTB_ZERO 0 VALUE={IF(  (V(STB,Vccn)/V(Vccp,Vccn)) <=
+V(VIL_STB_val) , 0 , 0.5 )}
    EREAD_VS NET0220 0 VS 0 1.0
    EREAD_VREF NET0224 0 VREF 0 1.0
    E_VDEP_SINK_2 VAL_VDEP_SINK_FILTERED 0
+VALUE={IF(V(val_vdep_sink)<=0 , 0 , V(val_vdep_sink))}
    EZOUT VB_3 NET356
+VALUE={V(VZout)*V(VZout_Iout_coeff)*V(VZout_Vcc_coeff)}
    EMEAS_VOUT_DIFF VOUT_DIFF 0 VO_DIFF_PLUS VO_DIFF_MINUS 1.0
    EZOUT_VCC_COEFF VZOUT_VCC_COEFF 0 POLY(1) VCCP VCCN 1.669117647058823
+-0.1583333333333334 0.004901960784313741
    E2_REF NET241 0 VCCN 0 1.0
    EILIM_SINK VB_3_SINK VDEP_SINK VB_3 0 1.0
    E_R1 NET311 VREF VALUE={I(VreadI_R1)*( R1_sink
++(R1_source-R1_sink)*1/(1+exp(-alpha_switch*(V(v_Io_val)-Io_val_switch) )
+)) }
    EILIM_SOURCE VB_3_SOURCE VDEP_SOURCE VB_3 0 1.0
    EVLIM_LOW_VB NET425 0 VCCN 0 1.0
    E_VREF VREF 0 NET247 0 1.0
    EVLIM_LOW_VOUT NET411 0 VALUE={V(VCCN) - V(Ro1_Vol)*I(VreadIo)}
    E_SR_VCC_MODULATION VOUT_DIFF__SR_VCC 0 VALUE={V(Vout_diff)*(
+0.700735294117647 + 0.0525*V(Vccp,Vccn) +
+0.0014705882352941194*PWR(V(Vccp,Vccn),2) )}
    EZOUT_IOUT_COEFF NET0360 0 VALUE={IF( I(VreadIo)>=0 , (
+Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau__source)) ) , (
+Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau__sink)) ) )}
    E_VDEP_SOURCE_2 VAL_VDEP_SOURCE_FILTERED 0
+VALUE={IF(V(val_vdep_source)>=0, 0, V(val_vdep_source))}
    EVLIM_HIGH_VOUT NET408 0 VALUE={V(VCCP) - V(Ro1_Voh)*I(VreadIo)}
    E_ICCSAT_LOW ICC_OUT_LOW 0 POLY(1) VCCP VCCN -5.427573529411765E-5
+4.281250000000003E-5 -5.51470588235299E-7
    E_READIO V_IO_VAL 0 VALUE={I(VreadIo)}
    E_VDEP_SOURCE_3 VDEP_SOURCE 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_source_filtered))}
    E_VDEP_SOURCE_1 VAL_VDEP_SOURCE 0 VALUE={ ( -95.20588235294117 +
+73.33333333333336*V(Vccp,Vccn) + 3.921568627450974*PWR(V(Vccp,Vccn),2) ) 
+-5000*I(VreadIo)}
    E_VDEP_SINK_3 VDEP_SINK 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_sink_filtered))}
    EVLIM_HIGH_VB NET416 0 VCCP 0 1.0
    E_VDEP_SINK_1 VAL_VDEP_SINK 0 VALUE={ ( 211.65808823529403
+-172.8125*V(Vccp,Vccn) + 12.316176470588244*PWR(V(Vccp,Vccn),2) )
+-5000*I(VreadIo)}
    E1_REF NET287 0 VCCP 0 1.0
    E_ICC ICC_VAL 0 POLY(1) VCCP VCCN 2.433823529411765E-5 
+-1.0833333333333407E-6 3.4313725490196195E-7
    EMEAS_VB_VREF VB_VREF 0 VB VREF 1.0
    CZOUT_IOUT_COEFF VZOUT_IOUT_COEFF 0 1n
    CIN_CM_VM VM VREF {CIN_CM_VM}
    COUT2 VZOUT 0 {Cout2}
    CIN_DIFF VM VP {CIN_DIFF}
    COUT NET0325 0 {Cout}
    CIN_CM_VP VP VREF {CIN_CM_VP}
    CSTB_CTRL VSTB_CTRL 0 1n
    CDIFF_PARASITIC VO_DIFF_PLUS VO_DIFF_MINUS 80p
    C_RO2_1 VB_2 VREF 100p
    CCOMP VB VB_2 {Ccomp}
    DILIM_SOURCE VB_3 VB_3_SOURCE DIODE_ILIM
    DPROT_IN_P_VCCP NET423 NET388 DIODE_VLIM
    DVLIM_HIGH_VB VB NET400 DIODE_VLIM
    DPROT_IN_M_VCCP VM NET398 DIODE_VLIM
    DVLIM_LOW_VB NET426 VB DIODE_VLIM
    D_OUTVLIM_LOW NET412 VB_3 DIODE_NOVd
    D_OUTVLIM_HIGH VB_3 NET382 DIODE_NOVd
    DPROT_IN_M_VCCN NET409 VM DIODE_VLIM
    DPROT_IN_P_VCCN NET405 NET423 DIODE_VLIM
    DILIM_SINK VB_3_SINK VB_3 DIODE_ILIM
    V_IEE IEE_VAL 0 DC {IEE}
    VPROT_IN_M_VCCP NET253 NET398 DC {V_DPROT}
    VREADI_R1 VB NET311 DC 0
    VVLIM_LOW_VB NET425 NET426 DC -770m
    V_ENHANCE_VCCN VCCN_ENHANCED VCCN DC {VCCN_enhance}
    VPROT_IN_P_VCCP NET421 NET388 DC {V_DPROT}
    VOS NET423 VP DC 0
    VVLIM_HIGH_VB NET400 NET416 DC -770m
    V_OUTVLIM_LOW NET411 NET412 DC {Vd_compensazione}
    VPROT_IN_M_VCCN NET409 NET243 DC {V_DPROT}
    VREADIO NET356 VS_STB DC 0
    VPROT_IN_P_VCCN NET405 NET406 DC {V_DPROT}
    V_OUTVLIM_HIGH NET382 NET408 DC {Vd_compensazione}
    V_ENHANCE_VCCP VCCP_ENHANCED VCCP DC {VCCP_enhance}
    M_NMOS2 VO_DIFF_MINUS VM VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    M_NMOS1 VO_DIFF_PLUS NET423 VEE_N VCCN_ENHANCED MOS_N L={L} W={W}

*** End of subcircuit definition.


*******************************************************************************
*
* MODELS/SUBCKTS and PARAMS used by TSV62x subckt:
*
.PARAM RINCM=2.0828E+11
.PARAM CINCM=6.3491E-12
.PARAM RIN_CM_VM={2*RINCM}
.PARAM RIN_CM_VP={2*RINCM}
.PARAM CIN_CM_VM={CINCM/2}
.PARAM CIN_CM_VP={CINCM/2}
.PARAM CINDIFF=3.3573E-12
.PARAM CIN_DIFF={CINDIFF - CINCM/2}
.PARAM RD=1k
.PARAM VCCP_enhance=150m
.PARAM VCCN_enhance=-1100m
.PARAM GB=92m
.PARAM Ro = 4e5
.PARAM A0_source = 5.959352977968012e+7  
.PARAM A0_sink = 1.0e+6
.PARAM alpha_switch = 1e6
.PARAM Io_val_switch = -7u
.PARAM Ccomp=10.7p 
.PARAM IEE=1.5u
.PARAM W=1.07u
.PARAM L=1u
.PARAM gm_mos=2.835519773730752e-05
.PARAM Lout  = 700u
.PARAM Rout  = 1.75k
.PARAM Cout  = 750p
.PARAM Cout2 = 3.5p
.PARAM Zout_Iout_coeff_MIN= 0.02
.PARAM Iout_dc_tau__source = 0.21m 
.PARAM Iout_dc_tau__sink   = 0.03m 
.PARAM Ro2_2=1e-3
.PARAM Ro2_1={ Ro - Ro2_2 } 
.PARAM R1_sink={A0_sink/(gm_mos*GB*Ro2_1)}
.PARAM R1_source={A0_source/(gm_mos*GB*Ro2_1)}
.PARAM V_DPROT=150m
.PARAM Vd_compensazione=-788.4u
.PARAM ICC_STB = 5n
.PARAM VIL_STB = 100m
.PARAM VIH_STB = 900m
.PARAM Iout_leak_STB = 50p
.PARAM RSTB_ctrl = 51
.PARAM Iil_STB = 10p
.PARAM Iih_STB = 10p

.MODEL MOS_N  NMOS LEVEL=1  VTO=+0.65  KP=500E-6 
.MODEL DIODE_NOVd D LEVEL=1  IS=10E-15 N=0.001
.MODEL DIODE_VLIM D LEVEL=1  IS=0.8E-15   
.MODEL DIODE_ILIM D LEVEL=1  IS=0.8E-15  
.MODEL SW_OUT  VSWITCH    VON={VIH_STB} VOFF={VIL_STB} RON=1m ROFF=1T
.MODEL SW_LEAK VSWITCH    VON={VIH_STB} VOFF={VIL_STB} RON=1T ROFF={2.5/Iout_leak_STB -2e3}
.MODEL SW_VB2_VS VSWITCH  VON={VIH_STB} VOFF={VIL_STB} RON=1T ROFF=1m
.MODEL SW_VB_VREF VSWITCH VON={VIH_STB} VOFF={VIL_STB} RON=1T ROFF=1m
*
.ENDS
*******************************************************************************
****************************************************************************
*
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation
*    time).
*
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
****************************************************************************
****
***  TSV621 (WITHOUT STAND-BY)  Spice macromodel subckt 
***  Version 2.0  (March 2010) (last update: 05-10-2010)
****                      
************ CONNECTIONS: 
****             INVERTING INPUT
****              |  NON-INVERTING INPUT
****              |   |  OUTPUT 
****              |   |   |  POSITIVE POWER SUPPLY
****              |   |   |   |  NEGATIVE POWER SUPPLY 
****              |   |   |   |   |      
****              |   |   |   |   |     
.SUBCKT TSV621   VM  VP  VS  VCCP VCCN
    LOUT VZOUT 0 {Lout}
    FIOUT 0 VZOUT VREADIO 1.0
    
    *G_IIB_VM VREF VM TABLE {V(Vccp,Vccn)} = (+1.8 1p) (+3.3 1p) (+5.0 1p)       
    G_IIB_VM VREF VM VALUE={1p}
    
    GM1 VREF VB VOUT_DIFF__SR_VCC 0 {1/RD}
    G_ICC VCCP VCCN POLY(1) VCCP VCCN 2.433823529411765E-5 
+-1.0833333333333407E-6 3.4313725490196195E-7
    G_ICCSAT_OUTHIGH VCCP VCCN VALUE={IF(I(V_OUTVLIM_HIGH)>1u ,
+V(Icc_out_high), 0)}

    *G_IIB_VP VREF VP TABLE {V(Vccp,Vccn)} = (+1.8 1p) (+3.3 1p) (+5.0 1p)
    G_IIB_VP VREF VP VALUE={1p}
    
    G_IOUT_SINKED VCCN 0 VALUE={IF(I(VreadIo)>0, 0, I(VreadIo))}
    G_I_IO VB_2 VREF VALUE={V(VB_Vref)*GB*( 10*( 1 -
+exp(-abs(V(v_Io_val))/3m )) )  }
    G_IOUT_SOURCED VCCP 0 VALUE={IF(I(VreadIo)>0, I(VreadIo),0)}
    G_ICCSAT_OUTLOW VCCP VCCN VALUE={IF(I(V_OUTVLIM_LOW)>1u ,
+V(Icc_out_low) , 0)}
    G_I_VB VB_2 VREF VB_VREF 0 {GB}
    RIN_CM_VP VREF VP {RIN_CM_VP}
    RIN_CM_VM VREF VM {RIN_CM_VM}
    RIN_DIFF VP VM 1T
    RPROT_IN_P_VCCP NET403 VCCP 100
    RO2_1 VB_2 VREF {Ro2_1}
    RPROT_IN_M_VCCP VCCP NET241 100
    RD1 VCCP_ENHANCED VO_DIFF_PLUS {RD}
    RZOUT_IOUT_COEFF VZOUT_IOUT_COEFF NET0285 50
    RD2 VCCP_ENHANCED VO_DIFF_MINUS {RD}
    ROUT NET0254 VZOUT {Rout}
    R1_REF NET271 NET235 1Meg
    R_ICCSAT_HIGH ICC_OUT_HIGH 0 1K
    R2_REF NET235 NET229 1Meg
    RPROT_IN_M_VCCN VCCN NET231 15K
    RPROT_IN_P_VCCN NET388 VCCN 15K
    R_ICCSAT_LOW ICC_OUT_LOW 0 1K
    RO2_2 VB_3 VB_2 {Ro2_2}
    EVLIM_LOW_VOUT NET393 0 VALUE={V(VCCN) - V(Ro1_Vol)*I(VreadIo)}
    
    *E4 RO1_VOL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 45 , 3.3 , 25 , 5.0 , 24 )}
    E4 RO1_VOL 0 POLY(1) VCCP VCCN 92.65808823529412 -33.64583333333336
+3.9828431372549056

    EVLIM_HIGH_VOUT NET390 0 VALUE={V(VCCP) - V(Ro1_Voh)*I(VreadIo)}

    *E_RO1_VOH RO1_VOH 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 54 , 3.3 , 30 , 5.0 ,
*+27 )}
    E_RO1_VOH RO1_VOH 0 POLY(1) VCCP VCCN 109.22426470588235
+-38.68750000000002 4.448529411764708

    E_READIO V_IO_VAL 0 VALUE={I(VreadIo)}
    EZOUT_VCC_COEFF VZOUT_VCC_COEFF 0 POLY(1) VCCP VCCN 1.669117647058823
+-0.1583333333333334 0.004901960784313741
    EILIM_SINK VB_3_SINK VDEP_SINK VB_3 0 1.0
    E_ICCSAT_HIGH ICC_OUT_HIGH 0 POLY(1) VCCP VCCN 0
    E_VDEP_SINK_3 VDEP_SINK 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_sink_filtered))}
    EMEAS_VB_VREF VB_VREF 0 VB VREF 1.0
    E2_REF NET229 0 VCCN 0 1.0
    EVLIM_LOW_VB NET407 0 VCCN 0 1.0
    E_VDEP_SOURCE_2 VAL_VDEP_SOURCE_FILTERED 0
+VALUE={IF(V(val_vdep_source)>=0, 0, V(val_vdep_source))}
    E_VDEP_SOURCE_1 VAL_VDEP_SOURCE 0 VALUE={ ( -95.20588235294117 +
+73.33333333333336*V(Vccp,Vccn) + 3.921568627450974*PWR(V(Vccp,Vccn),2) ) 
+-5000*I(VreadIo)}
    E_VDEP_SOURCE_3 VDEP_SOURCE 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_source_filtered))}
    E_VDEP_SINK_1 VAL_VDEP_SINK 0 VALUE={ ( 211.65808823529403
+-172.8125*V(Vccp,Vccn) + 12.316176470588244*PWR(V(Vccp,Vccn),2) )
+-5000*I(VreadIo)}
    EVLIM_HIGH_VB NET398 0 VCCP 0 1.0
    E1_REF NET271 0 VCCP 0 1.0
    E_R1 NET295 VREF VALUE={I(VreadI_R1)*( R1_sink
++(R1_source-R1_sink)*1/(1+exp(-alpha_switch*(V(v_Io_val)-Io_val_switch) )
+)) }
    EZOUT VB_3 NET0207
+VALUE={V(VZout)*V(VZout_Iout_coeff)*V(VZout_Vcc_coeff)}
    E_VDEP_SINK_2 VAL_VDEP_SINK_FILTERED 0
+VALUE={IF(V(val_vdep_sink)<=0 , 0 , V(val_vdep_sink))}
    EZOUT_IOUT_COEFF NET0285 0 VALUE={IF( I(VreadIo)>=0 , (
+Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau__source)) ) , (
+Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau__sink)) ) )}
    E_VREF VREF 0 NET235 0 1.0
    EMEAS_VOUT_DIFF VOUT_DIFF 0 VO_DIFF_PLUS VO_DIFF_MINUS 1.0
    EILIM_SOURCE VB_3_SOURCE VDEP_SOURCE VB_3 0 1.0
    E_ICCSAT_LOW ICC_OUT_LOW 0 POLY(1) VCCP VCCN -5.427573529411765E-5
+4.281250000000003E-5 -5.51470588235299E-7
    E_SR_VCC_MODULATION VOUT_DIFF__SR_VCC 0 VALUE={V(Vout_diff)*(
+0.700735294117647 + 0.0525*V(Vccp,Vccn) +
+0.0014705882352941194*PWR(V(Vccp,Vccn),2) )}
    COUT NET0254 0 {Cout}
    CZOUT_IOUT_COEFF VZOUT_IOUT_COEFF 0 1n
    CIN_DIFF VM VP {CIN_DIFF}
    CIN_CM_VM VM VREF {CIN_CM_VM}
    COUT2 VZOUT 0 {Cout2}
    CIN_CM_VP VP VREF {CIN_CM_VP}
    CCOMP VB VB_2 {Ccomp}
    CDIFF_PARASITIC VO_DIFF_PLUS VO_DIFF_MINUS 80p
    C_RO2_1 VB_2 VREF 100p
    DVLIM_HIGH_VB VB NET382 DIODE_VLIM
    DILIM_SINK VB_3_SINK VB_3 DIODE_ILIM
    D_OUTVLIM_HIGH VB_3 NET364 DIODE_NOVd
    DPROT_IN_P_VCCN NET387 NET405 DIODE_VLIM
    DPROT_IN_M_VCCP VM NET380 DIODE_VLIM
    DILIM_SOURCE VB_3 VB_3_SOURCE DIODE_ILIM
    DPROT_IN_P_VCCP NET405 NET370 DIODE_VLIM
    DPROT_IN_M_VCCN NET391 VM DIODE_VLIM
    DVLIM_LOW_VB NET408 VB DIODE_VLIM
    D_OUTVLIM_LOW NET394 VB_3 DIODE_NOVd
    VVLIM_HIGH_VB NET382 NET398 DC -770m
    VPROT_IN_P_VCCN NET387 NET388 DC {V_DPROT}
    VREADI_R1 VB NET295 DC 0
    VPROT_IN_P_VCCP NET403 NET370 DC {V_DPROT}
    VOS NET405 VP DC 0
    V_OUTVLIM_HIGH NET364 NET390 DC {Vd_compensazione}
    VPROT_IN_M_VCCP NET241 NET380 DC {V_DPROT}
    V_ENHANCE_VCCN VCCN_ENHANCED VCCN DC {VCCN_enhance}
    V_ENHANCE_VCCP VCCP_ENHANCED VCCP DC {VCCP_enhance}
    VREADIO NET0207 VS DC 0
    VPROT_IN_M_VCCN NET391 NET231 DC {V_DPROT}
    VVLIM_LOW_VB NET407 NET408 DC -770m
    V_OUTVLIM_LOW NET393 NET394 DC {Vd_compensazione}
    IEE_N VEE_N VCCN_ENHANCED DC {IEE}
    M_NMOS2 VO_DIFF_MINUS VM VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    M_NMOS1 VO_DIFF_PLUS NET405 VEE_N VCCN_ENHANCED MOS_N L={L} W={W}

*** End of subcircuit definition.

*******************************************************************************
*
* MODELS/SUBCKTS and PARAMS used by TSV62x subckt:
*
.PARAM RINCM=2.0828E+11
.PARAM CINCM=6.3491E-12
.PARAM RIN_CM_VM={2*RINCM}
.PARAM RIN_CM_VP={2*RINCM}
.PARAM CIN_CM_VM={CINCM/2}
.PARAM CIN_CM_VP={CINCM/2}
.PARAM CINDIFF=3.3573E-12
.PARAM CIN_DIFF={CINDIFF - CINCM/2}
.PARAM RD=1k
.PARAM VCCP_enhance=150m
.PARAM VCCN_enhance=-1100m
.PARAM GB=92m
.PARAM Ro = 4e5
.PARAM A0_source = 5.959352977968012e+7  
.PARAM A0_sink = 1.0e+6
.PARAM alpha_switch = 1e6
.PARAM Io_val_switch = -7u
.PARAM Ccomp=10.7p 
.PARAM IEE=1.5u
.PARAM W=1.07u
.PARAM L=1u
.PARAM gm_mos=2.835519773730752e-05
.PARAM Lout  = 700u
.PARAM Rout  = 1.75k
.PARAM Cout  = 750p
.PARAM Cout2 = 3.5p
.PARAM Zout_Iout_coeff_MIN= 0.02
.PARAM Iout_dc_tau__source = 0.21m 
.PARAM Iout_dc_tau__sink   = 0.03m 
.PARAM Ro2_2=1e-3
.PARAM Ro2_1={ Ro - Ro2_2 } 
.PARAM R1_sink={A0_sink/(gm_mos*GB*Ro2_1)}
.PARAM R1_source={A0_source/(gm_mos*GB*Ro2_1)}
.PARAM V_DPROT=150m
.PARAM Vd_compensazione=-788.4u

.MODEL MOS_N  NMOS LEVEL=1  VTO=+0.65  KP=500E-6 
.MODEL DIODE_NOVd D LEVEL=1  IS=10E-15 N=0.001
.MODEL DIODE_VLIM D LEVEL=1  IS=0.8E-15   
.MODEL DIODE_ILIM D LEVEL=1  IS=0.8E-15  
*
.ENDS
*******************************************************************************
****************************************************************************
*
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation
*    time).
*
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
****************************************************************************
****
***  TSV6290  (WITH STAND-BY)  Spice macromodel subckt 
***  Version 2.0  (March 2010) (last update: 05-10-2010)
****                      
************ CONNECTIONS: 
****             INVERTING INPUT
****              |  NON-INVERTING INPUT
****              |   |  OUTPUT 
****              |   |   |  POSITIVE POWER SUPPLY
****              |   |   |   |  NEGATIVE POWER SUPPLY 
****              |   |   |   |   |     STAND-BY 
****              |   |   |   |   |     |
.SUBCKT TSV6290  VM  VP  VS VCCP VCCN  STB
    FIOUT 0 VZOUT VREADIO 1.0
    LOUT VZOUT 0 {Lout}
    S_SW_OUT     VS_STB VS VSTB_CTRL 0     SW_OUT
    S_SW_LEAK    VS 0 VSTB_CTRL 0          SW_LEAK
    S_SW_VB2_VS  VB_2 NET0220 VSTB_CTRL 0  SW_VB2_VS
    S_SW_VB_VREF VB NET0224 VSTB_CTRL 0    SW_VB_VREF
    G_ISTB 0 STB VALUE={ Iil_STB*(1-V(VSTB_one)) -Iih_STB*V(VSTB_one)}
    G_IEE_STB VEE_N VCCN_ENHANCED POLY(2) VSTB_CTRL 0 IEE_val 0 0 0 0 0 1
    G_ICC_STB VCCP VCCN POLY(2) VSTB_CTRL 0 Icc_val 0 0 0 0 0 1
    G_IOUT_SINKED VCCN 0 VALUE={IF(I(VreadIo)>0, 0, I(VreadIo))}
    G2_ICC_STB VCCP VCCN VALUE={ICC_STB*( 1-V(VSTB_ctrl) )}
    G_ICCSAT_OUTHIGH VCCP VCCN VALUE={IF(I(V_OUTVLIM_HIGH)>1u ,
+V(Icc_out_high)*V(VSTB_ctrl), 0)}
    
    *G_IIB_VP VREF VP TABLE {V(Vccp,Vccn)} = (+1.8 1p) (+3.3 1p) (+5.0 1p)
    G_IIB_VP VREF VP VALUE={1p}
    
    G_ICCSAT_OUTLOW VCCP VCCN VALUE={IF(I(V_OUTVLIM_LOW)>1u ,
+V(Icc_out_low)*V(VSTB_ctrl) , 0)}
    G_IOUT_SOURCED VCCP 0 VALUE={IF(I(VreadIo)>0, I(VreadIo),0)}
    GM1 VREF VB VOUT_DIFF__SR_VCC 0 {1/RD}

    *G_IIB_VM VREF VM TABLE {V(Vccp,Vccn)} = (+1.8 1p) (+3.3 1p) (+5.0 1p)
    G_IIB_VM VREF VM VALUE={1p}
    
    G_I_IO VB_2 VREF VALUE={V(VB_Vref)*GB*( 10*( 1 -
+exp(-abs(V(v_Io_val))/3m )) )  }
    G_I_VB VB_2 VREF VB_VREF 0 {GB}
    RD1 VCCP_ENHANCED VO_DIFF_PLUS {RD}
    RD2 VCCP_ENHANCED VO_DIFF_MINUS {RD}
    R1_REF NET287 NET247 1Meg
    R_ICCSAT_HIGH ICC_OUT_HIGH 0 1K
    RPROT_IN_M_VCCN VCCN NET243 15K
    R2_REF NET247 NET241 1Meg
    RPROT_IN_P_VCCN NET406 VCCN 15K
    RZOUT_IOUT_COEFF VZOUT_IOUT_COEFF NET0360 50
    RO2_2 VB_3 VB_2 {Ro2_2}
    R_ICCSAT_LOW ICC_OUT_LOW 0 1K
    RPROT_IN_M_VCCP VCCP NET253 100
    RPROT_IN_P_VCCP NET421 VCCP 100
    RSTB_CTRL VSTB_CTRL VSTB_ONE {RSTB_ctrl}
    ROUT NET0325 VZOUT {Rout}
    RIN_CM_VP VREF VP {RIN_CM_VP}
    RIN_DIFF VP VM 1T
    RIN_CM_VM VREF VM {RIN_CM_VM}
    RO2_1 VB_2 VREF {Ro2_1}
    EZOUT_IOUT_COEFF NET0360 0 VALUE={IF( I(VreadIo)>=0 , (
+Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau__source)) ) , (
+Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau__sink)) ) )}
    ESTB VSTB_ONE 0 VALUE={IF( (V(STB,Vccn)/V(Vccp,Vccn)) >=
+V(VIH_STB_val) , 1 , V(VSTB_zero) )}

    *E_RO1_VOH RO1_VOH 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 54 , 3.3 , 30 , 5.0 ,
*+27 )}
    E_RO1_VOH RO1_VOH 0 POLY(1) VCCP VCCN 109.22426470588235
+-38.68750000000002 4.448529411764708

    E_ICCSAT_HIGH ICC_OUT_HIGH 0 POLY(1) VCCP VCCN 0
    EVLIM_HIGH_VOUT NET408 0 VALUE={V(VCCP) - V(Ro1_Voh)*I(VreadIo)}
    EVLIM_LOW_VOUT NET411 0 VALUE={V(VCCN) - V(Ro1_Vol)*I(VreadIo)}

    *E4 RO1_VOL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 45 , 3.3 , 25 , 5.0 , 24 )}
    E4 RO1_VOL 0 POLY(1) VCCP VCCN 92.65808823529412 -33.64583333333336
+3.9828431372549056

    EREAD_VS NET0220 0 VS 0 1.0

    *E3 VIL_STB_VAL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , {0.5/1.8} , 5.0 ,
*+{0.5/5.0} )}
    E3 VIL_STB_VAL 0 POLY(1) VCCP VCCN 0.37777777777777777
+-0.05555555555555556

    *E2 VIH_STB_VAL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , {1.3/1.8} , 5.0 ,
*+{4.5/5.0} )}
    E2 VIH_STB_VAL 0 POLY(1) VCCP VCCN 0.6222222222222219
+0.05555555555555557


    EREAD_VREF NET0224 0 VREF 0 1.0
    E_VDEP_SINK_2 VAL_VDEP_SINK_FILTERED 0
+VALUE={IF(V(val_vdep_sink)<=0 , 0 , V(val_vdep_sink))}
    E0 VSTB_ZERO 0 VALUE={IF(  (V(STB,Vccn)/V(Vccp,Vccn)) <=
+V(VIL_STB_val) , 0 , 0.5 )}
    EZOUT VB_3 NET356
+VALUE={V(VZout)*V(VZout_Iout_coeff)*V(VZout_Vcc_coeff)}
    EMEAS_VOUT_DIFF VOUT_DIFF 0 VO_DIFF_PLUS VO_DIFF_MINUS 1.0
    E2_REF NET241 0 VCCN 0 1.0
    EILIM_SINK VB_3_SINK VDEP_SINK VB_3 0 1.0
    E_R1 NET311 VREF VALUE={I(VreadI_R1)*( R1_sink
++(R1_source-R1_sink)*1/(1+exp(-alpha_switch*(V(v_Io_val)-Io_val_switch) )
+)) }
    EILIM_SOURCE VB_3_SOURCE VDEP_SOURCE VB_3 0 1.0
    EVLIM_LOW_VB NET425 0 VCCN 0 1.0
    E_VREF VREF 0 NET247 0 1.0
    E_SR_VCC_MODULATION VOUT_DIFF__SR_VCC 0 VALUE={V(Vout_diff)*(
+0.7561397058823526 + 0.0540416666666669*V(Vccp,Vccn)
+-0.0010539215686274882*PWR(V(Vccp,Vccn),2) )}
    EZOUT_VCC_COEFF VZOUT_VCC_COEFF 0 POLY(1) VCCP VCCN 1.669117647058823
+-0.1583333333333334 0.004901960784313741
    E_VDEP_SOURCE_2 VAL_VDEP_SOURCE_FILTERED 0
+VALUE={IF(V(val_vdep_source)>=0, 0, V(val_vdep_source))}
    E_ICCSAT_LOW ICC_OUT_LOW 0 POLY(1) VCCP VCCN -5.427573529411765E-5
+4.281250000000003E-5 -5.51470588235299E-7
    E_READIO V_IO_VAL 0 VALUE={I(VreadIo)}
    E_VDEP_SOURCE_3 VDEP_SOURCE 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_source_filtered))}
    E_VDEP_SOURCE_1 VAL_VDEP_SOURCE 0 VALUE={ ( -95.20588235294117 +
+73.33333333333336*V(Vccp,Vccn) + 3.921568627450974*PWR(V(Vccp,Vccn),2) ) 
+-5000*I(VreadIo)}
    E_VDEP_SINK_3 VDEP_SINK 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_sink_filtered))}
    EVLIM_HIGH_VB NET416 0 VCCP 0 1.0
    E_VDEP_SINK_1 VAL_VDEP_SINK 0 VALUE={ ( 211.65808823529403
+-172.8125*V(Vccp,Vccn) + 12.316176470588244*PWR(V(Vccp,Vccn),2) )
+-5000*I(VreadIo)}
    E1_REF NET287 0 VCCP 0 1.0
    E_ICC ICC_VAL 0 POLY(1) VCCP VCCN 2.433823529411765E-5 
+-1.0833333333333407E-6 3.4313725490196195E-7
    EMEAS_VB_VREF VB_VREF 0 VB VREF 1.0
    CSTB_CTRL VSTB_CTRL 0 1n
    CZOUT_IOUT_COEFF VZOUT_IOUT_COEFF 0 1n
    CIN_CM_VM VM VREF {CIN_CM_VM}
    COUT2 VZOUT 0 {Cout2}
    CIN_DIFF VM VP {CIN_DIFF}
    COUT NET0325 0 {Cout}
    CIN_CM_VP VP VREF {CIN_CM_VP}
    CDIFF_PARASITIC VO_DIFF_PLUS VO_DIFF_MINUS 112p
    C_RO2_1 VB_2 VREF 300p
    CCOMP VB VB_2 {Ccomp}
    DILIM_SOURCE VB_3 VB_3_SOURCE DIODE_ILIM
    DPROT_IN_P_VCCP NET423 NET388 DIODE_VLIM
    DVLIM_HIGH_VB VB NET400 DIODE_VLIM
    DPROT_IN_M_VCCP VM NET398 DIODE_VLIM
    DVLIM_LOW_VB NET426 VB DIODE_VLIM
    D_OUTVLIM_LOW NET412 VB_3 DIODE_NOVd
    D_OUTVLIM_HIGH VB_3 NET382 DIODE_NOVd
    DPROT_IN_M_VCCN NET409 VM DIODE_VLIM
    DPROT_IN_P_VCCN NET405 NET423 DIODE_VLIM
    DILIM_SINK VB_3_SINK VB_3 DIODE_ILIM
    V_IEE IEE_VAL 0 DC {IEE}
    VPROT_IN_M_VCCP NET253 NET398 DC {V_DPROT}
    VREADI_R1 VB NET311 DC 0
    VVLIM_LOW_VB NET425 NET426 DC -770m
    V_ENHANCE_VCCN VCCN_ENHANCED VCCN DC {VCCN_enhance}
    VPROT_IN_P_VCCP NET421 NET388 DC {V_DPROT}
    VOS NET423 VP DC 0
    VVLIM_HIGH_VB NET400 NET416 DC -770m
    V_OUTVLIM_LOW NET411 NET412 DC {Vd_compensazione}
    VPROT_IN_M_VCCN NET409 NET243 DC {V_DPROT}
    VREADIO NET356 VS_STB DC 0
    VPROT_IN_P_VCCN NET405 NET406 DC {V_DPROT}
    V_OUTVLIM_HIGH NET382 NET408 DC {Vd_compensazione}
    V_ENHANCE_VCCP VCCP_ENHANCED VCCP DC {VCCP_enhance}
    M_NMOS2 VO_DIFF_MINUS VM VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    M_NMOS1 VO_DIFF_PLUS NET423 VEE_N VCCN_ENHANCED MOS_N L={L} W={W}

*** End of subcircuit definition.


*******************************************************************************
*
* MODELS/SUBCKTS and PARAMS used by TSV629x subckt:
*
.PARAM RINCM=2.0828E+11
.PARAM CINCM=6.3491E-12
.PARAM RIN_CM_VM={2*RINCM}
.PARAM RIN_CM_VP={2*RINCM}
.PARAM CIN_CM_VM={CINCM/2}
.PARAM CIN_CM_VP={CINCM/2}
.PARAM CINDIFF=3.3573E-12
.PARAM CIN_DIFF={CINDIFF - CINCM/2}
.PARAM RD=1k
.PARAM VCCP_enhance=150m
.PARAM VCCN_enhance=-1100m 
.PARAM GB=62.23m 
.PARAM Ro = 4e5
.PARAM A0_source = 5.959352977968012e+7  
.PARAM A0_sink = 1.0e+6
.PARAM alpha_switch = 1e6
.PARAM Io_val_switch = -7u
.PARAM Ccomp=2.7p 
.PARAM IEE=1.5u
.PARAM W=0.65u
.PARAM L=1u
.PARAM gm_mos=2.20959021339181e-05
.PARAM Lout  = 550u
.PARAM Rout  = 2850  
.PARAM Cout  = 120p
.PARAM Cout2 = 3p
.PARAM Zout_Iout_coeff_MIN= 0.02
.PARAM Iout_dc_tau__source = 0.07m 
.PARAM Iout_dc_tau__sink   = 0.005m 
.PARAM Ro2_2=1e-3
.PARAM Ro2_1={ Ro - Ro2_2 } 
.PARAM R1_sink={A0_sink/(gm_mos*GB*Ro2_1)}
.PARAM R1_source={A0_source/(gm_mos*GB*Ro2_1)}
.PARAM V_DPROT=150m
.PARAM Vd_compensazione=-788.4u
.PARAM ICC_STB = 5n
.PARAM Iout_leak_STB = 50p
.PARAM RSTB_ctrl = 30
.PARAM Iil_STB = 10p
.PARAM Iih_STB = 10p

.MODEL MOS_N  NMOS LEVEL=1  VTO=+0.65  KP=500E-6 
.MODEL DIODE_NOVd D LEVEL=1  IS=10E-15 N=0.001
.MODEL DIODE_VLIM D LEVEL=1  IS=0.8E-15   
.MODEL DIODE_ILIM D LEVEL=1  IS=0.8E-15  
.MODEL SW_OUT VSWITCH VON=0.9 VOFF=0.1 RON=1m ROFF=1T
.MODEL SW_LEAK VSWITCH VON=0.9 VOFF=0.1 RON=1T ROFF={2.5/Iout_leak_STB -5e3}
.MODEL SW_VB2_VS VSWITCH VON=0.9 VOFF=0.1 RON=1T ROFF=1m
.MODEL SW_VB_VREF VSWITCH VON=0.9 VOFF=0.1 RON=1T ROFF=1m
*
.ENDS
*******************************************************************************
****************************************************************************
*
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation
*    time).
*
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
****************************************************************************
****
***  TSV6291 (WITHOUT STAND-BY)  Spice macromodel subckt 
***  Version 2.0 (March 2010) (last update: 05-10-2010)
****                      
************ CONNECTIONS: 
****             INVERTING INPUT
****              |  NON-INVERTING INPUT
****              |   |  OUTPUT 
****              |   |   |  POSITIVE POWER SUPPLY
****              |   |   |   |  NEGATIVE POWER SUPPLY 
****              |   |   |   |   |      
****              |   |   |   |   |     
.SUBCKT TSV6291  VM  VP  VS  VCCP VCCN
    LOUT VZOUT 0 {Lout}
    FIOUT 0 VZOUT VREADIO 1.0

    *G_IIB_VM VREF VM TABLE {V(Vccp,Vccn)} = (+1.8 1p) (+3.3 1p) (+5.0 1p)
    G_IIB_VM VREF VM VALUE={1p}
    
    GM1 VREF VB VOUT_DIFF__SR_VCC 0 {1/RD}
    G_ICC VCCP VCCN POLY(1) VCCP VCCN 2.433823529411765E-5 
+-1.0833333333333407E-6 3.4313725490196195E-7
    G_ICCSAT_OUTHIGH VCCP VCCN VALUE={IF(I(V_OUTVLIM_HIGH)>1u ,
+V(Icc_out_high), 0)}
    
    *G_IIB_VP VREF VP TABLE {V(Vccp,Vccn)} = (+1.8 1p) (+3.3 1p) (+5.0 1p)
    G_IIB_VP VREF VP VALUE={1p}
    
    G_IOUT_SINKED VCCN 0 VALUE={IF(I(VreadIo)>0, 0, I(VreadIo))}
    G_I_IO VB_2 VREF VALUE={V(VB_Vref)*GB*( 10*( 1 -
+exp(-abs(V(v_Io_val))/3m )) )  }
    G_IOUT_SOURCED VCCP 0 VALUE={IF(I(VreadIo)>0, I(VreadIo),0)}
    G_ICCSAT_OUTLOW VCCP VCCN VALUE={IF(I(V_OUTVLIM_LOW)>1u ,
+V(Icc_out_low) , 0)}
    G_I_VB VB_2 VREF VB_VREF 0 {GB}
    RIN_CM_VP VREF VP {RIN_CM_VP}
    RIN_CM_VM VREF VM {RIN_CM_VM}
    RIN_DIFF VP VM 1T
    RPROT_IN_P_VCCP NET403 VCCP 100
    RO2_1 VB_2 VREF {Ro2_1}
    RPROT_IN_M_VCCP VCCP NET241 100
    RD1 VCCP_ENHANCED VO_DIFF_PLUS {RD}
    RZOUT_IOUT_COEFF VZOUT_IOUT_COEFF NET0285 50
    RD2 VCCP_ENHANCED VO_DIFF_MINUS {RD}
    ROUT NET0254 VZOUT {Rout}
    R1_REF NET271 NET235 1Meg
    R_ICCSAT_HIGH ICC_OUT_HIGH 0 1K
    R2_REF NET235 NET229 1Meg
    RPROT_IN_M_VCCN VCCN NET231 15K
    RPROT_IN_P_VCCN NET388 VCCN 15K
    R_ICCSAT_LOW ICC_OUT_LOW 0 1K
    RO2_2 VB_3 VB_2 {Ro2_2}
    EVLIM_HIGH_VOUT NET390 0 VALUE={V(VCCP) - V(Ro1_Voh)*I(VreadIo)}
    EVLIM_LOW_VOUT NET393 0 VALUE={V(VCCN) - V(Ro1_Vol)*I(VreadIo)}

    *E_RO1_VOH RO1_VOH 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 54 , 3.3 , 30 , 5.0 ,
*+27 )}
    E_RO1_VOH RO1_VOH 0 POLY(1) VCCP VCCN 109.22426470588235
+-38.68750000000002 4.448529411764708

    E_READIO V_IO_VAL 0 VALUE={I(VreadIo)}
    EZOUT_VCC_COEFF VZOUT_VCC_COEFF 0 POLY(1) VCCP VCCN 1.669117647058823
+-0.1583333333333334 0.004901960784313741
    EILIM_SINK VB_3_SINK VDEP_SINK VB_3 0 1.0
    E_ICCSAT_HIGH ICC_OUT_HIGH 0 POLY(1) VCCP VCCN 0
    E_VDEP_SINK_3 VDEP_SINK 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_sink_filtered))}
    EMEAS_VB_VREF VB_VREF 0 VB VREF 1.0
    E2_REF NET229 0 VCCN 0 1.0
    EVLIM_LOW_VB NET407 0 VCCN 0 1.0
    E_VDEP_SOURCE_2 VAL_VDEP_SOURCE_FILTERED 0
+VALUE={IF(V(val_vdep_source)>=0, 0, V(val_vdep_source))}
    E_VDEP_SOURCE_1 VAL_VDEP_SOURCE 0 VALUE={ ( -95.20588235294117 +
+73.33333333333336*V(Vccp,Vccn) + 3.921568627450974*PWR(V(Vccp,Vccn),2) ) 
+-5000*I(VreadIo)}
    E_VDEP_SOURCE_3 VDEP_SOURCE 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_source_filtered))}
    E_VDEP_SINK_1 VAL_VDEP_SINK 0 VALUE={ ( 211.65808823529403
+-172.8125*V(Vccp,Vccn) + 12.316176470588244*PWR(V(Vccp,Vccn),2) )
+-5000*I(VreadIo)}
    EVLIM_HIGH_VB NET398 0 VCCP 0 1.0
    E1_REF NET271 0 VCCP 0 1.0
    E_R1 NET295 VREF VALUE={I(VreadI_R1)*( R1_sink
++(R1_source-R1_sink)*1/(1+exp(-alpha_switch*(V(v_Io_val)-Io_val_switch) )
+)) }
    EZOUT VB_3 NET0207
+VALUE={V(VZout)*V(VZout_Iout_coeff)*V(VZout_Vcc_coeff)}

    *E4 RO1_VOL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 45 , 3.3 , 25 , 5.0 , 24 )}
    E4 RO1_VOL 0 POLY(1) VCCP VCCN 92.65808823529412 -33.64583333333336
+3.9828431372549056

    E_VDEP_SINK_2 VAL_VDEP_SINK_FILTERED 0
+VALUE={IF(V(val_vdep_sink)<=0 , 0 , V(val_vdep_sink))}
    EZOUT_IOUT_COEFF NET0285 0 VALUE={IF( I(VreadIo)>=0 , (
+Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau__source)) ) , (
+Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau__sink)) ) )}
    E_VREF VREF 0 NET235 0 1.0
    EMEAS_VOUT_DIFF VOUT_DIFF 0 VO_DIFF_PLUS VO_DIFF_MINUS 1.0
    EILIM_SOURCE VB_3_SOURCE VDEP_SOURCE VB_3 0 1.0
    E_ICCSAT_LOW ICC_OUT_LOW 0 POLY(1) VCCP VCCN -5.427573529411765E-5
+4.281250000000003E-5 -5.51470588235299E-7
    E_SR_VCC_MODULATION VOUT_DIFF__SR_VCC 0 VALUE={V(Vout_diff)*(
+0.7561397058823526 + 0.0540416666666669*V(Vccp,Vccn)
+-0.0010539215686274882*PWR(V(Vccp,Vccn),2) )}
    COUT NET0254 0 {Cout}
    CZOUT_IOUT_COEFF VZOUT_IOUT_COEFF 0 1n
    CIN_DIFF VM VP {CIN_DIFF}
    CIN_CM_VM VM VREF {CIN_CM_VM}
    COUT2 VZOUT 0 {Cout2}
    CIN_CM_VP VP VREF {CIN_CM_VP}
    CCOMP VB VB_2 {Ccomp}
    CDIFF_PARASITIC VO_DIFF_PLUS VO_DIFF_MINUS 112p
    C_RO2_1 VB_2 VREF 300p
    DVLIM_HIGH_VB VB NET382 DIODE_VLIM
    DILIM_SINK VB_3_SINK VB_3 DIODE_ILIM
    D_OUTVLIM_HIGH VB_3 NET364 DIODE_NOVd
    DPROT_IN_P_VCCN NET387 NET405 DIODE_VLIM
    DPROT_IN_M_VCCP VM NET380 DIODE_VLIM
    DILIM_SOURCE VB_3 VB_3_SOURCE DIODE_ILIM
    DPROT_IN_P_VCCP NET405 NET370 DIODE_VLIM
    DPROT_IN_M_VCCN NET391 VM DIODE_VLIM
    DVLIM_LOW_VB NET408 VB DIODE_VLIM
    D_OUTVLIM_LOW NET394 VB_3 DIODE_NOVd
    VVLIM_HIGH_VB NET382 NET398 DC -770m
    VPROT_IN_P_VCCN NET387 NET388 DC {V_DPROT}
    VREADI_R1 VB NET295 DC 0
    VPROT_IN_P_VCCP NET403 NET370 DC {V_DPROT}
    VOS NET405 VP DC 0
    V_OUTVLIM_HIGH NET364 NET390 DC {Vd_compensazione}
    VPROT_IN_M_VCCP NET241 NET380 DC {V_DPROT}
    V_ENHANCE_VCCN VCCN_ENHANCED VCCN DC {VCCN_enhance}
    V_ENHANCE_VCCP VCCP_ENHANCED VCCP DC {VCCP_enhance}
    VREADIO NET0207 VS DC 0
    VPROT_IN_M_VCCN NET391 NET231 DC {V_DPROT}
    VVLIM_LOW_VB NET407 NET408 DC -770m
    V_OUTVLIM_LOW NET393 NET394 DC {Vd_compensazione}
    IEE_N VEE_N VCCN_ENHANCED DC {IEE}
    M_NMOS2 VO_DIFF_MINUS VM VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    M_NMOS1 VO_DIFF_PLUS NET405 VEE_N VCCN_ENHANCED MOS_N L={L} W={W}

*** End of subcircuit definition.

*******************************************************************************
*
* MODELS/SUBCKTS and PARAMS used by TSV629x subckt:
*
.PARAM RINCM=2.0828E+11
.PARAM CINCM=6.3491E-12
.PARAM RIN_CM_VM={2*RINCM}
.PARAM RIN_CM_VP={2*RINCM}
.PARAM CIN_CM_VM={CINCM/2}
.PARAM CIN_CM_VP={CINCM/2}
.PARAM CINDIFF=3.3573E-12
.PARAM CIN_DIFF={CINDIFF - CINCM/2}
.PARAM RD=1k
.PARAM VCCP_enhance=150m
.PARAM VCCN_enhance=-1100m 
.PARAM GB=62.23m 
.PARAM Ro = 4e5
.PARAM A0_source = 5.959352977968012e+7  
.PARAM A0_sink = 1.0e+6
.PARAM alpha_switch = 1e6
.PARAM Io_val_switch = -7u
.PARAM Ccomp=2.7p 
.PARAM IEE=1.5u
.PARAM W=0.65u
.PARAM L=1u
.PARAM gm_mos=2.20959021339181e-05
.PARAM Lout  = 550u
.PARAM Rout  = 2850  
.PARAM Cout  = 120p
.PARAM Cout2 = 3p
.PARAM Zout_Iout_coeff_MIN= 0.02
.PARAM Iout_dc_tau__source = 0.07m 
.PARAM Iout_dc_tau__sink   = 0.005m 
.PARAM Ro2_2=1e-3
.PARAM Ro2_1={ Ro - Ro2_2 } 
.PARAM R1_sink={A0_sink/(gm_mos*GB*Ro2_1)}
.PARAM R1_source={A0_source/(gm_mos*GB*Ro2_1)}
.PARAM V_DPROT=150m
.PARAM Vd_compensazione=-788.4u

.MODEL MOS_N  NMOS LEVEL=1  VTO=+0.65  KP=500E-6 
.MODEL DIODE_NOVd D LEVEL=1  IS=10E-15 N=0.001
.MODEL DIODE_VLIM D LEVEL=1  IS=0.8E-15   
.MODEL DIODE_ILIM D LEVEL=1  IS=0.8E-15  
*
.ENDS
*******************************************************************************
****************************************************************************
*
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation
*    time).
*
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
****************************************************************************
****
***  TSV630  (WITH STAND-BY)  Spice macromodel subckt 
***  Version 2.0  (February 2010) (last update: 05-10-2010)
****                      
************ CONNECTIONS: 
****             INVERTING INPUT
****              |  NON-INVERTING INPUT
****              |   |  OUTPUT 
****              |   |   |  POSITIVE POWER SUPPLY
****              |   |   |   |  NEGATIVE POWER SUPPLY 
****              |   |   |   |   |     STAND-BY 
****              |   |   |   |   |     |
.SUBCKT TSV630   VM  VP  VS  VCCP VCCN  STB
    FIOUT 0 VZOUT VREADIO 1.0
    LOUT VZOUT 0 {Lout}
    S_SW_OUT     VS_STB VS VSTB_CTRL 0     SW_OUT
    S_SW_LEAK    VS 0 VSTB_CTRL 0          SW_LEAK
    S_SW_VB2_VS  VB_2 NET0220 VSTB_CTRL 0  SW_VB2_VS
    S_SW_VB_VREF VB NET0224 VSTB_CTRL 0    SW_VB_VREF
    G_IEE_STB VEE_N VCCN_ENHANCED POLY(2) VSTB_CTRL 0 IEE_val 0 0 0 0 0 1
    G_ICC_STB VCCP VCCN POLY(2) VSTB_CTRL 0 Icc_val 0 0 0 0 0 1
    G_IOUT_SINKED VCCN 0 VALUE={IF(I(VreadIo)>0, 0, I(VreadIo))}
    G2_ICC_STB VCCP VCCN VALUE={ICC_STB*( 1-V(VSTB_ctrl) )}
    G_ICCSAT_OUTHIGH VCCP VCCN VALUE={IF(I(V_OUTVLIM_HIGH)>1u ,
+V(Icc_out_high)*V(VSTB_ctrl), 0)}
    
    *G_IIB_VP VREF VP TABLE {V(Vccp,Vccn)} = (+1.8 1p) (+3.3 1p) (+5.0 1p)
    G_IIB_VP VREF VP VALUE={1p}
        
    G_ICCSAT_OUTLOW VCCP VCCN VALUE={IF(I(V_OUTVLIM_LOW)>1u ,
+V(Icc_out_low)*V(VSTB_ctrl) , 0)}
    G_I_IO VB_2 VREF VALUE={V(VB_Vref)*GB*( 10*( 1 -
+exp(-abs(V(v_Io_val))/3m )) )  }
    G_ISTB 0 STB VALUE={ Iil_STB*(1-V(VSTB_one)) -Iih_STB*V(VSTB_one)}
    G_IOUT_SOURCED VCCP 0 VALUE={IF(I(VreadIo)>0, I(VreadIo),0)}
    GM1 VREF VB VOUT_DIFF__SR_VCC 0 {1/RD}
    G_I_VB VB_2 VREF VB_VREF 0 {GB}
    
    *G_IIB_VM VREF VM TABLE {V(Vccp,Vccn)} = (+1.8 1p) (+3.3 1p) (+5.0 1p)
    G_IIB_VM VREF VM VALUE={1p}
    
    RIN_DIFF VP VM 1T
    RD1 VCCP_ENHANCED VO_DIFF_PLUS {RD}
    RD2 VCCP_ENHANCED VO_DIFF_MINUS {RD}
    R1_REF NET287 NET247 1Meg
    R_ICCSAT_HIGH ICC_OUT_HIGH 0 1K
    RPROT_IN_M_VCCN VCCN NET243 15K
    R2_REF NET247 NET241 1Meg
    ROUT NET0584 VZOUT {Rout}
    RPROT_IN_P_VCCN NET406 VCCN 15K
    RSTB_CTRL VSTB_CTRL VSTB_ONE {RSTB_ctrl}
    RIN_CM_VP VREF VP {RIN_CM_VP}
    RIN_CM_VM VREF VM {RIN_CM_VM}
    RO2_2 VB_3 VB_2 {Ro2_2}
    R_ICCSAT_LOW ICC_OUT_LOW 0 1K
    RPROT_IN_M_VCCP VCCP NET253 100
    RPROT_IN_P_VCCP NET421 VCCP 100
    RZOUT_IOUT_COEFF VZOUT_IOUT_COEFF NET0363 50
    RO2_1 VB_2 VREF {Ro2_1}
    EZOUT VB_3 NET0242
+VALUE={V(VZout)*V(VZout_Iout_coeff)*V(VZout_Vcc_coeff)}
    
    *E3 VIL_STB_VAL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , {0.5/1.8} , 5.0 ,
*+{0.5/5.0} )}
    E3 VIL_STB_VAL 0 POLY(1) VCCP VCCN 0.37777777777777777
+-0.05555555555555556

    EVLIM_HIGH_VOUT NET408 0 VALUE={V(VCCP) - V(Ro1_Voh)*I(VreadIo)}
    EREAD_VS NET0220 0 VS 0 1.0
    
    *E_RO1_VOL RO1_VOL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 45 , 3.3 , 28 , 5.0 ,
*+23 )}
    E_RO1_VOL RO1_VOL 0 POLY(1) VCCP VCCN 80.97794117647057
+-24.708333333333343 2.6225490196078454

    ESTB VSTB_ONE 0 VALUE={IF( (V(STB,Vccn)/V(Vccp,Vccn)) >=
+V(VIH_STB_val) , 1 , V(VSTB_zero) )}
    EREAD_VREF NET0224 0 VREF 0 1.0
    
    *E2 VIH_STB_VAL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , {1.3/1.8} , 5.0 ,
*+{4.5/5.0} )}
    E2 VIH_STB_VAL 0 POLY(1) VCCP VCCN 0.6222222222222219
+0.05555555555555557

    EZOUT_VCC_COEFF VZOUT_VCC_COEFF 0 POLY(1) VCCP VCCN 1.6599264705882346
+-0.0645833333333332 -0.01348039215686276
    E0 VSTB_ZERO 0 VALUE={IF(  (V(STB,Vccn)/V(Vccp,Vccn)) <=
+V(VIL_STB_val) , 0 , 0.5 )}
    E_VDEP_SINK_2 VAL_VDEP_SINK_FILTERED 0
+VALUE={IF(V(val_vdep_sink)<=0 , 0 , V(val_vdep_sink))}
    EMEAS_VOUT_DIFF VOUT_DIFF 0 VO_DIFF_PLUS VO_DIFF_MINUS 1.0
    E2_REF NET241 0 VCCN 0 1.0
    EILIM_SINK VB_3_SINK VDEP_SINK VB_3 0 1.0
    E_R1 NET311 VREF VALUE={I(VreadI_R1)*( R1_sink
++(R1_source-R1_sink)*1/(1+exp(-alpha_switch*(V(v_Io_val)-Io_val_switch) )
+)) }
    EZOUT_IOUT_COEFF NET0363 0 VALUE={IF( I(VreadIo)>=0 , (
+Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau__source)) ) , (
+Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau__sink)) ) )}
    EILIM_SOURCE VB_3_SOURCE VDEP_SOURCE VB_3 0 1.0
    EVLIM_LOW_VB NET425 0 VCCN 0 1.0
    E_VREF VREF 0 NET247 0 1.0
    EVLIM_LOW_VOUT NET411 0 VALUE={V(VCCN) - V(Ro1_Vol)*I(VreadIo)}
    E_SR_VCC_MODULATION VOUT_DIFF__SR_VCC 0 VALUE={V(Vout_diff)*(
+0.7286764705882351 + 0.1008333333333332*V(Vccp,Vccn)
+-0.00931372549019606*PWR(V(Vccp,Vccn),2) )}
    E_VDEP_SOURCE_2 VAL_VDEP_SOURCE_FILTERED 0
+VALUE={IF(V(val_vdep_source)>=0, 0, V(val_vdep_source))}
    E_ICCSAT_HIGH ICC_OUT_HIGH 0 POLY(1) VCCP VCCN 0
    E_READIO V_IO_VAL 0 VALUE={I(VreadIo)}
    E_VDEP_SOURCE_3 VDEP_SOURCE 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_source_filtered))}
    E_VDEP_SOURCE_1 VAL_VDEP_SOURCE 0 VALUE={ ( -95.20588235294117 +
+73.33333333333336*V(Vccp,Vccn) + 3.921568627450974*PWR(V(Vccp,Vccn),2) ) 
+-5000*I(VreadIo)}
    E_VDEP_SINK_3 VDEP_SINK 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_sink_filtered))}
    E_ICCSAT_LOW ICC_OUT_LOW 0 POLY(1) VCCP VCCN -6.574632352941173E-5
+4.014583333333334E-5 -1.5931372549019734E-7
    EVLIM_HIGH_VB NET416 0 VCCP 0 1.0
    E_VDEP_SINK_1 VAL_VDEP_SINK 0 VALUE={ ( 211.65808823529403
+-172.8125*V(Vccp,Vccn) + 12.316176470588244*PWR(V(Vccp,Vccn),2) )
+-5000*I(VreadIo)}
    
    *E_RO1_VOH RO1_VOH 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 54 , 3.3 , 42 , 5.0 ,
*+27 )}
    E_RO1_VOH RO1_VOH 0 POLY(1) VCCP VCCN 66.87132352941175 -6.6875
+-0.25735294117647034

    E1_REF NET287 0 VCCP 0 1.0
    E_ICC ICC_VAL 0 POLY(1) VCCP VCCN 4.027205882352942E-5
+3.958333333333329E-6 -1.2254901960784258E-7
    EMEAS_VB_VREF VB_VREF 0 VB VREF 1.0
    CSTB_CTRL VSTB_CTRL 0 1n
    COUT NET0584 0 {Cout}
    CDIFF_PARASITIC VO_DIFF_PLUS VO_DIFF_MINUS 30p
    CIN_CM_VM VM VREF {CIN_CM_VM}
    CIN_DIFF VM VP {CIN_DIFF}
    CZOUT_IOUT_COEFF VZOUT_IOUT_COEFF 0 1n
    CIN_CM_VP VP VREF {CIN_CM_VP}
    CCOMP VB VB_2 {Ccomp}
    COUT2 VZOUT 0 {Cout2}
    C_RO2_1 VB_2 VREF 700p
    DILIM_SOURCE VB_3 VB_3_SOURCE DIODE_ILIM
    DPROT_IN_P_VCCP NET423 NET388 DIODE_VLIM
    DVLIM_HIGH_VB VB NET400 DIODE_VLIM
    DPROT_IN_M_VCCP VM NET398 DIODE_VLIM
    DVLIM_LOW_VB NET426 VB DIODE_VLIM
    D_OUTVLIM_LOW NET412 VB_3 DIODE_NOVd
    D_OUTVLIM_HIGH VB_3 NET382 DIODE_NOVd
    DPROT_IN_M_VCCN NET409 VM DIODE_VLIM
    DPROT_IN_P_VCCN NET405 NET423 DIODE_VLIM
    DILIM_SINK VB_3_SINK VB_3 DIODE_ILIM
    V_IEE IEE_VAL 0 DC {IEE}
    VPROT_IN_M_VCCP NET253 NET398 DC {V_DPROT}
    VREADI_R1 VB NET311 DC 0
    VVLIM_LOW_VB NET425 NET426 DC -770m
    V_ENHANCE_VCCN VCCN_ENHANCED VCCN DC {VCCN_enhance}
    VPROT_IN_P_VCCP NET421 NET388 DC {V_DPROT}
    VOS NET423 VP DC 0
    VVLIM_HIGH_VB NET400 NET416 DC -770m
    V_OUTVLIM_LOW NET411 NET412 DC {Vd_compensazione}
    VPROT_IN_M_VCCN NET409 NET243 DC {V_DPROT}
    VREADIO NET0242 VS_STB DC 0
    VPROT_IN_P_VCCN NET405 NET406 DC {V_DPROT}
    V_OUTVLIM_HIGH NET382 NET408 DC {Vd_compensazione}
    V_ENHANCE_VCCP VCCP_ENHANCED VCCP DC {VCCP_enhance}
    M_NMOS2 VO_DIFF_MINUS VM VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    M_NMOS1 VO_DIFF_PLUS NET423 VEE_N VCCN_ENHANCED MOS_N L={L} W={W}

*** End of subcircuit definition.


*******************************************************************************
*
* MODELS/SUBCKTS and PARAMS used by TSV63x subckt:
*
.PARAM RINCM=2.0828E+11
.PARAM CINCM=6.6478E-12
.PARAM RIN_CM_VM={2*RINCM}
.PARAM RIN_CM_VP={2*RINCM}
.PARAM CIN_CM_VM={CINCM/2}
.PARAM CIN_CM_VP={CINCM/2}
.PARAM CINDIFF=3.5657E-12
.PARAM CIN_DIFF={CINDIFF - CINCM/2}
.PARAM RD=1k 
.PARAM VCCP_enhance=150m
.PARAM VCCN_enhance=-1100m 
.PARAM GB=141m
.PARAM Ro = 223872
.PARAM A0_source = 5.959352977968012e+7  
.PARAM A0_sink = 0.6e+6
.PARAM alpha_switch = 1e6
.PARAM Io_val_switch = -7u
.PARAM Ccomp=8.8p 
.PARAM IEE=3u
.PARAM W=1.59u
.PARAM L=1u
.PARAM gm_mos=4.887806568937801e-05
.PARAM Lout  = 230u
.PARAM Rout  = 900
.PARAM Cout  = 2n
.PARAM Cout2 = 3.7p
.PARAM Zout_Iout_coeff_MIN= 0.04
.PARAM Iout_dc_tau__source = 0.9m 
.PARAM Iout_dc_tau__sink   = 0.03m 
.PARAM Ro2_2=1e-3 
.PARAM Ro2_1={ Ro - Ro2_2} 
.PARAM R1_sink={A0_sink/(gm_mos*GB*Ro2_1)}
.PARAM R1_source={A0_source/(gm_mos*GB*Ro2_1)}
.PARAM V_DPROT=150m
.PARAM Vd_compensazione=-788.4u
.PARAM ICC_STB = 5n
.PARAM Iout_leak_STB = 50p
.PARAM RSTB_ctrl = 51
.PARAM Iil_STB = 10p
.PARAM Iih_STB = 10p

.MODEL MOS_N  NMOS LEVEL=1 VTO=+0.65  KP=500E-6 
.MODEL DIODE_NOVd D LEVEL=1 IS=10E-15 N=0.001
.MODEL DIODE_VLIM D LEVEL=1 IS=0.8E-15   
.MODEL DIODE_ILIM D LEVEL=1 IS=0.8E-15  
.MODEL SW_OUT VSWITCH VON=0.9 VOFF=0.1 RON=1m ROFF=1T
.MODEL SW_LEAK VSWITCH VON=0.9 VOFF=0.1 RON=1T ROFF={2.5/Iout_leak_STB -2e3}
.MODEL SW_VB2_VS VSWITCH VON=0.9 VOFF=0.1 RON=1T ROFF=1m
.MODEL SW_VB_VREF VSWITCH VON=0.9 VOFF=0.1 RON=1T ROFF=1m
*
.ENDS
*******************************************************************************
****************************************************************************
*
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation
*    time).
*
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
****************************************************************************
****
***  TSV631 (WITHOUT STAND-BY)  Spice macromodel subckt 
***  Version 2.0 (February 2010) (last update: 05-10-2010)
****                      
************ CONNECTIONS: 
****             INVERTING INPUT
****              |  NON-INVERTING INPUT
****              |   |  OUTPUT 
****              |   |   |  POSITIVE POWER SUPPLY
****              |   |   |   |  NEGATIVE POWER SUPPLY 
****              |   |   |   |   |      
****              |   |   |   |   |     
.SUBCKT TSV631   VM  VP  VS  VCCP VCCN
    LOUT VZOUT 0 {Lout}
    FIOUT 0 VZOUT VREADIO 1.0
    M_NMOS2 VO_DIFF_MINUS VM VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    M_NMOS1 VO_DIFF_PLUS NET194 VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    IEE_N VEE_N VCCN_ENHANCED DC {IEE}
    VREADI_R1 VB NET0258 DC 0
    VVLIM_LOW_VB NET192 NET193 DC -770m
    VOS NET194 VP DC 0
    VPROT_IN_P_VCCP NET196 NET229 DC {V_DPROT}
    V_ENHANCE_VCCN VCCN_ENHANCED VCCN DC {VCCN_enhance}
    VREADIO NET0329 VS DC 0
    VVLIM_HIGH_VB NET217 NET203 DC -770m
    V_ENHANCE_VCCP VCCP_ENHANCED VCCP DC {VCCP_enhance}
    V_OUTVLIM_LOW NET206 NET207 DC {Vd_compensazione}
    VPROT_IN_M_VCCN NET208 NET360 DC {V_DPROT}
    V_OUTVLIM_HIGH NET235 NET211 DC {Vd_compensazione}
    VPROT_IN_P_VCCN NET212 NET213 DC {V_DPROT}
    VPROT_IN_M_VCCP NET348 NET219 DC {V_DPROT}
    DVLIM_HIGH_VB VB NET217 DIODE_VLIM
    DPROT_IN_M_VCCP VM NET219 DIODE_VLIM
    DVLIM_LOW_VB NET193 VB DIODE_VLIM
    DPROT_IN_M_VCCN NET208 VM DIODE_VLIM
    DILIM_SINK VB_3_SINK VB_3 DIODE_ILIM
    D_OUTVLIM_LOW NET207 VB_3 DIODE_NOVd
    DPROT_IN_P_VCCP NET194 NET229 DIODE_VLIM
    DILIM_SOURCE VB_3 VB_3_SOURCE DIODE_ILIM
    DPROT_IN_P_VCCN NET212 NET194 DIODE_VLIM
    D_OUTVLIM_HIGH VB_3 NET235 DIODE_NOVd
    CZOUT_IOUT_COEFF VZOUT_IOUT_COEFF 0 1n
    COUT2 VZOUT 0 {Cout2}
    CIN_CM_VM VM VREF {CIN_CM_VM}
    CIN_CM_VP VP VREF {CIN_CM_VP}
    CIN_DIFF VM VP {CIN_DIFF}
    C_RO2_1 VB_2 VREF 700.0p
    COUT NET0410 0 {Cout}
    CDIFF_PARASITIC VO_DIFF_PLUS VO_DIFF_MINUS 30p
    CCOMP VB VB_2 {Ccomp}
    EZOUT_VCC_COEFF VZOUT_VCC_COEFF 0 POLY(1) VCCP VCCN 1.6599264705882346
+-0.0645833333333332 -0.01348039215686276
    EZOUT_IOUT_COEFF NET0295 0 VALUE={IF( I(VreadIo)>=0 , (
+Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau__source)) ) , (
+Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau__sink)) ) )}
    EZOUT VB_3 NET0329
+VALUE={V(VZout)*V(VZout_Iout_coeff)*V(VZout_Vcc_coeff)}
    E_ICCSAT_HIGH ICC_OUT_HIGH 0 POLY(1) VCCP VCCN 0

    *E_RO1_VOL RO1_VOL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 45 , 3.3 , 28 , 5.0 ,
*+23 )}
    E_RO1_VOL RO1_VOL 0 POLY(1) VCCP VCCN 80.97794117647057
+-24.708333333333343 2.6225490196078454

    E_ICCSAT_LOW ICC_OUT_LOW 0 POLY(1) VCCP VCCN -6.574632352941173E-5
+4.014583333333334E-5 -1.5931372549019734E-7
    E_READIO V_IO_VAL 0 VALUE={I(VreadIo)}
    EILIM_SINK VB_3_SINK VDEP_SINK VB_3 0 1.0
    
*    E_RO1_VOH RO1_VOH 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 54 , 3.3 , 42 , 5.0 ,
*+27 )}
    E_RO1_VOH RO1_VOH 0 POLY(1) VCCP VCCN 66.87132352941175 -6.6875
+-0.25735294117647034

    EMEAS_VB_VREF VB_VREF 0 VB VREF 1.0
    EMEAS_VOUT_DIFF VOUT_DIFF 0 VO_DIFF_PLUS VO_DIFF_MINUS 1.0
    E_VDEP_SOURCE_2 VAL_VDEP_SOURCE_FILTERED 0
+VALUE={IF(V(val_vdep_source)>=0, 0, V(val_vdep_source))}
    E_VDEP_SOURCE_1 VAL_VDEP_SOURCE 0 VALUE={ ( -95.20588235294117 +
+73.33333333333336*V(Vccp,Vccn) + 3.921568627450974*PWR(V(Vccp,Vccn),2) ) 
+-5000*I(VreadIo)}
    EVLIM_HIGH_VOUT NET211 0 VALUE={V(VCCP) - V(Ro1_Voh)*I(VreadIo)}
    EVLIM_LOW_VOUT NET206 0 VALUE={V(VCCN) - V(Ro1_Vol)*I(VreadIo)}
    E_VDEP_SOURCE_3 VDEP_SOURCE 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_source_filtered))}
    EVLIM_HIGH_VB NET203 0 VCCP 0 1.0
    E_VDEP_SINK_1 VAL_VDEP_SINK 0 VALUE={ ( 211.65808823529403
+-172.8125*V(Vccp,Vccn) + 12.316176470588244*PWR(V(Vccp,Vccn),2) )
+-5000*I(VreadIo)}
    E_VDEP_SINK_2 VAL_VDEP_SINK_FILTERED 0
+VALUE={IF(V(val_vdep_sink)<=0 , 0 , V(val_vdep_sink))}
    E_R1 NET0258 VREF VALUE={I(VreadI_R1)*( R1_sink
++(R1_source-R1_sink)*1/(1+exp(-alpha_switch*(V(v_Io_val)-Io_val_switch) )
+)) }
    EVLIM_LOW_VB NET192 0 VCCN 0 1.0
    E2_REF NET362 0 VCCN 0 1.0
    E_VREF VREF 0 NET356 0 1.0
    E_VDEP_SINK_3 VDEP_SINK 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_sink_filtered))}
    E1_REF NET326 0 VCCP 0 1.0
    EILIM_SOURCE VB_3_SOURCE VDEP_SOURCE VB_3 0 1.0
    E_SR_VCC_MODULATION VOUT_DIFF__SR_VCC 0 VALUE={V(Vout_diff)*(
+0.7286764705882351 + 0.1008333333333332*V(Vccp,Vccn)
+-0.00931372549019606*PWR(V(Vccp,Vccn),2) )}
    RZOUT_IOUT_COEFF VZOUT_IOUT_COEFF NET0295 50
    RIN_CM_VP VREF VP {RIN_CM_VP}
    RIN_DIFF VP VM 1T
    ROUT NET0410 VZOUT {Rout}
    R_ICCSAT_LOW ICC_OUT_LOW 0 1K
    RO2_2 VB_3 VB_2 {Ro2_2}
    RPROT_IN_P_VCCP NET196 VCCP 100
    RPROT_IN_M_VCCP VCCP NET348 100
    RO2_1 VB_2 VREF {Ro2_1}
    RD1 VCCP_ENHANCED VO_DIFF_PLUS {RD}
    RD2 VCCP_ENHANCED VO_DIFF_MINUS {RD}
    RIN_CM_VM VREF VM {RIN_CM_VM}
    R1_REF NET326 NET356 1Meg
    R_ICCSAT_HIGH ICC_OUT_HIGH 0 1K
    RPROT_IN_M_VCCN VCCN NET360 15K
    R2_REF NET356 NET362 1Meg
    RPROT_IN_P_VCCN NET213 VCCN 15K
    G_ICCSAT_OUTLOW VCCP VCCN VALUE={IF(I(V_OUTVLIM_LOW)>1u ,
+V(Icc_out_low) , 0)}
    G_I_VB VB_2 VREF VB_VREF 0 {GB}
    G_I_IO VB_2 VREF VALUE={V(VB_Vref)*GB*( 10*( 1 -
+exp(-abs(V(v_Io_val))/3m )) )  }
    G_IOUT_SOURCED VCCP 0 VALUE={IF(I(VreadIo)>0, I(VreadIo),0)}
    GM1 VREF VB VOUT_DIFF__SR_VCC 0 {1/RD}
    
    *G_IIB_VM VREF VM TABLE {V(Vccp,Vccn)} = (+1.8 1p) (+3.3 1p) (+5.0 1p)
    G_IIB_VM VREF VM VALUE={1p}
    
    G_ICC VCCP VCCN POLY(1) VCCP VCCN 4.027205882352942E-5
+3.958333333333329E-6 -1.2254901960784258E-7
    G_ICCSAT_OUTHIGH VCCP VCCN VALUE={IF(I(V_OUTVLIM_HIGH)>1u ,
+V(Icc_out_high), 0)}
    
    *G_IIB_VP VREF VP TABLE {V(Vccp,Vccn)} = (+1.8 1p) (+3.3 1p) (+5.0 1p)
    G_IIB_VP VREF VP VALUE={1p}
    
    G_IOUT_SINKED VCCN 0 VALUE={IF(I(VreadIo)>0, 0, I(VreadIo))}

*** End of subcircuit definition.

*******************************************************************************
*
* MODELS/SUBCKTS and PARAMS used by TSV63x subckt:
*
.PARAM RINCM=2.0828E+11
.PARAM CINCM=6.6478E-12
.PARAM RIN_CM_VM={2*RINCM}
.PARAM RIN_CM_VP={2*RINCM}
.PARAM CIN_CM_VM={CINCM/2}
.PARAM CIN_CM_VP={CINCM/2}
.PARAM CINDIFF=3.5657E-12
.PARAM CIN_DIFF={CINDIFF - CINCM/2}
.PARAM RD=1k 
.PARAM VCCP_enhance=150m
.PARAM VCCN_enhance=-1100m 
.PARAM GB=141m
.PARAM Ro = 223872
.PARAM A0_source = 5.959352977968012e+7  
.PARAM A0_sink = 0.6e+6
.PARAM alpha_switch = 1e6
.PARAM Io_val_switch = -7u
.PARAM Ccomp=8.8p 
.PARAM IEE=3u
.PARAM W=1.59u
.PARAM L=1u
.PARAM gm_mos=4.887806568937801e-05
.PARAM Lout  = 230u
.PARAM Rout  = 900
.PARAM Cout  = 2n
.PARAM Cout2 = 3.7p
.PARAM Zout_Iout_coeff_MIN= 0.04
.PARAM Iout_dc_tau__source = 0.9m 
.PARAM Iout_dc_tau__sink   = 0.03m 
.PARAM Ro2_2=1e-3 
.PARAM Ro2_1={ Ro - Ro2_2} 
.PARAM R1_sink={A0_sink/(gm_mos*GB*Ro2_1)}
.PARAM R1_source={A0_source/(gm_mos*GB*Ro2_1)}
.PARAM V_DPROT=150m
.PARAM Vd_compensazione=-788.4u

.MODEL MOS_N  NMOS LEVEL=1 VTO=+0.65  KP=500E-6 
.MODEL DIODE_NOVd D LEVEL=1 IS=10E-15 N=0.001
.MODEL DIODE_VLIM D LEVEL=1 IS=0.8E-15   
.MODEL DIODE_ILIM D LEVEL=1 IS=0.8E-15  
*
.ENDS
*******************************************************************************
****************************************************************************
*
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation
*    time).
*
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
****************************************************************************
****
***  TSV6390  (WITH STAND-BY)  PSpice macromodel subckt 
***  Version 2.0  (February 2010) (last update: 05-10-2010)
****                      
************ CONNECTIONS: 
****             INVERTING INPUT
****              |  NON-INVERTING INPUT
****              |   |  OUTPUT 
****              |   |   |  POSITIVE POWER SUPPLY
****              |   |   |   |  NEGATIVE POWER SUPPLY 
****              |   |   |   |   |     STAND-BY 
****              |   |   |   |   |     |
.SUBCKT TSV6390  VM  VP  VS VCCP VCCN  STB
    LOUT VZOUT 0 {Lout}
    FIOUT 0 VZOUT VREADIO 1.0    
    S_SW_VB2_VS   VB_2 NET0247 VSTB_CTRL 0   SW_VB2_VS
    S_SW_OUT      VS_STB VS VSTB_CTRL 0      SW_OUT
    S_SW_LEAK     VS 0 VSTB_CTRL 0           SW_LEAK
    S_SW_VB_VREF  VB NET0224 VSTB_CTRL 0     SW_VB_VREF
    G_IEE_STB VEE_N VCCN_ENHANCED POLY(2) VSTB_CTRL 0 IEE_val 0 0 0 0 0 1
    G_ICC_STB VCCP VCCN POLY(2) VSTB_CTRL 0 Icc_val 0 0 0 0 0 1
    G_IOUT_SINKED VCCN 0 VALUE={IF(I(VreadIo)>0, 0, I(VreadIo))}
    G2_ICC_STB VCCP VCCN VALUE={ICC_STB*( 1-V(VSTB_ctrl) )}
    G_I_VB VB_2 VREF VB_VREF 0 {GB}
    G_ICCSAT_OUTHIGH VCCP VCCN VALUE={IF(I(V_OUTVLIM_HIGH)>1u ,
+V(Icc_out_high)*V(VSTB_ctrl), 0)}
    
    *G_IIB_VP VREF VP TABLE {V(Vccp,Vccn)} = (+1.8 1p) (+3.3 1p) (+5.0 1p)
    G_IIB_VP VREF VP VALUE={1p}
    
    G_ICCSAT_OUTLOW VCCP VCCN VALUE={IF(I(V_OUTVLIM_LOW)>1u ,
+V(Icc_out_low)*V(VSTB_ctrl) , 0)}
    G_IOUT_SOURCED VCCP 0 VALUE={IF(I(VreadIo)>0, I(VreadIo),0)}
    GM1 VREF VB VOUT_DIFF__SR_VCC 0 {1/RD}

    *G_IIB_VM VREF VM TABLE {V(Vccp,Vccn)} = (+1.8 1p) (+3.3 1p) (+5.0 1p)
    G_IIB_VM VREF VM VALUE={1p}
    
    G_ISTB 0 STB VALUE={ Iil_STB*(1-V(VSTB_one)) -Iih_STB*V(VSTB_one)}
    G_I_IO VB_2 VREF VALUE={V(VB_Vref)*GB*( 10*( 1 -
+exp(-abs(V(v_Io_val))/3m )) )  }
    RD1 VCCP_ENHANCED VO_DIFF_PLUS {RD}
    RD2 VCCP_ENHANCED VO_DIFF_MINUS {RD}
    R1_REF NET287 NET247 1Meg
    R_ICCSAT_HIGH ICC_OUT_HIGH 0 1K
    RPROT_IN_M_VCCN VCCN NET243 15K
    R2_REF NET247 NET241 1Meg
    RPROT_IN_P_VCCN NET406 VCCN 15K
    RIN_CM_VM VREF VM {RIN_CM_VM}
    ROUT NET0314 VZOUT {Rout}
    RIN_DIFF VP VM 1T
    RO2_1 VB_2 VREF {Ro2_1}
    RIN_CM_VP VREF VP {RIN_CM_VP}
    RO2_2 VB_3 VB_2 {Ro2_2}
    R_ICCSAT_LOW ICC_OUT_LOW 0 1K
    RPROT_IN_M_VCCP VCCP NET253 100
    RPROT_IN_P_VCCP NET421 VCCP 100
    RSTB_CTRL VSTB_CTRL VSTB_ONE {RSTB_ctrl}
    RZOUT_IOUT_COEFF VZOUT_IOUT_COEFF NET0355 50
    EVLIM_LOW_VOUT NET411 0 VALUE={V(VCCN) - V(Ro1_Vol)*I(VreadIo)}

    *E_RO1_VOL RO1_VOL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 45 , 3.3 , 28 , 5.0 ,
*+23 )}
    E_RO1_VOL RO1_VOL 0 POLY(1) VCCP VCCN 80.97794117647057
+-24.708333333333343 2.6225490196078454

    EVLIM_HIGH_VOUT NET408 0 VALUE={V(VCCP) - V(Ro1_Voh)*I(VreadIo)}

    *E_RO1_VOH RO1_VOH 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 54 , 3.3 , 42 , 5.0 ,
*+27 )}
    E_RO1_VOH RO1_VOH 0 POLY(1) VCCP VCCN 66.87132352941175 -6.6875
+-0.25735294117647034

    EREAD_VS NET0247 0 VS 0 1.0
    E_VDEP_SINK_1 VAL_VDEP_SINK 0 VALUE={ ( 233.4963235294118
+-191.5625*V(Vccp,Vccn) + 15.992647058823547*PWR(V(Vccp,Vccn),2) )
+-5000*I(VreadIo)}
    EZOUT_VCC_COEFF VZOUT_VCC_COEFF 0 POLY(1) VCCP VCCN 1.6599264705882346
+-0.0645833333333332 -0.01348039215686276
    E0 VSTB_ZERO 0 VALUE={IF(  (V(STB,Vccn)/V(Vccp,Vccn)) <=
+V(VIL_STB_val) , 0 , 0.5 )}
    EZOUT_IOUT_COEFF NET0355 0 VALUE={IF( I(VreadIo)>=0 , (
+Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau__source)) ) , (
+Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau__sink)) ) )}
    EREAD_VREF NET0224 0 VREF 0 1.0
    
    *E2 VIH_STB_VAL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , {1.3/1.8} , 5.0 ,
*+{4.5/5.0} )}
    E2 VIH_STB_VAL 0 POLY(1) VCCP VCCN 0.6222222222222219
+0.05555555555555557

    E_VDEP_SINK_2 VAL_VDEP_SINK_FILTERED 0
+VALUE={IF(V(val_vdep_sink)<=0 , 0 , V(val_vdep_sink))}
    EMEAS_VOUT_DIFF VOUT_DIFF 0 VO_DIFF_PLUS VO_DIFF_MINUS 1.0
    E2_REF NET241 0 VCCN 0 1.0
    EILIM_SINK VB_3_SINK VDEP_SINK VB_3 0 1.0

    *E3 VIL_STB_VAL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , {0.5/1.8} , 5.0 ,
*+{0.5/5.0} )}
    E3 VIL_STB_VAL 0 POLY(1) VCCP VCCN 0.37777777777777777
+-0.05555555555555556

    E_R1 NET311 VREF VALUE={I(VreadI_R1)*( R1_sink
++(R1_source-R1_sink)*1/(1+exp(-alpha_switch*(V(v_Io_val)-Io_val_switch) )
+)) }
    EILIM_SOURCE VB_3_SOURCE VDEP_SOURCE VB_3 0 1.0
    EVLIM_LOW_VB NET425 0 VCCN 0 1.0
    E_VREF VREF 0 NET247 0 1.0
    E_SR_VCC_MODULATION VOUT_DIFF__SR_VCC 0 VALUE={V(Vout_diff)*(
+0.7685661764705877 + 0.027291666666666915*V(Vccp,Vccn) +
+0.0037990196078431008*PWR(V(Vccp,Vccn),2) )}
    ESTB VSTB_ONE 0 VALUE={IF( (V(STB,Vccn)/V(Vccp,Vccn)) >=
+V(VIH_STB_val) , 1 , V(VSTB_zero) )}
    EZOUT VB_3 NET0236
+VALUE={V(VZout)*V(VZout_Iout_coeff)*V(VZout_Vcc_coeff)}
    E_VDEP_SOURCE_2 VAL_VDEP_SOURCE_FILTERED 0
+VALUE={IF(V(val_vdep_source)>=0, 0, V(val_vdep_source))}
    E_ICCSAT_HIGH ICC_OUT_HIGH 0 POLY(1) VCCP VCCN 0
    E_READIO V_IO_VAL 0 VALUE={I(VreadIo)}
    E_VDEP_SOURCE_3 VDEP_SOURCE 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_source_filtered))}
    E_VDEP_SINK_3 VDEP_SINK 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_sink_filtered))}
    E_ICCSAT_LOW ICC_OUT_LOW 0 POLY(1) VCCP VCCN -6.574632352941173E-5
+4.014583333333334E-5 -1.5931372549019734E-7
    EVLIM_HIGH_VB NET416 0 VCCP 0 1.0
    E_VDEP_SOURCE_1 VAL_VDEP_SOURCE 0 VALUE={ ( -106.12500000000007 +
+82.70833333333343*V(Vccp,Vccn) + 2.0833333333333175*PWR(V(Vccp,Vccn),2) )
+ -5000*I(VreadIo)}
    E1_REF NET287 0 VCCP 0 1.0
    E_ICC ICC_VAL 0 POLY(1) VCCP VCCN 4.027205882352942E-5
+3.958333333333329E-6 -1.2254901960784258E-7
    EMEAS_VB_VREF VB_VREF 0 VB VREF 1.0
    CSTB_CTRL VSTB_CTRL 0 1n
    CZOUT_IOUT_COEFF VZOUT_IOUT_COEFF 0 1n
    COUT2 VZOUT 0 {Cout2}
    COUT NET0314 0 {Cout}
    C_RO2_1 VB_2 VREF 10p
    CDIFF_PARASITIC VO_DIFF_PLUS VO_DIFF_MINUS 72p
    CIN_DIFF VM VP {CIN_DIFF}
    CIN_CM_VP VP VREF {CIN_CM_VP}
    CCOMP VB VB_2 {Ccomp}
    CIN_CM_VM VM VREF {CIN_CM_VM}
    DILIM_SOURCE VB_3 VB_3_SOURCE DIODE_ILIM
    DPROT_IN_P_VCCP NET423 NET388 DIODE_VLIM
    DVLIM_HIGH_VB VB NET400 DIODE_VLIM
    DPROT_IN_M_VCCP VM NET398 DIODE_VLIM
    DVLIM_LOW_VB NET426 VB DIODE_VLIM
    D_OUTVLIM_LOW NET412 VB_3 DIODE_NOVd
    D_OUTVLIM_HIGH VB_3 NET382 DIODE_NOVd
    DPROT_IN_M_VCCN NET409 VM DIODE_VLIM
    DPROT_IN_P_VCCN NET405 NET423 DIODE_VLIM
    DILIM_SINK VB_3_SINK VB_3 DIODE_ILIM
    V_IEE IEE_VAL 0 DC {IEE}
    VREADIO NET0236 VS_STB DC 0
    VPROT_IN_M_VCCP NET253 NET398 DC {V_DPROT}
    VREADI_R1 VB NET311 DC 0
    VVLIM_LOW_VB NET425 NET426 DC -770m
    V_ENHANCE_VCCN VCCN_ENHANCED VCCN DC {VCCN_enhance}
    VPROT_IN_P_VCCP NET421 NET388 DC {V_DPROT}
    VOS NET423 VP DC 0
    VVLIM_HIGH_VB NET400 NET416 DC -770m
    V_OUTVLIM_LOW NET411 NET412 DC {Vd_compensazione}
    VPROT_IN_M_VCCN NET409 NET243 DC {V_DPROT}
    VPROT_IN_P_VCCN NET405 NET406 DC {V_DPROT}
    V_OUTVLIM_HIGH NET382 NET408 DC {Vd_compensazione}
    V_ENHANCE_VCCP VCCP_ENHANCED VCCP DC {VCCP_enhance}
    M_NMOS2 VO_DIFF_MINUS VM VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    M_NMOS1 VO_DIFF_PLUS NET423 VEE_N VCCN_ENHANCED MOS_N L={L} W={W}

*** End of subcircuit definition.



*******************************************************************************
*
* MODELS/SUBCKTS and PARAMS used by TSV639x subckt:
*
.PARAM RINCM=2.0828E+11
.PARAM CINCM=6.6478E-12
.PARAM RIN_CM_VM={2*RINCM}
.PARAM RIN_CM_VP={2*RINCM}
.PARAM CIN_CM_VM={CINCM/2}
.PARAM CIN_CM_VP={CINCM/2}
.PARAM CINDIFF=3.5657E-12
.PARAM CIN_DIFF={CINDIFF - CINCM/2}
.PARAM RD=1k
.PARAM VCCP_enhance=150m
.PARAM VCCN_enhance=-1100m 
.PARAM GB=95m 
.PARAM Ro = 223872
.PARAM A0_source = 5.959352977968012e+7  
.PARAM A0_sink = 0.6e+6
.PARAM alpha_switch = 1e6
.PARAM Io_val_switch = -7u
.PARAM Ccomp=2.65p 
.PARAM IEE=3u
.PARAM W=1.06u
.PARAM L=1u
.PARAM gm_mos=3.990140517663634e-05
.PARAM Lout  = 220u
.PARAM Rout  = 1.95k
.PARAM Cout  = 105p
.PARAM Cout2 = 3p
.PARAM Zout_Iout_coeff_MIN= 0.04
.PARAM Iout_dc_tau__source = 0.17m 
.PARAM Iout_dc_tau__sink   = 0.03m 
.PARAM Ro2_2=1e-3 
.PARAM Ro2_1={ Ro - Ro2_2 } 
.PARAM R1_sink={A0_sink/(gm_mos*GB*Ro2_1)}
.PARAM R1_source={A0_source/(gm_mos*GB*Ro2_1)}
.PARAM V_DPROT=150m
.PARAM Vd_compensazione=-788.4u
.PARAM ICC_STB = 5n
.PARAM Iout_leak_STB = 50p
.PARAM RSTB_ctrl = 33
.PARAM Iil_STB = 10p
.PARAM Iih_STB = 10p

.MODEL MOS_N  NMOS LEVEL=1 VTO=+0.65  KP=500E-6 
.MODEL DIODE_NOVd D LEVEL=1 IS=10E-15 N=0.001
.MODEL DIODE_VLIM D LEVEL=1 IS=0.8E-15   
.MODEL DIODE_ILIM D LEVEL=1 IS=0.8E-15 
.MODEL SW_VB2_VS VSWITCH VON=0.9 VOFF=0.1 RON=1T ROFF=1m
.MODEL SW_OUT VSWITCH VON=0.9 VOFF=0.1 RON=1m ROFF=1T
.MODEL SW_LEAK VSWITCH VON=0.9 VOFF=0.1 RON=1T ROFF={2.5/Iout_leak_STB -2e3}
.MODEL SW_VB_VREF VSWITCH VON=0.9 VOFF=0.1 RON=1T ROFF=1m
*
.ENDS
*******************************************************************************
****************************************************************************
*
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation
*    time).
*
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating
*    conditions (Vcc, Vicm, etc) are not reliable in any way.
*
****************************************************************************
****
***  TSV6391 (WITHOUT STAND-BY)  Spice macromodel subckt 
***  Version 2.0 (February 2010) (last update: 05-10-2010)
****                      
************ CONNECTIONS: 
****             INVERTING INPUT
****              |  NON-INVERTING INPUT
****              |   |  OUTPUT 
****              |   |   |  POSITIVE POWER SUPPLY
****              |   |   |   |  NEGATIVE POWER SUPPLY 
****              |   |   |   |   |      
****              |   |   |   |   |     
.SUBCKT TSV6391  VM  VP  VS  VCCP VCCN
    FIOUT 0 VZOUT VREADIO 1.0
    LOUT VZOUT 0 {Lout}
    M_NMOS2 VO_DIFF_MINUS VM VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    M_NMOS1 VO_DIFF_PLUS NET194 VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    IEE_N VEE_N VCCN_ENHANCED DC {IEE}
    VREADI_R1 VB NET0258 DC 0
    VVLIM_LOW_VB NET192 NET193 DC -770m
    VOS NET194 VP DC 0
    VPROT_IN_P_VCCP NET196 NET229 DC {V_DPROT}
    V_ENHANCE_VCCN VCCN_ENHANCED VCCN DC {VCCN_enhance}
    VREADIO NET0266 VS DC 0
    VVLIM_HIGH_VB NET217 NET203 DC -770m
    V_ENHANCE_VCCP VCCP_ENHANCED VCCP DC {VCCP_enhance}
    V_OUTVLIM_LOW NET206 NET207 DC {Vd_compensazione}
    VPROT_IN_M_VCCN NET208 NET360 DC {V_DPROT}
    V_OUTVLIM_HIGH NET235 NET211 DC {Vd_compensazione}
    VPROT_IN_P_VCCN NET212 NET213 DC {V_DPROT}
    VPROT_IN_M_VCCP NET348 NET219 DC {V_DPROT}
    DVLIM_HIGH_VB VB NET217 DIODE_VLIM
    DPROT_IN_M_VCCP VM NET219 DIODE_VLIM
    DVLIM_LOW_VB NET193 VB DIODE_VLIM
    DPROT_IN_M_VCCN NET208 VM DIODE_VLIM
    DILIM_SINK VB_3_SINK VB_3 DIODE_ILIM
    D_OUTVLIM_LOW NET207 VB_3 DIODE_NOVd
    DPROT_IN_P_VCCP NET194 NET229 DIODE_VLIM
    DILIM_SOURCE VB_3 VB_3_SOURCE DIODE_ILIM
    DPROT_IN_P_VCCN NET212 NET194 DIODE_VLIM
    D_OUTVLIM_HIGH VB_3 NET235 DIODE_NOVd
    COUT NET0394 0 {Cout}
    CIN_CM_VP VP VREF {CIN_CM_VP}
    C_RO2_1 VB_2 VREF 10p
    COUT2 VZOUT 0 {Cout2}
    CIN_DIFF VM VP {CIN_DIFF}
    CZOUT_IOUT_COEFF VZOUT_IOUT_COEFF 0 1n
    CIN_CM_VM VM VREF {CIN_CM_VM}
    CDIFF_PARASITIC VO_DIFF_PLUS VO_DIFF_MINUS 72p
    CCOMP VB VB_2 {Ccomp}
    EZOUT_VCC_COEFF VZOUT_VCC_COEFF 0 POLY(1) VCCP VCCN 1.6599264705882346
+-0.0645833333333332 -0.01348039215686276

    *E_RO1_VOH RO1_VOH 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 54 , 3.3 , 42 , 5.0 ,
*+27 )}
    E_RO1_VOH RO1_VOH 0 POLY(1) VCCP VCCN 66.87132352941175 -6.6875
+-0.25735294117647034

    EVLIM_HIGH_VOUT NET211 0 VALUE={V(VCCP) - V(Ro1_Voh)*I(VreadIo)}
    EZOUT_IOUT_COEFF NET0283 0 VALUE={IF( I(VreadIo)>=0 , (
+Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau__source)) ) , (
+Zout_Iout_coeff_MIN + (1.0 -
+Zout_Iout_coeff_MIN)*exp(-abs(I(VreadIo)/Iout_dc_tau__sink)) ) )}
    E_ICCSAT_HIGH ICC_OUT_HIGH 0 POLY(1) VCCP VCCN 0
    E_ICCSAT_LOW ICC_OUT_LOW 0 POLY(1) VCCP VCCN -6.574632352941173E-5
+4.014583333333334E-5 -1.5931372549019734E-7
    E_READIO V_IO_VAL 0 VALUE={I(VreadIo)}
    EILIM_SINK VB_3_SINK VDEP_SINK VB_3 0 1.0
    EMEAS_VB_VREF VB_VREF 0 VB VREF 1.0
    EMEAS_VOUT_DIFF VOUT_DIFF 0 VO_DIFF_PLUS VO_DIFF_MINUS 1.0
    E_VDEP_SOURCE_2 VAL_VDEP_SOURCE_FILTERED 0
+VALUE={IF(V(val_vdep_source)>=0, 0, V(val_vdep_source))}
    E_VDEP_SOURCE_1 VAL_VDEP_SOURCE 0 VALUE={ ( -106.12500000000007 +
+82.70833333333343*V(Vccp,Vccn) + 2.0833333333333175*PWR(V(Vccp,Vccn),2) )
+ -5000*I(VreadIo)}

    *E_RO1_VOL RO1_VOL 0 VALUE={TABLE( V(VCCP,VCCN) , 1.8 , 45 , 3.3 , 28 , 5.0 ,
*+23 )}
    E_RO1_VOL RO1_VOL 0 POLY(1) VCCP VCCN 80.97794117647057
+-24.708333333333343 2.6225490196078454

    EZOUT VB_3 NET0266
+VALUE={V(VZout)*V(VZout_Iout_coeff)*V(VZout_Vcc_coeff)}
    E_VDEP_SOURCE_3 VDEP_SOURCE 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_source_filtered))}
    EVLIM_HIGH_VB NET203 0 VCCP 0 1.0
    E_VDEP_SINK_1 VAL_VDEP_SINK 0 VALUE={ ( 233.4963235294118
+-191.5625*V(Vccp,Vccn) + 15.992647058823547*PWR(V(Vccp,Vccn),2) )
+-5000*I(VreadIo)}
    E_VDEP_SINK_2 VAL_VDEP_SINK_FILTERED 0
+VALUE={IF(V(val_vdep_sink)<=0 , 0 , V(val_vdep_sink))}
    EVLIM_LOW_VOUT NET206 0 VALUE={V(VCCN) - V(Ro1_Vol)*I(VreadIo)}
    E_R1 NET0258 VREF VALUE={I(VreadI_R1)*( R1_sink
++(R1_source-R1_sink)*1/(1+exp(-alpha_switch*(V(v_Io_val)-Io_val_switch) )
+)) }
    EVLIM_LOW_VB NET192 0 VCCN 0 1.0
    E2_REF NET362 0 VCCN 0 1.0
    E_VREF VREF 0 NET356 0 1.0
    E_VDEP_SINK_3 VDEP_SINK 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
+V(val_vdep_sink_filtered))}
    E1_REF NET326 0 VCCP 0 1.0
    EILIM_SOURCE VB_3_SOURCE VDEP_SOURCE VB_3 0 1.0
    E_SR_VCC_MODULATION VOUT_DIFF__SR_VCC 0 VALUE={V(Vout_diff)*(
+0.7685661764705877 + 0.027291666666666915*V(Vccp,Vccn) +
+0.0037990196078431008*PWR(V(Vccp,Vccn),2) )}
    RIN_DIFF VP VM 1T
    RO2_1 VB_2 VREF {Ro2_1}
    R_ICCSAT_LOW ICC_OUT_LOW 0 1K
    RIN_CM_VP VREF VP {RIN_CM_VP}
    RO2_2 VB_3 VB_2 {Ro2_2}
    RZOUT_IOUT_COEFF VZOUT_IOUT_COEFF NET0283 50
    ROUT NET0394 VZOUT {Rout}
    RPROT_IN_P_VCCP NET196 VCCP 100
    RPROT_IN_M_VCCP VCCP NET348 100
    RD1 VCCP_ENHANCED VO_DIFF_PLUS {RD}
    RD2 VCCP_ENHANCED VO_DIFF_MINUS {RD}
    R1_REF NET326 NET356 1Meg
    RIN_CM_VM VREF VM {RIN_CM_VM}
    R_ICCSAT_HIGH ICC_OUT_HIGH 0 1K
    RPROT_IN_M_VCCN VCCN NET360 15K
    R2_REF NET356 NET362 1Meg
    RPROT_IN_P_VCCN NET213 VCCN 15K
    G_I_IO VB_2 VREF VALUE={V(VB_Vref)*GB*( 10*( 1 -
+exp(-abs(V(v_Io_val))/3m )) )  }
    G_ICCSAT_OUTLOW VCCP VCCN VALUE={IF(I(V_OUTVLIM_LOW)>1u ,
+V(Icc_out_low) , 0)}
    G_I_VB VB_2 VREF VB_VREF 0 {GB}
    G_IOUT_SOURCED VCCP 0 VALUE={IF(I(VreadIo)>0, I(VreadIo),0)}
    GM1 VREF VB VOUT_DIFF__SR_VCC 0 {1/RD}

    *G_IIB_VM VREF VM TABLE {V(Vccp,Vccn)} = (+1.8 1p) (+3.3 1p) (+5.0 1p)
    G_IIB_VM VREF VM VALUE={1p}
    
    G_ICC VCCP VCCN POLY(1) VCCP VCCN 4.027205882352942E-5
+3.958333333333329E-6 -1.2254901960784258E-7
    G_ICCSAT_OUTHIGH VCCP VCCN VALUE={IF(I(V_OUTVLIM_HIGH)>1u ,
+V(Icc_out_high), 0)}
    
    *G_IIB_VP VREF VP TABLE {V(Vccp,Vccn)} = (+1.8 1p) (+3.3 1p) (+5.0 1p)
    G_IIB_VP VREF VP VALUE={1p}
    
    G_IOUT_SINKED VCCN 0 VALUE={IF(I(VreadIo)>0, 0, I(VreadIo))}

*** End of subcircuit definition.

*******************************************************************************
*
* MODELS/SUBCKTS and PARAMS used by TSV639x subckt:
*
.PARAM RINCM=2.0828E+11
.PARAM CINCM=6.6478E-12
.PARAM RIN_CM_VM={2*RINCM}
.PARAM RIN_CM_VP={2*RINCM}
.PARAM CIN_CM_VM={CINCM/2}
.PARAM CIN_CM_VP={CINCM/2}
.PARAM CINDIFF=3.5657E-12
.PARAM CIN_DIFF={CINDIFF - CINCM/2}
.PARAM RD=1k
.PARAM VCCP_enhance=150m
.PARAM VCCN_enhance=-1100m 
.PARAM GB=95m 
.PARAM Ro = 223872
.PARAM A0_source = 5.959352977968012e+7  
.PARAM A0_sink = 0.6e+6
.PARAM alpha_switch = 1e6
.PARAM Io_val_switch = -7u
.PARAM Ccomp=2.65p 
.PARAM IEE=3u
.PARAM W=1.06u
.PARAM L=1u
.PARAM gm_mos=3.990140517663634e-05
.PARAM Lout  = 220u
.PARAM Rout  = 1.95k
.PARAM Cout  = 105p
.PARAM Cout2 = 3p
.PARAM Zout_Iout_coeff_MIN= 0.04
.PARAM Iout_dc_tau__source = 0.17m 
.PARAM Iout_dc_tau__sink   = 0.03m 
.PARAM Ro2_2=1e-3 
.PARAM Ro2_1={ Ro - Ro2_2 } 
.PARAM R1_sink={A0_sink/(gm_mos*GB*Ro2_1)}
.PARAM R1_source={A0_source/(gm_mos*GB*Ro2_1)}
.PARAM V_DPROT=150m
.PARAM Vd_compensazione=-788.4u

.MODEL MOS_N  NMOS LEVEL=1 VTO=+0.65  KP=500E-6 
.MODEL DIODE_NOVd D LEVEL=1 IS=10E-15 N=0.001
.MODEL DIODE_VLIM D LEVEL=1 IS=0.8E-15   
.MODEL DIODE_ILIM D LEVEL=1 IS=0.8E-15 
*
.ENDS
*******************************************************************************
* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation
* time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
* validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
* SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
* Thus the macromodel is often not as exhaustive as the datasheet, its goal
* is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
* (Vcc, Temperature, etc) or even worse: outside of the device operating
* conditions (Vcc, Vicm, etc) are not reliable in any way.
*
****************************************************************************
****
****  TSV91X  Spice macromodel subckt
****
****  Revision Date: 10/06/08 (last update: 05-10-2010)
****
*********** CONNECTIONS: 
****           INVERTING INPUT
****            |  NON-INVERTING INPUT
****            |   |  OUTPUT 
****            |   |   |  POSITIVE POWER SUPPLY
****            |   |   |   |  NEGATIVE POWER SUPPLY
****            |   |   |   |   | 
****            |   |   |   |   | 
.SUBCKT TSV91X VM  VP  VS  VCCP VCCN
    M_NMOS2 VO_DIFF_MINUS VM VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    M_NMOS1 VO_DIFF_PLUS NET0158 VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    IEE_N VEE_N VCCN_ENHANCED DC {IEE}
    HILIM_ICCP NET0241 0 V_OUTVLIM_HIGH -235
    HILIM_ICCN NET0249 0 V_OUTVLIM_LOW 235
    V_OUTVLIM_HIGH NET0201 NET0177 DC -770m
    VVLIM_LOW_VB NET0109 NET0110 DC -770m
    VOS NET0158 VP DC 0
    VPROT_IN_P_VCCP NET0123 NET0134 DC {V_DPROT}
    V_ENHANCE_VCCN VCCN_ENHANCED VCCN DC -360m
    VVLIM_HIGH_VB NET0136 NET0153 DC -770m
    V_ENHANCE_VCCP VCCP_ENHANCED VCCP DC -500m
    VPROT_IN_M_VCCN NET0116 NET0192 DC {V_DPROT}
    VPROT_IN_P_VCCN NET0115 NET096 DC {V_DPROT}
    V_OUTVLIM_LOW NET0182 NET0183 DC -770m
    VPROT_IN_M_VCCP NET0190 NET0135 DC {V_DPROT}
    VREADIO NET0342 VS DC 0
    DILIM_SOURCE VB_3 VB_3_SOURCE DIODE_ILIM
    DILIM_ICCN NET0206 VB_3 DIODE_ILIM
    D_OUTVLIM_LOW NET0183 VB_3 DIODE_VLIM
    DVLIM_HIGH_VB VB NET0136 DIODE_VLIM
    DILIM_SINK VB_3_SINK VB_3 DIODE_ILIM
    DPROT_IN_M_VCCP VM NET0135 DIODE_VLIM
    DVLIM_LOW_VB NET0110 VB DIODE_VLIM
    D_OUTVLIM_HIGH VB_3 NET0201 DIODE_VLIM
    DPROT_IN_M_VCCN NET0116 VM DIODE_VLIM
    DPROT_IN_P_VCCP NET0158 NET0134 DIODE_VLIM
    DPROT_IN_P_VCCN NET0115 NET0158 DIODE_VLIM
    DILIM_ICCP VB_3 NET0203 DIODE_ILIM
    CGATE_VP_PARASITIC VP VREF 7p
    CCOMP VB VB_2 {Ccomp}
    CBD2_PARASITIC VO_DIFF_MINUS VCCN_ENHANCED 7p
    CGD2_PARASITIC VO_DIFF_MINUS VM 300.0f
    CBD1_PARASITIC VO_DIFF_PLUS VCCN_ENHANCED 7p
    CDIFF_PARASITIC VO_DIFF_PLUS VO_DIFF_MINUS 200.0f
    CGATE_VM_PARASITIC VM VREF 7p
    CGD1_PARASITIC VO_DIFF_PLUS NET0158 300.0f
    
    *Eldo:
    *E_VDEP_SOURCE_2 VAL_VDEP_SOURCE_FILTERED 0
    *+VALUE={VALIF(V(val_vdep_source)>=0, 0, V(val_vdep_source))}
    *PSpice: 
    E_VDEP_SOURCE_2 VAL_VDEP_SOURCE_FILTERED 0
    +VALUE={IF(V(val_vdep_source)>=0, 0, V(val_vdep_source))}

    E_VDEP_SOURCE_1 VAL_VDEP_SOURCE 0 VALUE={ 174.5 -5000*I(VreadIo)}
    EMEAS_VOUT_DIFF VOUT_DIFF 0 VO_DIFF_PLUS VO_DIFF_MINUS 1.0
    E_ICCSAT_LOW ICC_OUT_LOW 0 POLY(1) VCCP VCCN 0.0023261764705882347
+-5.5705882352941006E-5 5.294117647058802E-6
    E_ICCSAT_HIGH ICC_OUT_HIGH 0 POLY(1) VCCP VCCN 0.0023261764705882347
+-5.5705882352941006E-5 5.294117647058802E-6
    EVLIM_HIGH_VB NET0153 0 VCCP 0 1.0
    EILIM_SOURCE VB_3_SOURCE VDEP_SOURCE VB_3 0 1.0
    
    *Eldo:
    *E_RO1 VB_3 NET0342 VALUE={VALIF(I(VreadIo)>0,
    *+V(Ro1_Voh)*I(VreadIo),V(Ro1_Vol)*I(VreadIo))}
    *PSpice:
    E_RO1 VB_3 NET0342 VALUE={IF(I(VreadIo)>0,
    +V(Ro1_Voh)*I(VreadIo),V(Ro1_Vol)*I(VreadIo))}

    EVLIM_LOW_VB NET0109 0 VCCN 0 1.0
    EILIM_ICCN NET0206 NET0249 VB_3 0 1.0
    E2_REF NET0238 0 VCCN 0 1.0
    EVLIM_HIGH_VOUT NET0177 0 VCCP 0 1.0
    E_VREF VREF 0 NET0250 0 1.0

    *Eldo:
    *E_VDEP_SINK_2 VAL_VDEP_SINK_FILTERED 0
    *+VALUE={VALIF(V(val_vdep_sink)<=0 , 0 , V(val_vdep_sink))}
    *E_VDEP_SINK_3 VDEP_SINK 0 VALUE={VALIF( abs(I(VreadIo))<1m , 0 ,
    *+V(val_vdep_sink_filtered))}
    *E_VDEP_SOURCE_3 VDEP_SOURCE 0 VALUE={VALIF( abs(I(VreadIo))<1m , 0 ,
    *+V(val_vdep_source_filtered))}
    *PSpice:
    E_VDEP_SINK_2 VAL_VDEP_SINK_FILTERED 0
    +VALUE={IF(V(val_vdep_sink)<=0 , 0 , V(val_vdep_sink))}
    E_VDEP_SINK_3 VDEP_SINK 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
    +V(val_vdep_sink_filtered))}
    E_VDEP_SOURCE_3 VDEP_SOURCE 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
    +V(val_vdep_source_filtered))}

    EILIM_SINK VB_3_SINK VDEP_SINK VB_3 0 1.0

    *Eldo:    
    *E_RO1_VOL RO1_VOL 0 PWL(1) VCCP VCCN ( 2.5 , 14 ) ( 3.3 , 11 ) ( 5.0 , 7.5 )
    *PSpice:
    *E_RO1_VOL RO1_VOL 0 VALUE={TABLE(V(VCCP,VCCN), 2.5 , 14 , 3.3 , 11 , 5.0 , 7.5 )}
    E_RO1_VOL RO1_VOL 0 POLY(1) VCCP VCCN 28.955882352941185
+-7.673529411764715 0.6764705882352953
    
    E1_REF NET0210 0 VCCP 0 1.0
    E_VDEP_SINK_1 VAL_VDEP_SINK 0 VALUE={ -159.5 -5000*I(VreadIo)}
    EVLIM_LOW_VOUT NET0182 0 VCCN 0 1.0
    
    *Eldo:
    *E_RO1_VOH RO1_VOH 0 PWL(1) VCCP VCCN ( 2.5 , 14 ) ( 3.3 , 11 ) ( 5.0 , 7.5 )
    *PSpice:
    *E_RO1_VOH RO1_VOH 0 VALUE={TABLE(V(VCCP,VCCN), 2.5 , 14 , 3.3 , 11 , 5.0 , 7.5 )}
    E_RO1_VOH RO1_VOH 0 POLY(1) VCCP VCCN 28.955882352941185
+-7.673529411764715 0.6764705882352953
    
    EILIM_ICCP NET0203 NET0241 VB_3 0 1.0
    RO2_2 VB_3 VB_2 {Ro2_2}
    R_ICCSAT_LOW ICC_OUT_LOW 0 1K
    RPROT_IN_P_VCCP NET0123 VCCP 1K
    RPROT_IN_M_VCCP VCCP NET0190 1K
    RD1 VCCP_ENHANCED VO_DIFF_PLUS {RD}
    RD2 VCCP_ENHANCED VO_DIFF_MINUS {RD}
    RO2_1 VREF VB_2 {Ro2_1}
    R1_REF NET0210 NET0250 1Meg
    R_ICCSAT_HIGH ICC_OUT_HIGH 0 1K
    R1 VB VREF {R1}
    RPROT_IN_M_VCCN VCCN NET0192 15K
    R2_REF NET0250 NET0238 1Meg
    RPROT_IN_P_VCCN NET096 VCCN 15K
    
    *Eldo:
    *G_ICCSAT_OUTLOW VCCP VCCN VALUE={VALIF(I(V_OUTVLIM_LOW)>1u ,
    *+V(Icc_out_low) , 0)}
    *PSpice:
    G_ICCSAT_OUTLOW VCCP VCCN VALUE={IF(I(V_OUTVLIM_LOW)>1u ,
    +V(Icc_out_low) , 0)}

    *Eldo:
    *G_IOUT_SOUCED VCCP 0 VALUE={VALIF(I(VreadIo)>0, I(VreadIo),0)}
    *G_ICCSAT_OUTHIGH VCCP VCCN VALUE={VALIF(I(V_OUTVLIM_HIGH)>1u ,
    *+V(Icc_out_high), 0)}
    *PSpice:
    G_IOUT_SOUCED VCCP 0 VALUE={IF(I(VreadIo)>0, I(VreadIo),0)}
    G_ICCSAT_OUTHIGH VCCP VCCN VALUE={IF(I(V_OUTVLIM_HIGH)>1u ,
    +V(Icc_out_high), 0)}    

    G_I_VB VB_2 VREF POLY(1) VB VREF 7.773528173127232E-19
+0.010310813241023556 0 0.1401392933601382
    GM1 VREF VB VOUT_DIFF 0 {1/RD}
    G_ICC VCCP VCCN POLY(1) VCCP VCCN +6.321735294117647E-4
++5.570588235294106E-5 -5.294117647058808E-6
   
    *Eldo:
    *G_IOUT_SINKED VCCN 0 VALUE={VALIF(I(VreadIo)>0, 0, I(VreadIo))}
    *PSpice:
    G_IOUT_SINKED VCCN 0 VALUE={IF(I(VreadIo)>0, 0, I(VreadIo))}    

*** End of subcircuit definition.

.PARAM RD=1k
.PARAM Ccomp=8.5p
.PARAM IEE=41.65u
.PARAM A0=97.93103448E3
.PARAM Ro=17587.2
.PARAM W=20u
.PARAM L=2u
.PARAM gm_mos=0.0004565941678681337
.PARAM GB=11m
.PARAM Ro1=11
.PARAM Ro2_2=1e-3
.PARAM Ro2_1={Ro - Ro2_2 - Ro1}
.PARAM R1={A0/(gm_mos*GB*Ro2_1)}
.PARAM V_DPROT=0.6

*Eldo:
*.MODEL MOS_N  NMOS LEVEL=1 MODTYPE=ELDO VTO=+0.65  KP=500E-6 
*.MODEL DIODE_VLIM D LEVEL=1 MODTYPE=ELDO IS=0.8E-15 
*.MODEL DIODE_ILIM D LEVEL=1 MODTYPE=ELDO IS=0.8E-15 
*.MODEL DX D LEVEL=1 MODTYPE=ELDO IS=1E-14
*PSpice:
.MODEL MOS_N  NMOS LEVEL=1 VTO=+0.65  KP=500E-6 
.MODEL DIODE_VLIM D LEVEL=1 IS=0.8E-15 
.MODEL DIODE_ILIM D LEVEL=1 IS=0.8E-15 
.MODEL DX D LEVEL=1 IS=1E-14
.ENDS
*********************************************************************************** * WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation
* time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
* validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within
* SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
* Thus the macromodel is often not as exhaustive as the datasheet, its goal
* is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
* (Vcc, Temperature, etc) or even worse: outside of the device operating
* conditions (Vcc, Vicm, etc) are not reliable in any way.
*
****************************************************************************
****
****  TSV99X  Spice macromodel subckt
****
****  Revision Date: 10/06/08 (last update: 05-10-2010)
****
*********** CONNECTIONS: 
****           INVERTING INPUT
****            |  NON-INVERTING INPUT
****            |   |  OUTPUT 
****            |   |   |  POSITIVE POWER SUPPLY
****            |   |   |   |  NEGATIVE POWER SUPPLY
****            |   |   |   |   | 
****            |   |   |   |   | 
.SUBCKT TSV99X VM  VP  VS  VCCP VCCN
    HILIM_ICCN NET0477 0 V_OUTVLIM_LOW 235
    HILIM_ICCP NET0437 0 V_OUTVLIM_HIGH -235
    M_NMOS2 VO_DIFF_MINUS VM VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    M_NMOS1 VO_DIFF_PLUS NET0158 VEE_N VCCN_ENHANCED MOS_N L={L} W={W}
    IEE_N VEE_N VCCN_ENHANCED DC {IEE}
    V_OUTVLIM_LOW NET0372 NET0373 DC -770m
    VVLIM_LOW_VB NET0109 NET0110 DC -770m
    VREADIO NET0481 VS DC 0
    VOS NET0158 VP DC 0
    VPROT_IN_P_VCCP NET0123 NET0134 DC {V_DPROT}
    V_ENHANCE_VCCN VCCN_ENHANCED VCCN DC -360m
    VVLIM_HIGH_VB NET0180 NET0153 DC -770m
    V_ENHANCE_VCCP VCCP_ENHANCED VCCP DC -500m
    VPROT_IN_M_VCCN NET0116 NET0192 DC {V_DPROT}
    VPROT_IN_P_VCCN NET0115 NET096 DC {V_DPROT}
    VPROT_IN_M_VCCP NET0190 NET0135 DC {V_DPROT}
    V_OUTVLIM_HIGH NET0397 NET0375 DC -770m
    DILIM_ICCN NET0402 VB_3 DIODE_ILIM
    DVLIM_HIGH_VB VB NET0180 DIODE_VLIM
    DPROT_IN_M_VCCP VM NET0135 DIODE_VLIM
    DILIM_SOURCE VB_3 VB_3_SOURCE DIODE_ILIM
    D_OUTVLIM_LOW NET0373 VB_3 DIODE_VLIM
    DVLIM_LOW_VB NET0110 VB DIODE_VLIM
    DILIM_SINK VB_3_SINK VB_3 DIODE_ILIM
    D_OUTVLIM_HIGH VB_3 NET0397 DIODE_VLIM
    DILIM_ICCP VB_3 NET0395 DIODE_ILIM
    DPROT_IN_M_VCCN NET0116 VM DIODE_VLIM
    DPROT_IN_P_VCCP NET0158 NET0134 DIODE_VLIM
    DPROT_IN_P_VCCN NET0115 NET0158 DIODE_VLIM
    CGATE_VM_PARASITIC VM VREF 7p
    CGATE_VP_PARASITIC VP VREF 7p
    CCOMP VB VB_2 {Ccomp}
    CBD2_PARASITIC VO_DIFF_MINUS VCCN_ENHANCED 7p
    CGD2_PARASITIC VO_DIFF_MINUS VM 200.0f
    CBD1_PARASITIC VO_DIFF_PLUS VCCN_ENHANCED 7p
    CDIFF_PARASITIC VO_DIFF_PLUS VO_DIFF_MINUS 200.0f
    CGD1_PARASITIC VO_DIFF_PLUS NET0158 200.0f
    E_ICCSAT_LOW ICC_OUT_LOW 0 POLY(1) VCCP VCCN 0.0023261764705882347
+-5.5705882352941006E-5 5.294117647058802E-6
    EMEAS_VOUT_DIFF VOUT_DIFF 0 VO_DIFF_PLUS VO_DIFF_MINUS 1.0
    EVLIM_HIGH_VB NET0153 0 VCCP 0 1.0
    E_VDEP_SOURCE_1 VAL_VDEP_SOURCE 0 VALUE={ 174.5 -5000*I(VreadIo)}
    EVLIM_LOW_VB NET0109 0 VCCN 0 1.0
    
    *Eldo:
    *E_RO1_VOL RO1_VOL 0 PWL(1) VCCP VCCN ( 2.5 , 14 ) ( 3.3 , 11 ) ( 5.0 , 7.5 )
    *PSpice:
    *E_RO1_VOL RO1_VOL 0  VALUE={TABLE(V(VCCP,VCCN), 2.5 , 14 , 3.3 , 11 , 5.0 , 7.5 )}
    E_RO1_VOL RO1_VOL 0 POLY(1) VCCP VCCN 28.955882352941185
+-7.673529411764715 0.6764705882352953

    E2_REF NET0238 0 VCCN 0 1.0
    E_VDEP_SINK_1 VAL_VDEP_SINK 0 VALUE={ -159.5 -5000*I(VreadIo)}
    
    *Eldo:
    *E_VDEP_SINK_2 VAL_VDEP_SINK_FILTERED 0
    *+VALUE={VALIF(V(val_vdep_sink)<=0 , 0 , V(val_vdep_sink))}
    *PSpice:
    E_VDEP_SINK_2 VAL_VDEP_SINK_FILTERED 0
    +VALUE={IF(V(val_vdep_sink)<=0 , 0 , V(val_vdep_sink))}

    E_ICCSAT_HIGH ICC_OUT_HIGH 0 POLY(1) VCCP VCCN 0.0023261764705882347
+-5.5705882352941006E-5 5.294117647058802E-6
    E_VREF VREF 0 NET0250 0 1.0
    
    *Eldo:
    *E_RO1_VOH RO1_VOH 0 PWL(1) VCCP VCCN ( 2.5 , 14 ) ( 3.3 , 11 ) ( 5.0 , 7.5 )
    *PSpice:
    *E_RO1_VOH RO1_VOH 0 VALUE={TABLE(V(VCCP,VCCN), 2.5 , 14 , 3.3 , 11 , 5.0 , 7.5 )}
     E_RO1_VOH RO1_VOH 0 POLY(1) VCCP VCCN 28.955882352941185
+-7.673529411764715 0.6764705882352953

    *Eldo:
    *E_VDEP_SOURCE_3 VDEP_SOURCE 0 VALUE={VALIF( abs(I(VreadIo))<1m , 0 ,
    *+V(val_vdep_source_filtered))}
    *PSpice:
    E_VDEP_SOURCE_3 VDEP_SOURCE 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
    +V(val_vdep_source_filtered))}

    EILIM_ICCP NET0395 NET0437 VB_3 0 1.0
    EILIM_SINK VB_3_SINK VDEP_SINK VB_3 0 1.0
    EILIM_ICCN NET0402 NET0477 VB_3 0 1.0
    EILIM_SOURCE VB_3_SOURCE VDEP_SOURCE VB_3 0 1.0

    *Eldo:
    *E_RO1 VB_3 NET0481 VALUE={VALIF(I(VreadIo)>0,
    *+V(Ro1_Voh)*I(VreadIo),V(Ro1_Vol)*I(VreadIo))}
    *E_VDEP_SINK_3 VDEP_SINK 0 VALUE={VALIF( abs(I(VreadIo))<1m , 0 ,
    *+V(val_vdep_sink_filtered))}
    *PSpice:
    E_RO1 VB_3 NET0481 VALUE={IF(I(VreadIo)>0,
    +V(Ro1_Voh)*I(VreadIo),V(Ro1_Vol)*I(VreadIo))}
    E_VDEP_SINK_3 VDEP_SINK 0 VALUE={IF( abs(I(VreadIo))<1m , 0 ,
    +V(val_vdep_sink_filtered))}

    E1_REF NET0210 0 VCCP 0 1.0
    EVLIM_LOW_VOUT NET0372 0 VCCN 0 1.0
    
    *Eldo:
    *E_VDEP_SOURCE_2 VAL_VDEP_SOURCE_FILTERED 0
    *+VALUE={VALIF(V(val_vdep_source)>=0, 0, V(val_vdep_source))}
    *PSpice:
    E_VDEP_SOURCE_2 VAL_VDEP_SOURCE_FILTERED 0
    +VALUE={IF(V(val_vdep_source)>=0, 0, V(val_vdep_source))}

    EVLIM_HIGH_VOUT NET0375 0 VCCP 0 1.0
    R_ICCSAT_HIGH ICC_OUT_HIGH 0 1K
    R_ICCSAT_LOW ICC_OUT_LOW 0 1K
    RPROT_IN_P_VCCP NET0123 VCCP 15K
    RPROT_IN_M_VCCP VCCP NET0190 15K
    RD1 VCCP_ENHANCED VO_DIFF_PLUS {RD}
    RD2 VCCP_ENHANCED VO_DIFF_MINUS {RD}
    RO2_1 VREF VB_2 {Ro2_1}
    R1_REF NET0210 NET0250 1Meg
    RO2_2 VB_3 VB_2 {Ro2_2}
    R1 VB VREF {R1}
    RPROT_IN_M_VCCN VCCN NET0192 15K
    R2_REF NET0250 NET0238 1Meg
    RPROT_IN_P_VCCN NET096 VCCN 15K
    
    *Eldo:
    *G_IOUT_SOUCED VCCP 0 VALUE={VALIF(I(VreadIo)>0, I(VreadIo),0)}
    *G_ICCSAT_OUTLOW VCCP VCCN VALUE={VALIF(I(V_OUTVLIM_LOW)>1u ,
    *+V(Icc_out_low) , 0)}
    *G_ICCSAT_OUTHIGH VCCP VCCN VALUE={VALIF(I(V_OUTVLIM_HIGH)>1u ,
    *+V(Icc_out_high), 0)}
    *G_IOUT_SINKED VCCN 0 VALUE={VALIF(I(VreadIo)>0, 0, I(VreadIo))}
    *PSpice:    
    G_IOUT_SOUCED VCCP 0 VALUE={IF(I(VreadIo)>0, I(VreadIo),0)}
    G_ICCSAT_OUTLOW VCCP VCCN VALUE={IF(I(V_OUTVLIM_LOW)>1u ,
    +V(Icc_out_low) , 0)}
    G_ICCSAT_OUTHIGH VCCP VCCN VALUE={IF(I(V_OUTVLIM_HIGH)>1u ,
    +V(Icc_out_high), 0)}
    G_IOUT_SINKED VCCN 0 VALUE={IF(I(VreadIo)>0, 0, I(VreadIo))}    
    
    G_I_VB VB_2 VREF POLY(1) VB VREF 7.773528173127232E-19
    +0.010310813241023556 0 0.1401392933601382
    GM1 VREF VB VOUT_DIFF 0 {1/RD}
    G_ICC VCCP VCCN POLY(1) VCCP VCCN 6.380235294117639E-4
+5.570588235294159E-5 -5.294117647058884E-6

*** End of subcircuit definition.

.PARAM RD=1k
.PARAM Ccomp=3.4p
.PARAM IEE=35.8u
.PARAM W=25u
.PARAM L=2u
.PARAM gm_mos=0.0004733346976081021
.PARAM A0=97.93103448E3
.PARAM Ro=17587.2
.PARAM GB=11m
.PARAM Ro1=11
.PARAM Ro2_2=1e-3
.PARAM Ro2_1={Ro - Ro2_2 - Ro1}
.PARAM R1={A0/(gm_mos*GB*Ro2_1)}
.PARAM V_DPROT=0.6

*Eldo:
*.MODEL MOS_N  NMOS LEVEL=1 MODTYPE=ELDO VTO=+0.65  KP=500E-6 
*.MODEL DIODE_VLIM D LEVEL=1 MODTYPE=ELDO IS=0.8E-15   
*.MODEL DIODE_ILIM D LEVEL=1 MODTYPE=ELDO IS=0.8E-15  
*.MODEL DX D LEVEL=1 MODTYPE=ELDO IS=1E-14 
*PSpice:
.MODEL MOS_N  NMOS LEVEL=1 VTO=+0.65  KP=500E-6 
.MODEL DIODE_VLIM D LEVEL=1 IS=0.8E-15   
.MODEL DIODE_ILIM D LEVEL=1 IS=0.8E-15  
.MODEL DX D LEVEL=1 IS=1E-14 
.ENDS
*********************************************************************************** 

* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within 
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.


** Standard Linear Ics Macromodels, 1997.
** CONNECTIONS :
* 1 INVERTING INPUT
* 2 NON-INVERTING INPUT
* 3 OUTPUT
* 4 POSITIVE POWER SUPPLY
* 5 NEGATIVE POWER SUPPLY
.SUBCKT TSH95 1 3 2 4 5 (analog) **********************************************************
.MODEL MDTH D IS=1E-8 KF=1.809064E-15 CJO=10F
* INPUT STAGE
CIP 2 5 1.000000E-12
CIN 1 5 1.000000E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 2.600000E-01
RIN 15 16 2.600000E-01
RIS 11 15 3.645298E-01
DIP 11 12 MDTH 400E-12
DIN 15 14 MDTH 400E-12
VOFP 12 13 DC 0.000000E+00
VOFN 13 14 DC 0
IPOL 13 5 1.000000E-03
CPS 11 15 2.986990E-10
DINN 17 13 MDTH 400E-12
VIN 17 5 2.000000e+00
DINR 15 18 MDTH 400E-12
VIP 4 18 1.000000E+00
FCP 4 5 VOFP 3.500000E+00
FCN 5 4 VOFN 3.500000E+00
FIBP 2 5 VOFP 1.000000E-02
FIBN 5 1 VOFN 1.000000E-02
* AMPLIFYING STAGE
FIP 5 19 VOFP 2.530000E+02
FIN 5 19 VOFN 2.530000E+02
RG1 19 5 3.160721E+03
RG2 19 4 3.160721E+03
CC 19 5 2.00000E-09
DOPM 19 22 MDTH 400E-12
DONM 21 19 MDTH 400E-12
HOPM 22 28 VOUT 1.504000E+03
VIPM 28 4 5.000000E+01
HONM 21 27 VOUT 1.400000E+03
VINM 5 27 5.000000E+01
***********************
RZP1 5 80 1E+06
RZP2 4 80 1E+06
GZP 5 82 19 80 2.5E-05
RZP2H 83 4 10000
RZP1H 83 82 80000
RZP2B 84 5 10000
RZP1B 82 84 80000
LZPH 4 83 3.535e-02
LZPB 84 5 3.535e-02
EOUT 26 23 82 5 1
VOUT 23 5 0
ROUT 26 3 35
COUT 3 5 30.000000E-12
DOP 19 25 MDTH 400E-12
VOP 4 25 2.361965E+00
DON 24 19 MDTH 400E-12
VON 24 5 2.361965E+00
.ENDS

* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within 
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.


** Macanal, Analog macromodels generator, v.1.0
** J. REMY, SGS THOMSON, ANACA Grenoble, Aug. 1992.
** Standard Linear Ics Macromodels, 1996. 
** CONNECTIONS :
* 1 INVERTING INPUT
* 2 NON-INVERTING INPUT
* 3 OUTPUT
* 4 POSITIVE POWER SUPPLY
* 5 NEGATIVE POWER SUPPLY
.SUBCKT TSH94 1 3 2 4 5 (analog)
**********************************************************
.MODEL MDTH D IS=1E-8 KF=1.809064E-15 CJO=10F
* INPUT STAGE
CIP 2 5 1.000000E-12
CIN 1 5 1.000000E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 2.600000E-01
RIN 15 16 2.600000E-01
RIS 11 15 3.645298E-01
DIP 11 12 MDTH 400E-12
DIN 15 14 MDTH 400E-12
VOFP 12 13 DC 0.000000E+00
VOFN 13 14 DC 0
IPOL 13 5 1.000000E-03
CPS 11 15 2.986990E-10
DINN 17 13 MDTH 400E-12
VIN 17 5 2.000000e+00
DINR 15 18 MDTH 400E-12
VIP 4 18 1.000000E+00
FCP 4 5 VOFP 3.500000E+00
FCN 5 4 VOFN 3.500000E+00
FIBP 2 5 VOFP 1.000000E-02
FIBN 5 1 VOFN 1.000000E-02
* AMPLIFYING STAGE
FIP 5 19 VOFP 2.530000E+02
FIN 5 19 VOFN 2.530000E+02
RG1 19 5 3.160721E+03
RG2 19 4 3.160721E+03
CC 19 5 2.00000E-09
DOPM 19 22 MDTH 400E-12
DONM 21 19 MDTH 400E-12
HOPM 22 28 VOUT 1.504000E+03
VIPM 28 4 5.000000E+01
HONM 21 27 VOUT 1.400000E+03
VINM 5 27 5.000000E+01
***********************
RZP1 5 80 1E+06
RZP2 4 80 1E+06
GZP 5 82 19 80 2.5E-05
RZP2H 83 4 10000
RZP1H 83 82 80000
RZP2B 84 5 10000
RZP1B 82 84 80000
LZPH 4 83 3.535e-02
LZPB 84 5 3.535e-02
EOUT 26 23 82 5 1
VOUT 23 5 0
ROUT 26 3 35
COUT 3 5 30.000000E-12
DOP 19 25 MDTH 400E-12
VOP 4 25 2.361965E+00
DON 24 19 MDTH 400E-12
VON 24 5 2.361965E+00
.ENDS

* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within 
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.


** Standard Linear Ics Macromodels, 1997.
** CONNECTIONS :
* 1 INVERTING INPUT
* 2 NON-INVERTING INPUT
* 3 OUTPUT
* 4 POSITIVE POWER SUPPLY
* 5 NEGATIVE POWER SUPPLY
.SUBCKT TSH93 1 3 2 4 5 (analog) **********************************************************
.MODEL MDTH D IS=1E-8 KF=1.809064E-15 CJO=10F
* INPUT STAGE
CIP 2 5 1.000000E-12
CIN 1 5 1.000000E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 2.600000E-01
RIN 15 16 2.600000E-01
RIS 11 15 3.645298E-01
DIP 11 12 MDTH 400E-12
DIN 15 14 MDTH 400E-12
VOFP 12 13 DC 0.000000E+00
VOFN 13 14 DC 0
IPOL 13 5 1.000000E-03
CPS 11 15 2.986990E-10
DINN 17 13 MDTH 400E-12
VIN 17 5 2.000000e+00
DINR 15 18 MDTH 400E-12
VIP 4 18 1.000000E+00
FCP 4 5 VOFP 3.500000E+00
FCN 5 4 VOFN 3.500000E+00
FIBP 2 5 VOFP 1.000000E-02
FIBN 5 1 VOFN 1.000000E-02
* AMPLIFYING STAGE
FIP 5 19 VOFP 2.530000E+02
FIN 5 19 VOFN 2.530000E+02
RG1 19 5 3.160721E+03
RG2 19 4 3.160721E+03
CC 19 5 2.00000E-09
DOPM 19 22 MDTH 400E-12
DONM 21 19 MDTH 400E-12
HOPM 22 28 VOUT 1.504000E+03
VIPM 28 4 5.000000E+01
HONM 21 27 VOUT 1.400000E+03
VINM 5 27 5.000000E+01
***********************
RZP1 5 80 1E+06
RZP2 4 80 1E+06
GZP 5 82 19 80 2.5E-05
RZP2H 83 4 10000
RZP1H 83 82 80000
RZP2B 84 5 10000
RZP1B 82 84 80000
LZPH 4 83 3.535e-02
LZPB 84 5 3.535e-02
EOUT 26 23 82 5 1
VOUT 23 5 0
ROUT 26 3 35
COUT 3 5 30.000000E-12
DOP 19 25 MDTH 400E-12
VOP 4 25 2.361965E+00
DON 24 19 MDTH 400E-12
VON 24 5 2.361965E+00
.ENDS

* WARNING : please consider following remarks before usage
*
* 1) All models are a tradeoff between accuracy and complexity (ie. simulation 
*    time).
* 2) Macromodels are not a substitute to breadboarding, they rather confirm the
*    validity of a design approach and help to select surrounding component values.
*
* 3) A macromodel emulates the NOMINAL performance of a TYPICAL device within 
*    SPECIFIED OPERATING CONDITIONS (ie. temperature, supply voltage, etc.).
*    Thus the macromodel is often not as exhaustive as the datasheet, its goal
*    is to illustrate the main parameters of the product.
*
* 4) Data issued from macromodels used outside of its specified conditions
*    (Vcc, Temperature, etc) or even worse: outside of the device operating 
*    conditions (Vcc, Vicm, etc) are not reliable in any way.


**CONNECTIONS:
*1 INVERTING INPUT
*2 NON INVERTING INPUT
*3 OUTPUT
*4 POSITIVE POWER SUPPLY
*5 NEGATIVE POWER SUPPLY
.SUBCKT TSH70 1 2 3 4 5
******************************************************************
.MODEL MDTH D IS=1E-8 KF=2.664234E-16 CJO=10F
*INPUT STAGE
CIP 2 5 0.2E-12
CIN 1 5 0.2E-12
EIP 10 5 2 5 1
EIN 16 5 1 5 1
RIP 10 11 7
RIN 15 16 7
RIS 11 15 400
DIP 11 120 MDTH 400E-12
DIN 15 140 MDTH 400E-12
VOFP 12 13 DC 100e-3
VOFN 13 14 DC 0
RDGP 120 12 312
RDGN 140 14 312
CDG 120 140 2P
IPOL 13 5 780e-6
CPS 11 15 0.3E-9
DINN 17 13 MDTH 400E-12
VIN 17 5 0.25
DINR 15 18 MDTH 400E-12
VIP 4 18 2
FCP 4 5 VOFP 9
FCN 5 4 VOFN 9
FIBP 2 5 VOFP 15e-3
FIBN 5 1 VOFN 15e-3
**GM1 STAGE ******************************
FGM1P 119 5 VOFP 1
FG1N 119 5 VOFN 0.5
RAP 119 4 4.93E5
RAN 119 5 5E5
**GM2 STAGE ******************************
G2P 19 5 119 5 161E-3
G2N 19 5 119 4 161E-3
R2P 19 4 2.5E7
R2N 19 5 2.5E7
******************************************
VINT1 500 0 3
GCONVP 500 501 119 4 19.38
VP 501 0 0
GCONVN 500 502 119 5 19.38
VN 502 0 0
*****************************************
** ORIENTATION ISINK ISOURCE
VINT2 503 0 3
FCOPY 503 504 VOUT 1
DCOPYP 504 505 MDTH 400E-9
VCOPYP 505 0 0
DCOPYN 506 504 MDTH 400E-9
VCOPYN 0 506 0
******************************************
F2PP 19 5 POLY(2) VCOPYP VP 0 0 0 0 0.5
F2PN 19 5 POLY(2) VCOPYP VN 0 0 0 0 0.5
F2NP 19 5 POLY(2) VCOPYN VP 0 0 0 0 1.75
F2NN 19 5 POLY(2) VCOPYN VN 0 0 0 0 1.75
***COMPENSATION**************************
CC 19 119 4.5P
******************************************
****OUTPUT********************************
DOPM 19 22 MDTH 400E-12
DONM 21 19 MDTH 400E-12
HOPM 22 28 VOUT 9.36E+03
VIPM 28 4 500
HONM 21 27 VOUT 9.90E+03
VINM 5 27 500
VOUT 3 23 0
ROUT 23 19 10
COUT 3 5 15E-12
DOP 19 25 MDTH 400E-12
VOP 4 25 1.35
DON 24 19 MDTH 400E-12
VON 24 5 1.2
.ENDS